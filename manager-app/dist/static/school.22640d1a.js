var l=Object.defineProperty,e=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(e,a,s)=>a in e?l(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s;import{q as u,f as c,_ as d,o as r,t as n,a as v,w as p,L as f,Q as m,R as _,v as k,U as y,V as b,u as g,c as h,S as C,F as w,a2 as x,Z as j,aw as z,ax as V,b as U}from"./vue.89ed3d48.js";import{h as O,i as M,j as P,k as S,l as q,m as D,n as F,o as $}from"./service.99381dce.js";import{M as E}from"./MyEmpty.c87e98e1.js";import{M as I}from"./MyPage.088b462f.js";import{M as R}from"./MyDialog.e1451ef4.js";import{f as L}from"./date.23847c74.js";import{_ as Q,e as Z,z as A,f as B,p as G}from"./index.547c0c45.js";import{a as H,l as J,c as K}from"./index.3b31d7d7.js";import{p as N}from"./pointer.3a1f7926.js";import{c as T}from"./collection-tag.8afbf903.js";import"./request.356cbcf4.js";import"./empty.f131d8fb.js";const W=l=>(z("data-v-95a51498"),l=l(),V(),l),X={class:"school_page"},Y=y("文章"),ll=y("视频"),el=W((()=>k("div",{class:"long_line"},null,-1))),al={class:"fsc mycard"},sl=W((()=>k("div",{class:"el-card__header"},"文章列表",-1))),tl=y("添加"),il={class:"mytable"},ol={class:"fcs"},ul={class:"fcs"},cl=y("查看"),dl={key:1,class:"line"},rl={key:3,class:"line"},nl=y("编辑"),vl={key:5,class:"line"},pl=y("删除"),fl={class:"mycard"},ml={class:"el-card__header",style:{height:"32px"}},_l=y("首页展示"),kl={class:"color999"},yl={key:0,class:"imgs_list flex"},bl={class:"imgbox"},gl=["src"],hl=["onClick"],Cl=["onClick"],wl={class:"imginfo"},xl={class:"imgname els"},jl={class:"imglink fcs"},zl={class:"fcc"},Vl={class:"fsc imgicon"},Ul={class:"fcs"},Ol=W((()=>k("span",null,"0",-1))),Ml=["onClick"],Pl={class:"fsc f1"},Sl=y("所有视频"),ql={class:"color999"},Dl=y("+ 添加"),Fl={key:0,class:"imgs_list flex fww"},$l={class:"imgbox"},El=["src"],Il={key:0,class:"is_top_show fcc"},Rl=W((()=>k("div",null,"展示中",-1))),Ll=["onClick"],Ql=["onClick"],Zl={class:"imginfo"},Al={class:"imgname els"},Bl={class:"imglink fcs"},Gl={class:"fcc"},Hl={class:"fsc imgicon"},Jl={class:"fcs"},Kl=W((()=>k("span",null,"0",-1))),Nl={class:"fcs"},Tl=["onClick"],Wl=["onClick"],Xl={key:0,class:"poolbox"},Yl=["src"],le={key:1,class:"fc fcc"},ee=W((()=>k("div",{class:"file_name"},"点击添加",-1))),ae={class:"fcs btns fjend mt20"},se=y("取消"),te=y("提交"),ie=u((oe=((l,e)=>{for(var a in e||(e={}))t.call(e,a)&&o(l,a,e[a]);if(s)for(var a of s(e))i.call(e,a)&&o(l,a,e[a]);return l})({},{name:"School"}),e(oe,a({setup(l){const e=c(1),a=c([]),s=c(1),t=c(20),i=c(0),o=async()=>{const l=await O({size:t.value,current:s.value});1==l.status&&(a.value=l.body.records,i.value=l.body.total)};o();const u=c(""),z=c(!1),V=async()=>{1==(await P({id:u.value})).status&&(z.value=!1,o())},Q=c([]),W=async()=>{const{status:l,body:e}=await S({status:1});1==l&&(Q.value=e)};W();const ie=c(1),oe=c(20),ue=c(0),ce=c([]),de=async()=>{const{status:l,body:e}=await q({size:oe.value,current:ie.value});1==l&&(ue.value=e.total,ce.value=e.records)};de();const re=(l,e=!1)=>{const a=e?Q.value.map((l=>l.cover_url)):ce.value.map((l=>l.cover_url));H(a,l)},ne=()=>{_e.value.resetFields(),ke.value={},ve.value=!1},ve=c(!1),pe=[{value:1,label:"分类一"},{value:2,label:"分类二"},{value:3,label:"分类三"},{value:4,label:"分类四"},{value:5,label:"分类五"}],fe=d({video_type:[{required:!0,message:"请选择分类！",trigger:"change"}]}),me=d({link:"",video_type:""}),_e=c(),ke=c({});Z.on("sel_tutorials",(l=>{ke.value=l}));const ye=()=>{_e.value.validate((async l=>{if(l){const{status:l}=await D({id:ke.value.id,link_url:me.link,video_type:me.video_type});1==l&&(ne(),de())}}))},be=async(l,e)=>{const{status:a}=await $({id:e||ke.value.id,status:l});1==a&&(de(),W())},ge=c(!1),he=c(""),Ce=async()=>{const{status:l}=await F({id:he.value});1==l&&(de(),W(),ge.value=!1)};return(l,c)=>{const d=U("el-button"),O=U("el-button-group"),P=U("el-table-column"),S=U("el-link"),q=U("el-table"),D=U("el-icon"),F=U("el-card"),$=U("el-form-item"),Z=U("el-option"),W=U("el-select"),we=U("el-input"),xe=U("el-form"),je=U("el-dialog");return r(),n("div",X,[v(F,null,{default:p((()=>[v(O,{class:"btn_tab"},{default:p((()=>[v(d,{class:f(1==e.value&&"btn_tab_active"),onClick:c[0]||(c[0]=l=>e.value=1)},{default:p((()=>[Y])),_:1},8,["class"]),v(d,{class:f(2==e.value&&"btn_tab_active"),onClick:c[1]||(c[1]=l=>e.value=2)},{default:p((()=>[ll])),_:1},8,["class"])])),_:1}),el,m(k("div",null,[k("div",al,[sl,v(d,{type:"primary",onClick:c[2]||(c[2]=e=>l.$router.push("addarticle"))},{default:p((()=>[tl])),_:1})]),k("div",il,[v(q,{data:a.value,border:"",draggable:""},{empty:p((()=>[v(E)])),default:p((()=>[v(P,{prop:"title",label:"标题"}),v(P,{prop:"article_type",label:"分类"}),v(P,{prop:"create_time",label:"发布时间"},{default:p((({row:l})=>[y(b(g(L)(new Date(l.create_time))),1)])),_:1}),v(P,{prop:"hits",label:"查看量"}),v(P,{prop:"status",label:"状态"},{default:p((({row:l})=>[k("div",ol,[k("div",{class:f(["status_dot",1==l.status?"sdot_b":2==l.status?"sdot_r":"sdot_g"])},null,2),k("div",null,b(1==l.status?"草稿":2==l.status?"离线":"在线"),1)])])),_:1}),v(P,{label:"操作",fixed:"right",width:"240"},{default:p((({row:e})=>[k("div",ul,[1!=e.status?(r(),h(S,{key:0,type:"primary",onClick:a=>l.$router.push("articledetails?id="+e.id)},{default:p((()=>[cl])),_:2},1032,["onClick"])):C("",!0),1!=e.status?(r(),n("div",dl)):C("",!0),1!=e.status?(r(),h(S,{key:2,type:"primary",onClick:l=>(async(l,e)=>{1==(await M({id:l,status:e})).status&&o()})(e.id,2==e.status?3:2)},{default:p((()=>[y(b(2==e.status?"上线":"下线"),1)])),_:2},1032,["onClick"])):C("",!0),2==e.status?(r(),n("div",rl)):C("",!0),3!=e.status?(r(),h(S,{key:4,type:"primary",onClick:a=>l.$router.push("addarticle?id="+e.id)},{default:p((()=>[nl])),_:2},1032,["onClick"])):C("",!0),3!=e.status?(r(),n("div",vl)):C("",!0),3!=e.status?(r(),h(S,{key:6,type:"primary",onClick:l=>{return a=e.id,u.value=a,void(z.value=!0);var a}},{default:p((()=>[pl])),_:2},1032,["onClick"])):C("",!0)])])),_:1})])),_:1},8,["data"])]),v(I,{total:i.value,page:s.value,"onUpdate:page":c[3]||(c[3]=l=>s.value=l),onChange:o,size:t.value,"onUpdate:size":c[4]||(c[4]=l=>t.value=l)},null,8,["total","page","size"])],512),[[_,1==e.value]]),v(R,{modelValue:z.value,"onUpdate:modelValue":c[5]||(c[5]=l=>z.value=l),msg:"此文章删除后无法撤回，请谨慎删除！",onSure:V},null,8,["modelValue"]),m(k("div",null,[k("div",fl,[k("div",ml,[_l,k("span",kl,"（"+b(Q.value.length)+"）",1)])]),Q.value.length?(r(),n("div",yl,[(r(!0),n(w,null,x(Q.value,((l,e)=>(r(),n("div",{class:"imgs_item",key:l.id},[k("div",bl,[k("img",{src:l.cover_url,alt:""},null,8,gl),k("div",{class:"lookicon fcc lookhover",onClick:l=>re(e,!0)},[v(D,{size:"20px"},{default:p((()=>[v(g(A))])),_:1})],8,hl),k("div",{class:"videoicon fcc lookhover",onClick:e=>g(J)(l.video_url)},[v(D,{size:"40px"},{default:p((()=>[v(g(B))])),_:1})],8,Cl)]),k("div",wl,[k("div",xl,b(l.video_name),1),k("div",jl,[k("span",zl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(S,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[y(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),k("div",Vl,[k("div",Ul,[v(D,{size:"14px"},{default:p((()=>[v(g(N))])),_:1}),Ol]),k("div",{onClick:e=>be(0,l.id),class:"chover dfcolor"},"下架",8,Ml)])])])))),128))])):(r(),h(E,{key:1}))],512),[[_,2==e.value]])])),_:1}),m(v(F,{class:"mycard mt20"},{header:p((()=>[k("div",Pl,[k("div",null,[Sl,k("span",ql,"（"+b(ue.value)+"）",1)]),v(d,{type:"primary",onClick:c[6]||(c[6]=l=>ve.value=!0)},{default:p((()=>[Dl])),_:1})])])),default:p((()=>[ce.value.length?(r(),n("div",Fl,[(r(!0),n(w,null,x(ce.value,((l,e)=>(r(),n("div",{class:"imgs_item mb20",key:l.id},[k("div",$l,[k("img",{src:l.cover_url,alt:""},null,8,El),1==l.status?(r(),n("div",Il,[v(D,{size:"14px"},{default:p((()=>[v(g(T))])),_:1}),Rl])):C("",!0),k("div",{class:"lookicon fcc lookhover",onClick:l=>re(e)},[v(D,{size:"20px"},{default:p((()=>[v(g(A))])),_:1})],8,Ll),k("div",{class:"videoicon fcc lookhover",onClick:e=>g(J)(l.video_url)},[v(D,{size:"40px"},{default:p((()=>[v(g(B))])),_:1})],8,Ql)]),k("div",Zl,[k("div",Al,b(l.video_name),1),k("div",Bl,[k("span",Gl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(S,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[y(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),k("div",Hl,[k("div",Jl,[v(D,{size:"14px"},{default:p((()=>[v(g(N))])),_:1}),Kl]),k("div",Nl,[0==l.status?(r(),n("div",{key:0,onClick:e=>{return a=l.id,he.value=a,void(ge.value=!0);var a},class:"chover dfcolor mr20"},"删除",8,Tl)):C("",!0),k("div",{onClick:e=>be(1==l.status?0:1,l.id),class:"chover dfcolor"},b(1==l.status?"下架":"上架"),9,Wl)])])])])))),128))])):(r(),h(E,{key:1})),v(I,{total:ue.value,page:ie.value,"onUpdate:page":c[7]||(c[7]=l=>ie.value=l),onChange:de,size:oe.value,"onUpdate:size":c[8]||(c[8]=l=>oe.value=l)},null,8,["total","page","size"])])),_:1},512),[[_,2==e.value]]),v(R,{modelValue:ge.value,"onUpdate:modelValue":c[9]||(c[9]=l=>ge.value=l),msg:"确认删除此视频?",onSure:Ce},null,8,["modelValue"]),v(je,{modelValue:ve.value,"onUpdate:modelValue":c[15]||(c[15]=l=>ve.value=l),title:"添加视频",width:"380px",onClose:ne},{default:p((()=>[v(xe,{model:g(me),rules:g(fe),ref_key:"addFormRef",ref:_e},{default:p((()=>[v($,{label:"选择视频",required:"","label-width":"90px"},{default:p((()=>[k("div",{class:"sel_pool fcc",onClick:c[12]||(c[12]=l=>g(K)("sel_tutorials",2,!0))},[ke.value.id?(r(),n("div",Xl,[k("img",{src:ke.value.cover_url,alt:""},null,8,Yl),k("div",{class:"lookicon fcc lookhover",onClick:c[10]||(c[10]=j((l=>g(H)([ke.value.cover_url],0)),["stop"]))},[v(D,{size:"14px"},{default:p((()=>[v(g(A))])),_:1})]),k("div",{class:"videoicon fcc lookhover",onClick:c[11]||(c[11]=j((l=>g(J)(ke.value.video_url)),["stop"]))},[v(D,{size:"20px"},{default:p((()=>[v(g(B))])),_:1})])])):(r(),n("div",le,[v(D,null,{default:p((()=>[v(g(G))])),_:1}),ee]))])])),_:1}),v($,{label:"视频分类",prop:"video_type","label-width":"90px"},{default:p((()=>[v(W,{modelValue:g(me).video_type,"onUpdate:modelValue":c[13]||(c[13]=l=>g(me).video_type=l),placeholder:"请选择视频分类",class:"f1"},{default:p((()=>[(r(),n(w,null,x(pe,(l=>v(Z,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),v($,{label:"添加链接",prop:"link","label-width":"90px"},{default:p((()=>[v(we,{modelValue:g(me).link,"onUpdate:modelValue":c[14]||(c[14]=l=>g(me).link=l),placeholder:"请输入链接"},null,8,["modelValue"])])),_:1}),k("div",ae,[v(d,{onClick:ne},{default:p((()=>[se])),_:1}),v(d,{type:"primary",onClick:ye,disabled:!ke.value.id},{default:p((()=>[te])),_:1},8,["disabled"])])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}))));var oe,ue=Q(ie,[["__scopeId","data-v-95a51498"]]);export{ue as default};
