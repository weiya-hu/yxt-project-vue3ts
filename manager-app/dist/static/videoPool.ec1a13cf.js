import{M as e}from"./Mypage.53af444b.js";import{M as a}from"./MyEmpty.8e216a46.js";import{M as l}from"./MyDialog.d8f2932e.js";import{M as o}from"./MediaUpload.2514cee4.js";import{M as s}from"./MyUpload.ef53f60d.js";import{h as u,e as t,a as d,k as c,l as r,i}from"./index.6c11e008.js";import{u as m,g as n,i as v,j as f}from"./system.f75f6534.js";import{f as p}from"./date.23847c74.js";import{_,d as y,h as g}from"./index.aefc30ce.js";import{d as b,c as k}from"./download.48e8d045.js";import{e as j}from"./edit.894d58be.js";import{G as C,g as V,j as h,o as x,H as M,I as U,a as w,w as z,a2 as N,P as E,aa as q,c as G,_ as P,C as F,a0 as I,a1 as L,b as S,ae as A}from"./vue.73bee448.js";import"./empty.f131d8fb.js";import"./login.857dc837.js";import"./request.65081ce8.js";import"./tinymce.5416ef76.js";const D={class:"videopool_page"},J={class:"fsc topbox"},H={class:"fcs"},O=L("搜索"),R={class:"fcs"},T={class:"total mr20"},B=L("+ 上传"),K={key:0,class:"imgs_list flex"},Q=["onClick"],W=["src"],X={class:"lookicon fcc"},Y={class:"imginfo"},Z={class:"imgname els"},$={class:"imgsize"},ee={class:"fcs fjend imgicon"},ae={class:"fcs btns fjend mt20"},le=L("取消"),oe=L("提交"),se={class:"fcs btns fjend mt20"},ue=L("取消"),te=L("提交");var de=_(C({setup(_){const C=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],L=[".mp4"],de=V(!1),ce=V(!1),re=V(),ie=async e=>{const a=await m({cover_url:e,source_url:ge.source_url,source_name:ge.source_name,source_type:2});a&&1==a.status?(je(),Me(),u(2)):ce.value=!1},me=e=>{t(e),ce.value=!1},ne=(e,a)=>{d(e,a)},ve=V(),fe=e=>{ge.source_name=e},pe=e=>{t(e),ce.value=!1},_e=e=>{ge.source_url=e,re.value.submit()},ye=V(),ge=h({source_name:"",source_oldName:"",source_url:""}),be=h({source_name:[{required:!0,message:"请输入视频名称！",trigger:"blur"}]}),ke=()=>{ye.value.validateField("source_name",(e=>{e&&(ce.value=!0,ve.value.submit())}))},je=()=>{ce.value=!1,ye.value.resetFields(),ve.value.clear(),de.value=!1},Ce=V([]),Ve=V(0),he=V(1),xe=V(""),Me=async()=>{const{body:e,status:a}=await n({size:10,current:he.value,sourceType:2,sourceName:xe.value});1==a&&(Ce.value=e.records,Ve.value=e.total)};Me();const Ue=()=>{he.value=1,Me()},we=V(0),ze=V(""),Ne=V(!1),Ee=async()=>{const{status:e}=await v({id:we.value});1==e&&(Ce.value.findIndex((e=>e.id==we.value)),Ne.value=!1,Me(),u(2))},qe=V(!1),Ge=async()=>{const{status:e}=await f({id:we.value,source_name:ze.value});1==e&&(qe.value=!1,Me(),u(2))},Pe=e=>{ce.value?c().then((()=>{ve.value.doAbort(),e()})).catch((()=>{})):e()};return(u,d)=>{const c=S("el-input"),m=S("el-button"),n=S("el-icon"),v=S("el-tooltip"),f=S("el-dialog"),_=S("el-form-item"),V=S("el-form"),h=A("loading");return x(),M("div",D,[U("div",J,[U("div",H,[w(c,{modelValue:xe.value,"onUpdate:modelValue":d[0]||(d[0]=e=>xe.value=e),placeholder:"输入视频名关键字搜索",clearable:""},null,8,["modelValue"]),w(m,{class:"ml20 bdc_btn",onClick:Ue},{default:z((()=>[O])),_:1})]),U("div",R,[U("div",T,"共"+N(Ve.value)+"条",1),w(m,{type:"primary",onClick:d[1]||(d[1]=e=>de.value=!0)},{default:z((()=>[B])),_:1})])]),Ve.value?(x(),M("div",K,[(x(!0),M(E,null,q(Ce.value,(e=>(x(),M("div",{class:"imgs_item",key:e.id},[U("div",{class:"imgbox lookhover",onClick:a=>F(r)(e.source_url)},[U("img",{src:e.cover_url,alt:""},null,8,W),U("div",X,[w(n,{size:"40px"},{default:z((()=>[w(F(y))])),_:1})])],8,Q),U("div",Y,[U("div",Z,N(e.source_name),1),U("div",$,N(F(p)(new Date(e.create_time),"yyyy-MM-dd")),1),U("div",ee,[w(v,{effect:"dark",content:"下载",placement:"bottom"},{default:z((()=>[w(n,{class:"chover",size:"18px",onClick:a=>F(i)(e.source_url,e.source_name)},{default:z((()=>[w(F(b))])),_:2},1032,["onClick"])])),_:2},1024),w(v,{effect:"dark",content:"复制链接",placement:"bottom"},{default:z((()=>[w(n,{class:"chover",size:"18px",onClick:a=>(e=>{const a=document.createElement("input");a.setAttribute("value",e),document.body.appendChild(a),a.select();try{document.execCommand("copy")&&document.body.removeChild(a)}catch{t("复制失败，请检查浏览器兼容")}})(e.source_url)},{default:z((()=>[w(F(k))])),_:2},1032,["onClick"])])),_:2},1024),w(v,{effect:"dark",content:"修改名称",placement:"bottom"},{default:z((()=>[w(n,{class:"chover",size:"18px",onClick:a=>{return l=e,we.value=l.id,ze.value=l.source_name,void(qe.value=!0);var l}},{default:z((()=>[w(F(j))])),_:2},1032,["onClick"])])),_:2},1024),w(v,{effect:"dark",content:"删除",placement:"bottom"},{default:z((()=>[w(n,{class:"chover",size:"18px",onClick:a=>{return l=e,we.value=l.id,ze.value=l.source_name,void(Ne.value=!0);var l}},{default:z((()=>[w(F(g))])),_:2},1032,["onClick"])])),_:2},1024)])])])))),128))])):(x(),G(a,{key:1})),w(e,{page:he.value,"onUpdate:page":d[2]||(d[2]=e=>he.value=e),total:Ve.value,onChange:Me,"hide-sizes":!0},null,8,["page","total"]),w(l,{modelValue:Ne.value,"onUpdate:modelValue":d[3]||(d[3]=e=>Ne.value=e),msg:"确认删除视频 “ "+ze.value+" ” ?",onSure:Ee},null,8,["modelValue","msg"]),w(f,{modelValue:qe.value,"onUpdate:modelValue":d[6]||(d[6]=e=>qe.value=e),title:"修改名称",width:"380px",onClose:d[7]||(d[7]=e=>ze.value="")},{default:z((()=>[w(c,{modelValue:ze.value,"onUpdate:modelValue":d[4]||(d[4]=e=>ze.value=e),placeholder:"请输入视频名"},null,8,["modelValue"]),U("div",ae,[w(m,{onClick:d[5]||(d[5]=e=>qe.value=!1)},{default:z((()=>[le])),_:1}),w(m,{type:"primary",onClick:Ge,disabled:!ze.value},{default:z((()=>[oe])),_:1},8,["disabled"])])])),_:1},8,["modelValue"]),w(f,{modelValue:de.value,"onUpdate:modelValue":d[10]||(d[10]=e=>de.value=e),title:"上传视频",width:"380px",onClose:je,"before-close":Pe},{default:z((()=>[P((x(),G(V,{model:F(ge),rules:F(be),ref_key:"addFormRef",ref:ye},{default:z((()=>[w(_,{label:"视 频",required:""},{default:z((()=>[w(s,{type:"video",modelValue:F(ge).source_oldName,"onUpdate:modelValue":d[8]||(d[8]=e=>F(ge).source_oldName=e),"max-size":200,onError:pe,onSuccess:_e,onChangeName:fe,exnameList:L,msg:"只能上传"+L.join("、")+"视频，不超过200M，推荐尺寸1280*720",ref_key:"upVideo",ref:ve},null,8,["modelValue","msg"])])),_:1}),w(_,{label:"名 称",prop:"source_name"},{default:z((()=>[w(c,{modelValue:F(ge).source_name,"onUpdate:modelValue":d[9]||(d[9]=e=>F(ge).source_name=e),placeholder:"请输入视频名"},null,8,["modelValue"])])),_:1}),w(_,{label:"封面图",required:""},{default:z((()=>[de.value?(x(),G(o,{key:0,max:1,onUpOneSuccess:ie,onError:me,onLook:ne,exnameList:C,msg:"只能上传"+C.join("、")+"图片，不超过2M",ref_key:"upload",ref:re},null,8,["msg"])):I("",!0)])),_:1}),U("div",se,[w(m,{onClick:je},{default:z((()=>[ue])),_:1}),re.value?(x(),G(m,{key:0,type:"primary",onClick:ke,disabled:!re.value.imgs.length||!F(ge).source_oldName},{default:z((()=>[te])),_:1},8,["disabled"])):I("",!0)])])),_:1},8,["model","rules"])),[[h,ce.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-5d3bc728"]]);export{de as default};
