var l=Object.defineProperty,a=Object.defineProperties,e=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(a,e,s)=>e in a?l(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;import{q as c,f as u,_ as d,o as r,t as n,a as v,w as p,L as f,Q as m,R as _,v as k,U as y,V as b,u as g,c as h,S as C,F as w,a2 as x,Z as j,aw as z,ax as V,b as U}from"./vue.89ed3d48.js";import{h as O,i as M,j as P,k as S,l as q,m as D,n as F,o as $}from"./service.38df9cc3.js";import{M as E}from"./MyEmpty.72a1acd1.js";import{M as I}from"./MyPage.512ed0c7.js";import{M as R}from"./MyDialog.50f39301.js";import{f as L}from"./date.23847c74.js";import{_ as Q,e as Z,z as A,f as B,p as G}from"./index.fdca730b.js";import{a as H,l as J,c as K}from"./index.eaa6bc8d.js";import{p as N}from"./pointer.dcf57f00.js";import{c as T}from"./collection-tag.a852357c.js";import"./request.aa9790cc.js";import"./empty.f131d8fb.js";const W=l=>(z("data-v-95a51498"),l=l(),V(),l),X={class:"school_page"},Y=y("文章"),ll=y("视频"),al=W((()=>k("div",{class:"long_line"},null,-1))),el={class:"fsc mycard"},sl=W((()=>k("div",{class:"el-card__header"},"文章列表",-1))),tl=y("添加"),il={class:"mytable"},ol={class:"fcs"},cl={class:"fcs"},ul=y("查看"),dl={key:1,class:"line"},rl={key:3,class:"line"},nl=y("编辑"),vl={key:5,class:"line"},pl=y("删除"),fl={class:"mycard"},ml={class:"el-card__header",style:{height:"32px"}},_l=y("首页展示"),kl={class:"color999"},yl={key:0,class:"imgs_list flex"},bl={class:"imgbox"},gl=["src"],hl=["onClick"],Cl=["onClick"],wl={class:"imginfo"},xl={class:"imgname els"},jl={class:"imglink fcs"},zl={class:"fcc"},Vl={class:"fsc imgicon"},Ul={class:"fcs"},Ol=W((()=>k("span",null,"0",-1))),Ml=["onClick"],Pl={class:"fsc f1"},Sl=y("所有视频"),ql={class:"color999"},Dl=y("+ 添加"),Fl={key:0,class:"imgs_list flex fww"},$l={class:"imgbox"},El=["src"],Il={key:0,class:"is_top_show fcc"},Rl=W((()=>k("div",null,"展示中",-1))),Ll=["onClick"],Ql=["onClick"],Zl={class:"imginfo"},Al={class:"imgname els"},Bl={class:"imglink fcs"},Gl={class:"fcc"},Hl={class:"fsc imgicon"},Jl={class:"fcs"},Kl=W((()=>k("span",null,"0",-1))),Nl={class:"fcs"},Tl=["onClick"],Wl=["onClick"],Xl={key:0,class:"poolbox"},Yl=["src"],la={key:1,class:"fc fcc"},aa=W((()=>k("div",{class:"file_name"},"点击添加",-1))),ea={class:"fcs btns fjend mt20"},sa=y("取消"),ta=y("提交"),ia=c((oa=((l,a)=>{for(var e in a||(a={}))t.call(a,e)&&o(l,e,a[e]);if(s)for(var e of s(a))i.call(a,e)&&o(l,e,a[e]);return l})({},{name:"School"}),a(oa,e({setup(l){const a=u(1),e=u([]),s=u(1),t=u(20),i=u(0),o=async()=>{const l=await O({size:t.value,current:s.value});1==l.status&&(e.value=l.body.records,i.value=l.body.total)};o();const c=u(""),z=u(!1),V=async()=>{1==(await P({id:c.value})).status&&(z.value=!1,o())},Q=u([]),W=async()=>{const{status:l,body:a}=await S({status:1});1==l&&(Q.value=a)};W();const ia=u(1),oa=u(20),ca=u(0),ua=u([]),da=async()=>{const{status:l,body:a}=await q({size:oa.value,current:ia.value});1==l&&(ca.value=a.total,ua.value=a.records)};da();const ra=(l,a=!1)=>{const e=a?Q.value.map((l=>l.cover_url)):ua.value.map((l=>l.cover_url));H(e,l)},na=()=>{_a.value.resetFields(),ka.value={},va.value=!1},va=u(!1),pa=[{value:1,label:"分类一"},{value:2,label:"分类二"},{value:3,label:"分类三"},{value:4,label:"分类四"},{value:5,label:"分类五"}],fa=d({video_type:[{required:!0,message:"请选择分类！",trigger:"change"}]}),ma=d({link:"",video_type:""}),_a=u(),ka=u({});Z.on("sel_tutorials",(l=>{ka.value=l}));const ya=()=>{_a.value.validate((async l=>{if(l){const{status:l}=await D({id:ka.value.id,link_url:ma.link,video_type:ma.video_type});1==l&&(na(),da())}}))},ba=async(l,a)=>{const{status:e}=await $({id:a||ka.value.id,status:l});1==e&&(da(),W())},ga=u(!1),ha=u(""),Ca=async()=>{const{status:l}=await F({id:ha.value});1==l&&(da(),W(),ga.value=!1)};return(l,u)=>{const d=U("el-button"),O=U("el-button-group"),P=U("el-table-column"),S=U("el-link"),q=U("el-table"),D=U("el-icon"),F=U("el-card"),$=U("el-form-item"),Z=U("el-option"),W=U("el-select"),wa=U("el-input"),xa=U("el-form"),ja=U("el-dialog");return r(),n("div",X,[v(F,null,{default:p((()=>[v(O,{class:"btn_tab"},{default:p((()=>[v(d,{class:f(1==a.value&&"btn_tab_active"),onClick:u[0]||(u[0]=l=>a.value=1)},{default:p((()=>[Y])),_:1},8,["class"]),v(d,{class:f(2==a.value&&"btn_tab_active"),onClick:u[1]||(u[1]=l=>a.value=2)},{default:p((()=>[ll])),_:1},8,["class"])])),_:1}),al,m(k("div",null,[k("div",el,[sl,v(d,{type:"primary",onClick:u[2]||(u[2]=a=>l.$router.push("addarticle"))},{default:p((()=>[tl])),_:1})]),k("div",il,[v(q,{data:e.value,border:"",draggable:""},{empty:p((()=>[v(E)])),default:p((()=>[v(P,{prop:"title",label:"标题"}),v(P,{prop:"article_type",label:"分类"}),v(P,{prop:"create_time",label:"发布时间"},{default:p((({row:l})=>[y(b(g(L)(new Date(l.create_time))),1)])),_:1}),v(P,{prop:"hits",label:"查看量"}),v(P,{prop:"status",label:"状态"},{default:p((({row:l})=>[k("div",ol,[k("div",{class:f(["status_dot",1==l.status?"sdot_b":2==l.status?"sdot_r":"sdot_g"])},null,2),k("div",null,b(1==l.status?"草稿":2==l.status?"离线":"在线"),1)])])),_:1}),v(P,{label:"操作",fixed:"right",width:"240"},{default:p((({row:a})=>[k("div",cl,[1!=a.status?(r(),h(S,{key:0,type:"primary",onClick:e=>l.$router.push("articledetails?id="+a.id)},{default:p((()=>[ul])),_:2},1032,["onClick"])):C("",!0),1!=a.status?(r(),n("div",dl)):C("",!0),1!=a.status?(r(),h(S,{key:2,type:"primary",onClick:l=>(async(l,a)=>{1==(await M({id:l,status:a})).status&&o()})(a.id,2==a.status?3:2)},{default:p((()=>[y(b(2==a.status?"上线":"下线"),1)])),_:2},1032,["onClick"])):C("",!0),2==a.status?(r(),n("div",rl)):C("",!0),3!=a.status?(r(),h(S,{key:4,type:"primary",onClick:e=>l.$router.push("addarticle?id="+a.id)},{default:p((()=>[nl])),_:2},1032,["onClick"])):C("",!0),3!=a.status?(r(),n("div",vl)):C("",!0),3!=a.status?(r(),h(S,{key:6,type:"primary",onClick:l=>{return e=a.id,c.value=e,void(z.value=!0);var e}},{default:p((()=>[pl])),_:2},1032,["onClick"])):C("",!0)])])),_:1})])),_:1},8,["data"])]),v(I,{total:i.value,page:s.value,"onUpdate:page":u[3]||(u[3]=l=>s.value=l),onChange:o,size:t.value,"onUpdate:size":u[4]||(u[4]=l=>t.value=l)},null,8,["total","page","size"])],512),[[_,1==a.value]]),v(R,{modelValue:z.value,"onUpdate:modelValue":u[5]||(u[5]=l=>z.value=l),msg:"此文章删除后无法撤回，请谨慎删除！",onSure:V},null,8,["modelValue"]),m(k("div",null,[k("div",fl,[k("div",ml,[_l,k("span",kl,"（"+b(Q.value.length)+"）",1)])]),Q.value.length?(r(),n("div",yl,[(r(!0),n(w,null,x(Q.value,((l,a)=>(r(),n("div",{class:"imgs_item",key:l.id},[k("div",bl,[k("img",{src:l.cover_url,alt:""},null,8,gl),k("div",{class:"lookicon fcc lookhover",onClick:l=>ra(a,!0)},[v(D,{size:"20px"},{default:p((()=>[v(g(A))])),_:1})],8,hl),k("div",{class:"videoicon fcc lookhover",onClick:a=>g(J)(l.video_url)},[v(D,{size:"40px"},{default:p((()=>[v(g(B))])),_:1})],8,Cl)]),k("div",wl,[k("div",xl,b(l.video_name),1),k("div",jl,[k("span",zl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(S,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[y(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),k("div",Vl,[k("div",Ul,[v(D,{size:"14px"},{default:p((()=>[v(g(N))])),_:1}),Ol]),k("div",{onClick:a=>ba(0,l.id),class:"chover dfcolor"},"下架",8,Ml)])])])))),128))])):(r(),h(E,{key:1}))],512),[[_,2==a.value]])])),_:1}),m(v(F,{class:"mycard mt20"},{header:p((()=>[k("div",Pl,[k("div",null,[Sl,k("span",ql,"（"+b(ca.value)+"）",1)]),v(d,{type:"primary",onClick:u[6]||(u[6]=l=>va.value=!0)},{default:p((()=>[Dl])),_:1})])])),default:p((()=>[ua.value.length?(r(),n("div",Fl,[(r(!0),n(w,null,x(ua.value,((l,a)=>(r(),n("div",{class:"imgs_item mb20",key:l.id},[k("div",$l,[k("img",{src:l.cover_url,alt:""},null,8,El),1==l.status?(r(),n("div",Il,[v(D,{size:"14px"},{default:p((()=>[v(g(T))])),_:1}),Rl])):C("",!0),k("div",{class:"lookicon fcc lookhover",onClick:l=>ra(a)},[v(D,{size:"20px"},{default:p((()=>[v(g(A))])),_:1})],8,Ll),k("div",{class:"videoicon fcc lookhover",onClick:a=>g(J)(l.video_url)},[v(D,{size:"40px"},{default:p((()=>[v(g(B))])),_:1})],8,Ql)]),k("div",Zl,[k("div",Al,b(l.video_name),1),k("div",Bl,[k("span",Gl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(S,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[y(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),k("div",Hl,[k("div",Jl,[v(D,{size:"14px"},{default:p((()=>[v(g(N))])),_:1}),Kl]),k("div",Nl,[0==l.status?(r(),n("div",{key:0,onClick:a=>{return e=l.id,ha.value=e,void(ga.value=!0);var e},class:"chover dfcolor mr20"},"删除",8,Tl)):C("",!0),k("div",{onClick:a=>ba(1==l.status?0:1,l.id),class:"chover dfcolor"},b(1==l.status?"下架":"上架"),9,Wl)])])])])))),128))])):(r(),h(E,{key:1})),v(I,{total:ca.value,page:ia.value,"onUpdate:page":u[7]||(u[7]=l=>ia.value=l),onChange:da,size:oa.value,"onUpdate:size":u[8]||(u[8]=l=>oa.value=l)},null,8,["total","page","size"])])),_:1},512),[[_,2==a.value]]),v(R,{modelValue:ga.value,"onUpdate:modelValue":u[9]||(u[9]=l=>ga.value=l),msg:"确认删除此视频?",onSure:Ca},null,8,["modelValue"]),v(ja,{modelValue:va.value,"onUpdate:modelValue":u[15]||(u[15]=l=>va.value=l),title:"添加视频",width:"380px",onClose:na},{default:p((()=>[v(xa,{model:g(ma),rules:g(fa),ref_key:"addFormRef",ref:_a},{default:p((()=>[v($,{label:"选择视频",required:"","label-width":"90px"},{default:p((()=>[k("div",{class:"sel_pool fcc",onClick:u[12]||(u[12]=l=>g(K)("sel_tutorials",2,!0))},[ka.value.id?(r(),n("div",Xl,[k("img",{src:ka.value.cover_url,alt:""},null,8,Yl),k("div",{class:"lookicon fcc lookhover",onClick:u[10]||(u[10]=j((l=>g(H)([ka.value.cover_url],0)),["stop"]))},[v(D,{size:"14px"},{default:p((()=>[v(g(A))])),_:1})]),k("div",{class:"videoicon fcc lookhover",onClick:u[11]||(u[11]=j((l=>g(J)(ka.value.video_url)),["stop"]))},[v(D,{size:"20px"},{default:p((()=>[v(g(B))])),_:1})])])):(r(),n("div",la,[v(D,null,{default:p((()=>[v(g(G))])),_:1}),aa]))])])),_:1}),v($,{label:"视频分类",prop:"video_type","label-width":"90px"},{default:p((()=>[v(W,{modelValue:g(ma).video_type,"onUpdate:modelValue":u[13]||(u[13]=l=>g(ma).video_type=l),placeholder:"请选择视频分类",class:"f1"},{default:p((()=>[(r(),n(w,null,x(pa,(l=>v(Z,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),v($,{label:"添加链接",prop:"link","label-width":"90px"},{default:p((()=>[v(wa,{modelValue:g(ma).link,"onUpdate:modelValue":u[14]||(u[14]=l=>g(ma).link=l),placeholder:"请输入链接"},null,8,["modelValue"])])),_:1}),k("div",ea,[v(d,{onClick:na},{default:p((()=>[sa])),_:1}),v(d,{type:"primary",onClick:ya,disabled:!ka.value.id},{default:p((()=>[ta])),_:1},8,["disabled"])])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}))));var oa,ca=Q(ia,[["__scopeId","data-v-95a51498"]]);export{ca as default};
