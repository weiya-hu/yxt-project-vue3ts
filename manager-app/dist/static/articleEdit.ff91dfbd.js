var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,s=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&u(e,l,a[l]);if(r)for(var l of r(a))d.call(a,l)&&u(e,l,a[l]);return e},o=(e,r)=>a(e,l(r));import{G as i,g as n,o as A,H as c,I as m,a as b,C as p,_,c as v,w as y,P as g,aa as f,$ as j,a0 as k,aw as q,ax as U,a1 as w,az as B,av as h,b as I,ae as x,a2 as C}from"./vue.73bee448.js";import{M as L}from"./MediaUpload.a05c5b86.js";import{D as V}from"./DetailsHeader.b84bab8d.js";import{K as O}from"./KzAddArticle.feacbb22.js";import{e as R,a as S}from"./index.188a36b0.js";import{f as G,g as P,h as D,i as E}from"./resource.ea9bb646.js";import{m as K}from"./index.fd3330ea.js";import{_ as M}from"./index.69d32547.js";import"./login.b5af171c.js";import"./request.d2675abe.js";const Y=e=>(q("data-v-8d2ea6b8"),e=e(),U(),e),z={class:"article_add"},F={class:"fsc"},N={class:"addform"},Q={class:"tip fcs"},W=["src"],J=Y((()=>m("span",null,"请注意：根据国家相关法律法规要求，切勿发布任何色情、低俗、涉政等违法违规内容。一旦出现，我们将会根据法规进行审核处理。",-1))),H=Y((()=>m("div",{class:"form_title"},"内容设置",-1))),X={class:"fcs"},Z={class:"fc"},T=w("免费下载"),$=w("弹窗二维码"),ee={class:"btns fjend"},ae=w("返回"),le=w("保存"),re=w("发布");var te=M(i({setup(e){const a=K(),l=B(),r=h(),t=l.query.id,d=n(!1);t?G({id:t}).then((e=>{te.value={url:e.body.url,url_key:e.body.url_key,down_type:e.body.down_type,industry_id:e.body.industry_id,qr_code:e.body.qr_code},i.value.setForm({thumb_url:e.body.thumb_url,title:e.body.title,text:e.body.content,digest:e.body.digest}),d.value=!0})):d.value=!0;const u=n([]);(async()=>{const e=await P();u.value=e.body})();const i=n(),q=n(1),U=e=>{q.value=e,i.value.validate().then((e=>{Y.value.validate((a=>{e&&a&&(oe.value=!0,ie.value.imgs.length?ie.value.submit():i.value.submit())}))}))},M=async e=>{oe.value=!1;const l={content:e.text,digest:e.digest,down_type:te.value.down_type,industry_id:te.value.industry_id,qr_code:te.value.qr_code,thumb_url:e.thumb_url,title:e.title,url:te.value.url,url_key:te.value.url_key},{status:d}=1==q.value?await D(o(s({},l),{id:t})):await E(o(s({},l),{id:t}));1==d&&(a.setKeepList([]),r.replace("/cms/resourceart"))},Y=n(),te=n({url:"",url_key:"",down_type:1,industry_id:"",qr_code:""}),de={url:[{required:!0,message:"请输入第三方URL链接",trigger:"blur"}],url_key:[{required:!0,message:"第三方URL秘钥：",trigger:"blur"}],qr_code:[{validator:(e,a,l)=>{2!=te.value.down_type||a?l():l(new Error("请添加二维码"))},trigger:"blur"}]},ue=e=>{1==e&&Y.value.clearValidate("qr_code")},se=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],oe=n(!1),ie=n(),ne=e=>{te.value.qr_code=e,i.value.submit()},Ae=e=>{R(e),oe.value=!1},ce=(e,a)=>{S(e,a)},me=()=>{te.value.qr_code=ie.value.imgs[0].url,Y.value.validateField("qr_code",(()=>null))};return(e,a)=>{const l=I("el-input"),r=I("el-form-item"),t=I("el-radio"),s=I("el-radio-group"),o=I("el-form"),n=I("el-button"),q=I("el-card"),B=x("loading");return A(),c("div",z,[m("div",F,[b(V)]),m("div",N,[m("div",Q,[m("img",{src:p("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAHAAAAABkvfSiAAACJklEQVRIDb1WvUoDQRCePRUfIF2sBNHaQjBINBZ2ioJWqfUtUuYR7LS2UhDttPAnoIKFtSBYqdU9gIg5v5nsXPbuXO+i5gaGmZ2Z3e9md253DBWg6IpmKaINhNbBE+CqnfYK+QLukKFjs0QP1u4VxuuBI7qgLYg2eOanOMf3CL1llunQsSXUbwGR0SQyOgDPJ6KLDgzdIeMmMn5OT8kARte0RJ90hMBKOnjAcUgjtGkW6cqdlwAUsC6dI7MxNyilv+Prz8UW0QrkeMrfHxr6oIBWXNAYULaxS/eIzstsB2e0z6vijLch9lj/gUKAzun2BnEgn1k+GIc/xXOSumNOqBWpB2sSQKnG3xZIYm3PAGvbikeyPeLSHzYJRiA/dfH/7C8fNcNYAfaXb5ByCFi8pXxdlUV1BuS7sSyaYEC9iMsArWqVlgHGGBED8hMzCE05wa7umL3q2yhc/J5Ne0Oyjt3oktbF3LtLsxF+ywsDdsDL/piMZxy/0mrGWszQCfilLhZrowzgDN1YjgacexzYtoBf6nxiMKJ106AFZoBugIuCPjKWVmkrH00ibgF0qrFY4AT6rY5zpGAIoPQg3BYMi7C29jmaIWFrmsALczBrqNA1jbF6TcceGdq1xR2/+DzCm9WA8wyn4m8xemem21iTEvIgYS1/i6Fzht1E9bfUIkrDgx4EX/f7M+W53MekOjaGSGypZqnStgVtjIfbCCugSukK/qnV/wLexIn2JhCVswAAAABJRU5ErkJggg=="),alt:""},null,8,W),J]),b(O,{ref_key:"addRef",ref:i,needimg:"",needdigest:"",onSuccess:M},null,512)]),_((A(),v(q,{class:"mycard mt20"},{default:y((()=>[H,b(o,{ref_key:"aFormRef",ref:Y,model:te.value,rules:de,"hide-required-asterisk":""},{default:y((()=>[m("div",X,[b(r,{label:"第三方URL链接：",prop:"url",class:"mr20"},{default:y((()=>[b(l,{modelValue:te.value.url,"onUpdate:modelValue":a[0]||(a[0]=e=>te.value.url=e),placeholder:"请输入第三方URL链接"},null,8,["modelValue"])])),_:1}),b(r,{label:"第三方URL秘钥：",prop:"url_key"},{default:y((()=>[b(l,{modelValue:te.value.url_key,"onUpdate:modelValue":a[1]||(a[1]=e=>te.value.url_key=e),placeholder:"请输入第三方URL秘钥"},null,8,["modelValue"])])),_:1})]),b(r,{label:"行业分类：",prop:"industry_id"},{default:y((()=>[b(s,{modelValue:te.value.industry_id,"onUpdate:modelValue":a[2]||(a[2]=e=>te.value.industry_id=e)},{default:y((()=>[(A(!0),c(g,null,f(u.value,(e=>(A(),v(t,{key:e.id,label:e.id},{default:y((()=>[w(C(e.industry_name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),b(r,{label:"下载设置：",prop:"down_type",style:{"margin-bottom":"0"}},{default:y((()=>[m("div",Z,[b(s,{modelValue:te.value.down_type,"onUpdate:modelValue":a[3]||(a[3]=e=>te.value.down_type=e),onChange:ue},{default:y((()=>[b(t,{label:1},{default:y((()=>[T])),_:1}),b(t,{label:2},{default:y((()=>[$])),_:1})])),_:1},8,["modelValue"]),b(r,{prop:"qr_code"},{default:y((()=>[d.value?_((A(),v(L,{key:0,ref_key:"upload",ref:ie,max:1,"exname-list":se,"img-list":te.value.qr_code?[te.value.qr_code]:[],msg:"只能上传"+se.join("、")+"图片，不超过2M",onUpOneSuccess:ne,onError:Ae,onLook:ce,onDel:a[4]||(a[4]=e=>te.value.qr_code=""),onChange:me},null,8,["img-list","msg"])),[[j,2==te.value.down_type]]):k("",!0)])),_:1})])])),_:1})])),_:1},8,["model"]),m("div",ee,[b(n,{class:"bdc_btn",onClick:a[5]||(a[5]=a=>e.$router.push("/cms/resource"))},{default:y((()=>[ae])),_:1}),b(n,{class:"bdc_btn",onClick:a[6]||(a[6]=e=>U(1))},{default:y((()=>[le])),_:1}),b(n,{type:"primary",disabled:!te.value.industry_id,onClick:a[7]||(a[7]=e=>U(2))},{default:y((()=>[re])),_:1},8,["disabled"])])])),_:1})),[[B,oe.value]])])}}}),[["__scopeId","data-v-8d2ea6b8"]]);export{te as default};
