import{M as e}from"./Mypage.92221329.js";import{M as a}from"./MyEmpty.72a1acd1.js";import{M as l}from"./MyDialog.50f39301.js";import{M as s,d as o}from"./MediaUpload.b9b76e58.js";import{M as u}from"./MyUpload.2ae4dd0d.js";import{f as d,e as t,a as r,k as c,l as i,i as m}from"./index.eaa6bc8d.js";import{u as n,g as v,i as p,j as f}from"./system.6d9b699b.js";import{f as _}from"./date.23847c74.js";import{_ as y,f as g,m as b}from"./index.fdca730b.js";import{e as k}from"./edit.719ac390.js";import{q as V,f as j,_ as C,o as x,t as h,v as M,a as U,w,V as z,F as N,a2 as q,c as E,Q as F,u as S,S as G,U as L,b as P,a6 as D}from"./vue.89ed3d48.js";import"./empty.f131d8fb.js";import"./login.6de82fdd.js";import"./request.aa9790cc.js";const I={class:"videopool_page"},J={class:"fsc topbox"},A={class:"fcs"},O=L("搜索"),Q={class:"fcs"},R={class:"total mr20"},T=L("+ 上传"),B={key:0,class:"imgs_list flex"},H=["onClick"],K=["src"],W={class:"lookicon fcc"},X={class:"imginfo"},Y={class:"imgname els"},Z={class:"imgsize"},$={class:"fcs fjend imgicon"},ee={class:"fcs btns fjend mt20"},ae=L("取消"),le=L("提交"),se={class:"fcs btns fjend mt20"},oe=L("取消"),ue=L("提交");var de=y(V({setup(y){const V=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],L=[".mp4"],de=j(!1),te=j(!1),re=j(),ce=async e=>{const a=await n({cover_url:e,source_url:ye.source_url,source_name:ye.source_name,source_type:2});a&&1==a.status?(ke(),he(),d(2)):te.value=!1},ie=e=>{t(e),te.value=!1},me=(e,a)=>{r(e,a)},ne=j(),ve=e=>{ye.source_name=e},pe=e=>{t(e),te.value=!1},fe=e=>{ye.source_url=e,re.value.submit()},_e=j(),ye=C({source_name:"",source_oldName:"",source_url:""}),ge=C({source_name:[{required:!0,message:"请输入视频名称！",trigger:"blur"}]}),be=()=>{_e.value.validateField("source_name",(e=>{e&&(te.value=!0,ne.value.submit())}))},ke=()=>{te.value=!1,_e.value.resetFields(),ne.value.clear(),de.value=!1},Ve=j([]),je=j(0),Ce=j(1),xe=j(""),he=async()=>{const{body:e,status:a}=await v({size:10,current:Ce.value,sourceType:2,sourceName:xe.value});1==a&&(Ve.value=e.records,je.value=e.total)};he();const Me=()=>{Ce.value=1,he()},Ue=j(0),we=j(""),ze=j(!1),Ne=async()=>{const{status:e}=await p({id:Ue.value});1==e&&(Ve.value.findIndex((e=>e.id==Ue.value)),ze.value=!1,he(),d(2))},qe=j(!1),Ee=async()=>{const{status:e}=await f({id:Ue.value,source_name:we.value});1==e&&(qe.value=!1,he(),d(2))},Fe=e=>{te.value?c().then((()=>{ne.value.doAbort(),e()})).catch((()=>{})):e()};return(d,t)=>{const r=P("el-input"),c=P("el-button"),n=P("el-icon"),v=P("el-tooltip"),p=P("el-dialog"),f=P("el-form-item"),y=P("el-form"),j=D("loading");return x(),h("div",I,[M("div",J,[M("div",A,[U(r,{modelValue:xe.value,"onUpdate:modelValue":t[0]||(t[0]=e=>xe.value=e),placeholder:"输入视频名关键字搜索",clearable:""},null,8,["modelValue"]),U(c,{type:"primary",class:"ml20",onClick:Me},{default:w((()=>[O])),_:1})]),M("div",Q,[M("div",R,"共"+z(je.value)+"条",1),U(c,{type:"primary",onClick:t[1]||(t[1]=e=>de.value=!0)},{default:w((()=>[T])),_:1})])]),je.value?(x(),h("div",B,[(x(!0),h(N,null,q(Ve.value,(e=>(x(),h("div",{class:"imgs_item",key:e.id},[M("div",{class:"imgbox lookhover",onClick:a=>S(i)(e.source_url)},[M("img",{src:e.cover_url,alt:""},null,8,K),M("div",W,[U(n,{size:"40px"},{default:w((()=>[U(S(g))])),_:1})])],8,H),M("div",X,[M("div",Y,z(e.source_name),1),M("div",Z,z(S(_)(new Date(e.create_time),"yyyy-MM-dd")),1),M("div",$,[U(v,{effect:"dark",content:"下载",placement:"bottom"},{default:w((()=>[U(n,{class:"chover",size:"18px",onClick:a=>S(m)(e.source_url,e.source_name)},{default:w((()=>[U(S(o))])),_:2},1032,["onClick"])])),_:2},1024),U(v,{effect:"dark",content:"修改名称",placement:"bottom"},{default:w((()=>[U(n,{class:"chover",size:"18px",onClick:a=>{return l=e,Ue.value=l.id,we.value=l.source_name,void(qe.value=!0);var l}},{default:w((()=>[U(S(k))])),_:2},1032,["onClick"])])),_:2},1024),U(v,{effect:"dark",content:"删除",placement:"bottom"},{default:w((()=>[U(n,{class:"chover",size:"18px",onClick:a=>{return l=e,Ue.value=l.id,we.value=l.source_name,void(ze.value=!0);var l}},{default:w((()=>[U(S(b))])),_:2},1032,["onClick"])])),_:2},1024)])])])))),128))])):(x(),E(a,{key:1})),U(e,{page:Ce.value,"onUpdate:page":t[2]||(t[2]=e=>Ce.value=e),total:je.value,onChange:he,"hide-sizes":!0},null,8,["page","total"]),U(l,{modelValue:ze.value,"onUpdate:modelValue":t[3]||(t[3]=e=>ze.value=e),msg:"确认删除视频 “ "+we.value+" ” ?",onSure:Ne},null,8,["modelValue","msg"]),U(p,{modelValue:qe.value,"onUpdate:modelValue":t[6]||(t[6]=e=>qe.value=e),title:"修改名称",width:"380px",onClose:t[7]||(t[7]=e=>we.value="")},{default:w((()=>[U(r,{modelValue:we.value,"onUpdate:modelValue":t[4]||(t[4]=e=>we.value=e),placeholder:"请输入视频名"},null,8,["modelValue"]),M("div",ee,[U(c,{onClick:t[5]||(t[5]=e=>qe.value=!1)},{default:w((()=>[ae])),_:1}),U(c,{type:"primary",onClick:Ee,disabled:!we.value},{default:w((()=>[le])),_:1},8,["disabled"])])])),_:1},8,["modelValue"]),U(p,{modelValue:de.value,"onUpdate:modelValue":t[10]||(t[10]=e=>de.value=e),title:"上传视频",width:"380px",onClose:ke,"before-close":Fe},{default:w((()=>[F((x(),E(y,{model:S(ye),rules:S(ge),ref_key:"addFormRef",ref:_e},{default:w((()=>[U(f,{label:"视 频",required:""},{default:w((()=>[U(u,{type:"video",modelValue:S(ye).source_oldName,"onUpdate:modelValue":t[8]||(t[8]=e=>S(ye).source_oldName=e),"max-size":200,onError:pe,onSuccess:fe,onChangeName:ve,exnameList:L,msg:"只能上传"+L.join("、")+"视频，不超过200M，推荐尺寸1280*720",ref_key:"upVideo",ref:ne},null,8,["modelValue","msg"])])),_:1}),U(f,{label:"名 称",prop:"source_name"},{default:w((()=>[U(r,{modelValue:S(ye).source_name,"onUpdate:modelValue":t[9]||(t[9]=e=>S(ye).source_name=e),placeholder:"请输入视频名"},null,8,["modelValue"])])),_:1}),U(f,{label:"封面图",required:""},{default:w((()=>[de.value?(x(),E(s,{key:0,max:1,onUpOneSuccess:ce,onError:ie,onLook:me,exnameList:V,msg:"只能上传"+V.join("、")+"图片，不超过2M",ref_key:"upload",ref:re},null,8,["msg"])):G("",!0)])),_:1}),M("div",se,[U(c,{onClick:ke},{default:w((()=>[oe])),_:1}),re.value?(x(),E(c,{key:0,type:"primary",onClick:be,disabled:!re.value.imgs.length||!S(ye).source_oldName},{default:w((()=>[ue])),_:1},8,["disabled"])):G("",!0)])])),_:1},8,["model","rules"])),[[j,te.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-b08d98ba"]]);export{de as default};
