import{M as e}from"./Mypage.0335a2c8.js";import{M as a}from"./MyEmpty.07f2695e.js";import{M as l}from"./MyDialog.f51fc1f9.js";import{M as s}from"./MediaUpload.097c4d0a.js";import{h as o,e as u,a as t,k as d}from"./index.c36e50f5.js";import{u as c,g as n,i,j as r}from"./system.5f819dbe.js";import{_ as m,z as v,l as f}from"./index.4a788974.js";import{d as p}from"./download.8374d866.js";import{e as _}from"./edit.7a542607.js";import{G as g,g as b,j as k,o as y,H as h,I as j,a as V,w as C,a2 as x,P as w,aa as M,c as U,_ as z,C as G,a0 as L,a1 as P,b as q,ae as E}from"./vue.73bee448.js";import"./empty.f131d8fb.js";import"./login.a80e1ce3.js";import"./request.71e82bfd.js";const F={class:"imagepool_page"},I={class:"fsc topbox"},D={class:"fcs"},H=P("搜索"),J={class:"fcs"},N={class:"total mr20"},S=P("+ 上传"),O={key:0,class:"imgs_list flex"},R=["onClick"],T=["src","onLoad"],W={class:"lookicon fcc"},A={class:"imginfo"},B={class:"imgname els"},K={class:"imgsize"},Q={class:"fcs fjend imgicon"},X=["href"],Y={class:"fcs btns fjend mt20"},Z=P("取消"),$=P("提交"),ee={class:"fcs btns fjend mt20"},ae=P("取消"),le=P("提交");var se=m(g({setup(m){const g=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],P=b(!1),se=b(!1),oe=b(),ue=e=>{ie.source_name=e},te=async e=>{const a=await c({source_url:e,source_name:ie.source_name,source_type:1});a&&1==a.status?(ve(),ke(),o(1)):se.value=!1},de=e=>{u(e),se.value=!1},ce=(e,a)=>{t(e,a)},ne=b(),ie=k({source_name:""}),re=k({source_name:[{required:!0,message:"请输入图片名称！",trigger:"blur"}]}),me=()=>{ne.value.validateField("source_name",(e=>{e&&(se.value=!0,oe.value.submit(ie.source_name))}))},ve=()=>{se.value=!1,ne.value.resetFields(),P.value=!1},fe=b({}),pe=b([]),_e=b(0),ge=b(1),be=b(""),ke=async()=>{const{body:e,status:a}=await n({size:10,current:ge.value,sourceType:1,sourceName:be.value});1==a&&(pe.value=e.records,_e.value=e.total)};ke();const ye=()=>{ge.value=1,ke()},he=()=>{fe.value={},ke()},je=b(0),Ve=b(""),Ce=b(!1),xe=async()=>{const{status:e}=await i({id:je.value});1==e&&(pe.value.findIndex((e=>e.id==je.value)),Ce.value=!1,ke(),o(1))},we=b(!1),Me=async()=>{const{status:e}=await r({id:je.value,source_name:Ve.value});1==e&&(we.value=!1,ke(),o(1))},Ue=e=>{se.value?d().then((()=>{e()})).catch((()=>{})):e()};return(o,u)=>{const d=q("el-input"),c=q("el-button"),n=q("el-icon"),i=q("el-tooltip"),r=q("el-dialog"),m=q("el-form-item"),b=q("el-form"),k=E("loading");return y(),h("div",F,[j("div",I,[j("div",D,[V(d,{modelValue:be.value,"onUpdate:modelValue":u[0]||(u[0]=e=>be.value=e),placeholder:"输入图片名关键字搜索",clearable:""},null,8,["modelValue"]),V(c,{class:"ml20 bdc_btn",onClick:ye},{default:C((()=>[H])),_:1})]),j("div",J,[j("div",N,"共"+x(_e.value)+"条",1),V(c,{type:"primary",onClick:u[1]||(u[1]=e=>P.value=!0)},{default:C((()=>[S])),_:1})])]),_e.value?(y(),h("div",O,[(y(!0),h(w,null,M(pe.value,((e,a)=>(y(),h("div",{class:"imgs_item",key:e.id},[j("div",{class:"imgbox lookhover",onClick:e=>(e=>{const a=pe.value.map((e=>e.source_url));t(a,e)})(a)},[j("img",{src:e.source_url,alt:"",onLoad:a=>((e,a)=>{const l=a.path[0];fe.value[e]=l.naturalWidth+"*"+l.naturalHeight})(e.id,a)},null,40,T),j("div",W,[V(n,{size:"20px"},{default:C((()=>[V(G(v))])),_:1})])],8,R),j("div",A,[j("div",B,x(e.source_name),1),j("div",K,x(fe.value[e.id]),1),j("div",Q,[V(i,{effect:"dark",content:"下载",placement:"bottom"},{default:C((()=>[j("a",{href:e.source_url,class:"fcc download_a"},[V(n,{class:"chover",size:"18px"},{default:C((()=>[V(G(p))])),_:1})],8,X)])),_:2},1024),V(i,{effect:"dark",content:"修改名称",placement:"bottom"},{default:C((()=>[V(n,{class:"chover",size:"18px",onClick:a=>{return l=e,je.value=l.id,Ve.value=l.source_name,void(we.value=!0);var l}},{default:C((()=>[V(G(_))])),_:2},1032,["onClick"])])),_:2},1024),V(i,{effect:"dark",content:"删除",placement:"bottom"},{default:C((()=>[V(n,{class:"chover",size:"18px",onClick:a=>{return l=e,je.value=l.id,Ve.value=l.source_name,void(Ce.value=!0);var l}},{default:C((()=>[V(G(f))])),_:2},1032,["onClick"])])),_:2},1024)])])])))),128))])):(y(),U(a,{key:1})),V(e,{page:ge.value,"onUpdate:page":u[2]||(u[2]=e=>ge.value=e),total:_e.value,onChange:he,"hide-sizes":!0},null,8,["page","total"]),V(l,{modelValue:Ce.value,"onUpdate:modelValue":u[3]||(u[3]=e=>Ce.value=e),msg:"确认删除图片 “ "+Ve.value+" ” ?",onSure:xe},null,8,["modelValue","msg"]),V(r,{modelValue:we.value,"onUpdate:modelValue":u[6]||(u[6]=e=>we.value=e),title:"修改名称",width:"380px",onClose:u[7]||(u[7]=e=>Ve.value="")},{default:C((()=>[V(d,{modelValue:Ve.value,"onUpdate:modelValue":u[4]||(u[4]=e=>Ve.value=e),placeholder:"请输入图片名"},null,8,["modelValue"]),j("div",Y,[V(c,{onClick:u[5]||(u[5]=e=>we.value=!1)},{default:C((()=>[Z])),_:1}),V(c,{type:"primary",onClick:Me,disabled:!Ve.value},{default:C((()=>[$])),_:1},8,["disabled"])])])),_:1},8,["modelValue"]),V(r,{modelValue:P.value,"onUpdate:modelValue":u[10]||(u[10]=e=>P.value=e),title:"上传图片",width:"380px",onClose:ve,"before-close":Ue},{default:C((()=>[z((y(),U(b,{model:G(ie),rules:G(re),ref_key:"addFormRef",ref:ne},{default:C((()=>[V(m,{label:"图片",required:""},{default:C((()=>[P.value?(y(),U(s,{key:0,max:1,"need-download":"",onUpOneSuccess:te,onError:de,onLook:ce,onChange:ue,onDel:u[8]||(u[8]=e=>G(ie).source_name=""),exnameList:g,msg:"只能上传"+g.join("、")+"图片，不超过2M",ref_key:"upload",ref:oe},null,8,["msg"])):L("",!0)])),_:1}),V(m,{label:"名称",prop:"source_name"},{default:C((()=>[V(d,{modelValue:G(ie).source_name,"onUpdate:modelValue":u[9]||(u[9]=e=>G(ie).source_name=e),placeholder:"请输入图片名"},null,8,["modelValue"])])),_:1}),j("div",ee,[V(c,{onClick:ve},{default:C((()=>[ae])),_:1}),oe.value?(y(),U(c,{key:0,type:"primary",onClick:me,disabled:!oe.value.imgs.length},{default:C((()=>[le])),_:1},8,["disabled"])):L("",!0)])])),_:1},8,["model","rules"])),[[k,se.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6dedb28f"]]);export{se as default};
