var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,c=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&o(e,r,t[r]);if(a)for(var r of a(t))i.call(t,r)&&o(e,r,t[r]);return e},l=(e,a)=>t(e,r(a));import{G as u,g as n,o as d,H as m,I as p,a as b,w as f,a1 as y,az as j,av as v,b as _}from"./vue.73bee448.js";import{m as w}from"./index.e7a3094c.js";import{D as O}from"./DetailsHeader.945bd2c0.js";import{K as g}from"./KzAddArticle.4cf9b08c.js";import{e as x,i as h,j as P,k}from"./website.aa3bab02.js";import{w as D}from"./index.3ae96932.js";import"./index.e7872df1.js";import"./tinymce.5416ef76.js";import"./login.df5d82cd.js";import"./request.7878c8f3.js";const K={class:"add_article"},q={class:"fsc"},z={class:"btns"},A=y("稍后编辑"),C=y("提交"),H=u({setup(e){const t=w(),r=j(),a=v(),s=r.query.id,i=async()=>{const{status:e,body:t}=await x({id:s});if(1==e){if(3==t.status)return D("请下线文章后再编辑"),void a.replace("/website/inform/dynamic/dynamicdetails?id="+s);o.value.setForm({title:t.title,article_type:Number(t.type_id),text:t.content,thumb_url:t.thumb_url,creator:t.creator,source_url:t.source_url,source:t.source})}};s&&i();const o=n(),u=n(1),y=async e=>{u.value=e,o.value.submit()},H=async e=>{const r={content:e.text,source:e.source,source_url:e.source_url,type_id:e.article_type,thumb_url:e.thumb_url,title:e.title,creator:e.creator},{status:i}=1===u.value?await h(l(c({},r),{id:s})):await P(l(c({},r),{id:s}));1===i&&(t.setKeepList([]),a.replace("/website/inform/dynamic"))},I=n([]);return(async()=>{const e=await k();1===e.status&&(I.value=e.body.map((e=>({label:e.name,value:e.id}))),s&&i())})(),(e,t)=>{const r=_("el-button");return d(),m("div",K,[p("div",q,[b(O),p("div",z,[b(r,{class:"bdc_btn",onClick:t[0]||(t[0]=e=>y(1))},{default:f((()=>[A])),_:1}),b(r,{type:"primary",onClick:t[1]||(t[1]=e=>y(2))},{default:f((()=>[C])),_:1})])]),b(g,{ref_key:"addRef",ref:o,needimg:"",needtype:"",needsource:1,types:I.value,onSuccess:H},null,8,["types"])])}}});export{H as default};
