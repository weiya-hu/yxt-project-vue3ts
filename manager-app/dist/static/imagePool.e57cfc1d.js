import{M as e}from"./Mypage.e0572b95.js";import{M as a}from"./MyEmpty.4bf64012.js";import{M as l}from"./MyDialog.6c30b2a5.js";import{M as s}from"./MediaUpload.684cde42.js";import{h as o,e as u,a as t,k as d,i}from"./index.aeb80721.js";import{u as c,g as n,i as r,j as m}from"./system.b10b868e.js";import{_ as v,z as p,l as f}from"./index.2ae254bd.js";import{d as _}from"./download.0d5bab84.js";import{e as b}from"./edit.6948c01c.js";import{G as g,g as k,j as y,o as j,H as h,I as C,a as V,w as x,a2 as M,P as U,aa as w,c as z,_ as G,C as L,a0 as P,a1 as q,b as E,ae as F}from"./vue.73bee448.js";import"./empty.f131d8fb.js";import"./login.f44d1550.js";import"./request.b31e1908.js";const I={class:"imagepool_page"},D={class:"fsc topbox"},H={class:"fcs"},J=q("搜索"),N={class:"fcs"},S={class:"total mr20"},O=q("+ 上传"),R={key:0,class:"imgs_list flex"},T=["onClick"],W=["src","onLoad"],A={class:"lookicon fcc"},B={class:"imginfo"},K={class:"imgname els"},Q={class:"imgsize"},X={class:"fcs fjend imgicon"},Y={class:"fcs btns fjend mt20"},Z=q("取消"),$=q("提交"),ee={class:"fcs btns fjend mt20"},ae=q("取消"),le=q("提交");var se=v(g({setup(v){const g=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],q=k(!1),se=k(!1),oe=k(),ue=e=>{ne.source_name=e},te=async e=>{const a=await c({source_url:e,source_name:ne.source_name,source_type:1});a&&1==a.status?(ve(),ke(),o(1)):se.value=!1},de=e=>{u(e),se.value=!1},ie=(e,a)=>{t(e,a)},ce=k(),ne=y({source_name:""}),re=y({source_name:[{required:!0,message:"请输入图片名称！",trigger:"blur"}]}),me=()=>{ce.value.validateField("source_name",(e=>{e&&(se.value=!0,oe.value.submit())}))},ve=()=>{se.value=!1,ce.value.resetFields(),q.value=!1},pe=k({}),fe=k([]),_e=k(0),be=k(1),ge=k(""),ke=async()=>{const{body:e,status:a}=await n({size:10,current:be.value,sourceType:1,sourceName:ge.value});1==a&&(fe.value=e.records,_e.value=e.total)};ke();const ye=()=>{be.value=1,ke()},je=()=>{pe.value={},ke()},he=k(0),Ce=k(""),Ve=k(!1),xe=async()=>{const{status:e}=await r({id:he.value});1==e&&(fe.value.findIndex((e=>e.id==he.value)),Ve.value=!1,ke(),o(1))},Me=k(!1),Ue=async()=>{const{status:e}=await m({id:he.value,source_name:Ce.value});1==e&&(Me.value=!1,ke(),o(1))},we=e=>{se.value?d().then((()=>{e()})).catch((()=>{})):e()};return(o,u)=>{const d=E("el-input"),c=E("el-button"),n=E("el-icon"),r=E("el-tooltip"),m=E("el-dialog"),v=E("el-form-item"),k=E("el-form"),y=F("loading");return j(),h("div",I,[C("div",D,[C("div",H,[V(d,{modelValue:ge.value,"onUpdate:modelValue":u[0]||(u[0]=e=>ge.value=e),placeholder:"输入图片名关键字搜索",clearable:""},null,8,["modelValue"]),V(c,{class:"ml20 bdc_btn",onClick:ye},{default:x((()=>[J])),_:1})]),C("div",N,[C("div",S,"共"+M(_e.value)+"条",1),V(c,{type:"primary",onClick:u[1]||(u[1]=e=>q.value=!0)},{default:x((()=>[O])),_:1})])]),_e.value?(j(),h("div",R,[(j(!0),h(U,null,w(fe.value,((e,a)=>(j(),h("div",{class:"imgs_item",key:e.id},[C("div",{class:"imgbox lookhover",onClick:e=>(e=>{const a=fe.value.map((e=>e.source_url));t(a,e)})(a)},[C("img",{src:e.source_url,alt:"",onLoad:a=>((e,a)=>{const l=a.path[0];pe.value[e]=l.naturalWidth+"*"+l.naturalHeight})(e.id,a)},null,40,W),C("div",A,[V(n,{size:"20px"},{default:x((()=>[V(L(p))])),_:1})])],8,T),C("div",B,[C("div",K,M(e.source_name),1),C("div",Q,M(pe.value[e.id]),1),C("div",X,[V(r,{effect:"dark",content:"下载",placement:"bottom"},{default:x((()=>[V(n,{class:"chover",size:"18px",onClick:a=>L(i)(e.source_url,e.source_name)},{default:x((()=>[V(L(_))])),_:2},1032,["onClick"])])),_:2},1024),V(r,{effect:"dark",content:"修改名称",placement:"bottom"},{default:x((()=>[V(n,{class:"chover",size:"18px",onClick:a=>{return l=e,he.value=l.id,Ce.value=l.source_name,void(Me.value=!0);var l}},{default:x((()=>[V(L(b))])),_:2},1032,["onClick"])])),_:2},1024),V(r,{effect:"dark",content:"删除",placement:"bottom"},{default:x((()=>[V(n,{class:"chover",size:"18px",onClick:a=>{return l=e,he.value=l.id,Ce.value=l.source_name,void(Ve.value=!0);var l}},{default:x((()=>[V(L(f))])),_:2},1032,["onClick"])])),_:2},1024)])])])))),128))])):(j(),z(a,{key:1})),V(e,{page:be.value,"onUpdate:page":u[2]||(u[2]=e=>be.value=e),total:_e.value,onChange:je,"hide-sizes":!0},null,8,["page","total"]),V(l,{modelValue:Ve.value,"onUpdate:modelValue":u[3]||(u[3]=e=>Ve.value=e),msg:"确认删除图片 “ "+Ce.value+" ” ?",onSure:xe},null,8,["modelValue","msg"]),V(m,{modelValue:Me.value,"onUpdate:modelValue":u[6]||(u[6]=e=>Me.value=e),title:"修改名称",width:"380px",onClose:u[7]||(u[7]=e=>Ce.value="")},{default:x((()=>[V(d,{modelValue:Ce.value,"onUpdate:modelValue":u[4]||(u[4]=e=>Ce.value=e),placeholder:"请输入图片名"},null,8,["modelValue"]),C("div",Y,[V(c,{onClick:u[5]||(u[5]=e=>Me.value=!1)},{default:x((()=>[Z])),_:1}),V(c,{type:"primary",onClick:Ue,disabled:!Ce.value},{default:x((()=>[$])),_:1},8,["disabled"])])])),_:1},8,["modelValue"]),V(m,{modelValue:q.value,"onUpdate:modelValue":u[10]||(u[10]=e=>q.value=e),title:"上传图片",width:"380px",onClose:ve,"before-close":we},{default:x((()=>[G((j(),z(k,{model:L(ne),rules:L(re),ref_key:"addFormRef",ref:ce},{default:x((()=>[V(v,{label:"图片",required:""},{default:x((()=>[q.value?(j(),z(s,{key:0,max:1,onUpOneSuccess:te,onError:de,onLook:ie,onChange:ue,onDel:u[8]||(u[8]=e=>L(ne).source_name=""),exnameList:g,msg:"只能上传"+g.join("、")+"图片，不超过2M",ref_key:"upload",ref:oe},null,8,["msg"])):P("",!0)])),_:1}),V(v,{label:"名称",prop:"source_name"},{default:x((()=>[V(d,{modelValue:L(ne).source_name,"onUpdate:modelValue":u[9]||(u[9]=e=>L(ne).source_name=e),placeholder:"请输入图片名"},null,8,["modelValue"])])),_:1}),C("div",ee,[V(c,{onClick:ve},{default:x((()=>[ae])),_:1}),oe.value?(j(),z(c,{key:0,type:"primary",onClick:me,disabled:!oe.value.imgs.length},{default:x((()=>[le])),_:1},8,["disabled"])):P("",!0)])])),_:1},8,["model","rules"])),[[y,se.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6b0c5b28"]]);export{se as default};
