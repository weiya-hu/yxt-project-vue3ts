var l=Object.defineProperty,a=Object.defineProperties,e=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(a,e,s)=>e in a?l(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;import{G as u,g as c,j as d,o as r,H as n,a as v,w as p,W as f,_ as m,$ as _,I as k,a1 as y,a2 as b,C as g,c as h,a0 as C,P as w,aa as x,a6 as j,aw as z,ax as V,b as O}from"./vue.73bee448.js";import{h as U,i as P,j as M,k as S,l as $,m as q,n as D,o as I}from"./service.c79881eb.js";import{M as E}from"./MyEmpty.d21dbe7c.js";import{M as F}from"./MyPage.0cd03366.js";import{M as G}from"./MyDialog.32fde60c.js";import{f as H}from"./date.23847c74.js";import{_ as R,e as W,z as A,f as B,p as J}from"./index.12522c67.js";import{a as K,l as L,c as N}from"./index.a86c6ab1.js";import{p as Q}from"./pointer.6a3e3519.js";import{c as T}from"./collection-tag.0bc7fe57.js";import"./request.b31062f2.js";import"./empty.f131d8fb.js";const X=l=>(z("data-v-95a51498"),l=l(),V(),l),Y={class:"school_page"},Z=y("文章"),ll=y("视频"),al=X((()=>k("div",{class:"long_line"},null,-1))),el={class:"fsc mycard"},sl=X((()=>k("div",{class:"el-card__header"},"文章列表",-1))),tl=y("添加"),il={class:"mytable"},ol={class:"fcs"},ul={class:"fcs"},cl=y("查看"),dl={key:1,class:"line"},rl={key:3,class:"line"},nl=y("编辑"),vl={key:5,class:"line"},pl=y("删除"),fl={class:"mycard"},ml={class:"el-card__header",style:{height:"32px"}},_l=y("首页展示"),kl={class:"color999"},yl={key:0,class:"imgs_list flex"},bl={class:"imgbox"},gl=["src"],hl=["onClick"],Cl=["onClick"],wl={class:"imginfo"},xl={class:"imgname els"},jl={class:"imglink fcs"},zl={class:"fcc"},Vl={class:"fsc imgicon"},Ol={class:"fcs"},Ul=X((()=>k("span",null,"0",-1))),Pl=["onClick"],Ml={class:"fsc f1"},Sl=y("所有视频"),$l={class:"color999"},ql=y("+ 添加"),Dl={key:0,class:"imgs_list flex fww"},Il={class:"imgbox"},El=["src"],Fl={key:0,class:"is_top_show fcc"},Gl=X((()=>k("div",null,"展示中",-1))),Hl=["onClick"],Rl=["onClick"],Wl={class:"imginfo"},Al={class:"imgname els"},Bl={class:"imglink fcs"},Jl={class:"fcc"},Kl={class:"fsc imgicon"},Ll={class:"fcs"},Nl=X((()=>k("span",null,"0",-1))),Ql={class:"fcs"},Tl=["onClick"],Xl=["onClick"],Yl={key:0,class:"poolbox"},Zl=["src"],la={key:1,class:"fc fcc"},aa=X((()=>k("div",{class:"file_name"},"点击添加",-1))),ea={class:"fcs btns fjend mt20"},sa=y("取消"),ta=y("提交"),ia=u((oa=((l,a)=>{for(var e in a||(a={}))t.call(a,e)&&o(l,e,a[e]);if(s)for(var e of s(a))i.call(a,e)&&o(l,e,a[e]);return l})({},{name:"School"}),a(oa,e({setup(l){const a=c(1),e=c([]),s=c(1),t=c(20),i=c(0),o=async()=>{const l=await U({size:t.value,current:s.value});1==l.status&&(e.value=l.body.records,i.value=l.body.total)};o();const u=c(""),z=c(!1),V=async()=>{1==(await M({id:u.value})).status&&(z.value=!1,o())},R=c([]),X=async()=>{const{status:l,body:a}=await S({status:1});1==l&&(R.value=a)};X();const ia=c(1),oa=c(20),ua=c(0),ca=c([]),da=async()=>{const{status:l,body:a}=await $({size:oa.value,current:ia.value});1==l&&(ua.value=a.total,ca.value=a.records)};da();const ra=(l,a=!1)=>{const e=a?R.value.map((l=>l.cover_url)):ca.value.map((l=>l.cover_url));K(e,l)},na=()=>{_a.value.resetFields(),ka.value={},va.value=!1},va=c(!1),pa=[{value:1,label:"分类一"},{value:2,label:"分类二"},{value:3,label:"分类三"},{value:4,label:"分类四"},{value:5,label:"分类五"}],fa=d({video_type:[{required:!0,message:"请选择分类！",trigger:"change"}]}),ma=d({link:"",video_type:""}),_a=c(),ka=c({});W.on("sel_tutorials",(l=>{ka.value=l}));const ya=()=>{_a.value.validate((async l=>{if(l){const{status:l}=await q({id:ka.value.id,link_url:ma.link,video_type:ma.video_type});1==l&&(na(),da())}}))},ba=async(l,a)=>{const{status:e}=await I({id:a||ka.value.id,status:l});1==e&&(da(),X())},ga=c(!1),ha=c(""),Ca=async()=>{const{status:l}=await D({id:ha.value});1==l&&(da(),X(),ga.value=!1)};return(l,c)=>{const d=O("el-button"),U=O("el-button-group"),M=O("el-table-column"),S=O("el-link"),$=O("el-table"),q=O("el-icon"),D=O("el-card"),I=O("el-form-item"),W=O("el-option"),X=O("el-select"),wa=O("el-input"),xa=O("el-form"),ja=O("el-dialog");return r(),n("div",Y,[v(D,null,{default:p((()=>[v(U,{class:"btn_tab"},{default:p((()=>[v(d,{class:f(1==a.value&&"btn_tab_active"),onClick:c[0]||(c[0]=l=>a.value=1)},{default:p((()=>[Z])),_:1},8,["class"]),v(d,{class:f(2==a.value&&"btn_tab_active"),onClick:c[1]||(c[1]=l=>a.value=2)},{default:p((()=>[ll])),_:1},8,["class"])])),_:1}),al,m(k("div",null,[k("div",el,[sl,v(d,{type:"primary",onClick:c[2]||(c[2]=a=>l.$router.push("addarticle"))},{default:p((()=>[tl])),_:1})]),k("div",il,[v($,{data:e.value,border:"",draggable:""},{empty:p((()=>[v(E)])),default:p((()=>[v(M,{prop:"title",label:"标题"}),v(M,{prop:"article_type",label:"分类"}),v(M,{prop:"create_time",label:"发布时间"},{default:p((({row:l})=>[y(b(g(H)(new Date(l.create_time))),1)])),_:1}),v(M,{prop:"hits",label:"查看量"}),v(M,{prop:"status",label:"状态"},{default:p((({row:l})=>[k("div",ol,[k("div",{class:f(["status_dot",1==l.status?"sdot_b":2==l.status?"sdot_r":"sdot_g"])},null,2),k("div",null,b(1==l.status?"草稿":2==l.status?"离线":"在线"),1)])])),_:1}),v(M,{label:"操作",fixed:"right",width:"240"},{default:p((({row:a})=>[k("div",ul,[1!=a.status?(r(),h(S,{key:0,type:"primary",onClick:e=>l.$router.push("articledetails?id="+a.id)},{default:p((()=>[cl])),_:2},1032,["onClick"])):C("",!0),1!=a.status?(r(),n("div",dl)):C("",!0),1!=a.status?(r(),h(S,{key:2,type:"primary",onClick:l=>(async(l,a)=>{1==(await P({id:l,status:a})).status&&o()})(a.id,2==a.status?3:2)},{default:p((()=>[y(b(2==a.status?"上线":"下线"),1)])),_:2},1032,["onClick"])):C("",!0),2==a.status?(r(),n("div",rl)):C("",!0),3!=a.status?(r(),h(S,{key:4,type:"primary",onClick:e=>l.$router.push("addarticle?id="+a.id)},{default:p((()=>[nl])),_:2},1032,["onClick"])):C("",!0),3!=a.status?(r(),n("div",vl)):C("",!0),3!=a.status?(r(),h(S,{key:6,type:"primary",onClick:l=>{return e=a.id,u.value=e,void(z.value=!0);var e}},{default:p((()=>[pl])),_:2},1032,["onClick"])):C("",!0)])])),_:1})])),_:1},8,["data"])]),v(F,{total:i.value,page:s.value,"onUpdate:page":c[3]||(c[3]=l=>s.value=l),onChange:o,size:t.value,"onUpdate:size":c[4]||(c[4]=l=>t.value=l)},null,8,["total","page","size"])],512),[[_,1==a.value]]),v(G,{modelValue:z.value,"onUpdate:modelValue":c[5]||(c[5]=l=>z.value=l),msg:"此文章删除后无法撤回，请谨慎删除！",onSure:V},null,8,["modelValue"]),m(k("div",null,[k("div",fl,[k("div",ml,[_l,k("span",kl,"（"+b(R.value.length)+"）",1)])]),R.value.length?(r(),n("div",yl,[(r(!0),n(w,null,x(R.value,((l,a)=>(r(),n("div",{class:"imgs_item",key:l.id},[k("div",bl,[k("img",{src:l.cover_url,alt:""},null,8,gl),k("div",{class:"lookicon fcc lookhover",onClick:l=>ra(a,!0)},[v(q,{size:"20px"},{default:p((()=>[v(g(A))])),_:1})],8,hl),k("div",{class:"videoicon fcc lookhover",onClick:a=>g(L)(l.video_url)},[v(q,{size:"40px"},{default:p((()=>[v(g(B))])),_:1})],8,Cl)]),k("div",wl,[k("div",xl,b(l.video_name),1),k("div",jl,[k("span",zl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(S,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[y(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),k("div",Vl,[k("div",Ol,[v(q,{size:"14px"},{default:p((()=>[v(g(Q))])),_:1}),Ul]),k("div",{onClick:a=>ba(0,l.id),class:"chover dfcolor"},"下架",8,Pl)])])])))),128))])):(r(),h(E,{key:1}))],512),[[_,2==a.value]])])),_:1}),m(v(D,{class:"mycard mt20"},{header:p((()=>[k("div",Ml,[k("div",null,[Sl,k("span",$l,"（"+b(ua.value)+"）",1)]),v(d,{type:"primary",onClick:c[6]||(c[6]=l=>va.value=!0)},{default:p((()=>[ql])),_:1})])])),default:p((()=>[ca.value.length?(r(),n("div",Dl,[(r(!0),n(w,null,x(ca.value,((l,a)=>(r(),n("div",{class:"imgs_item mb20",key:l.id},[k("div",Il,[k("img",{src:l.cover_url,alt:""},null,8,El),1==l.status?(r(),n("div",Fl,[v(q,{size:"14px"},{default:p((()=>[v(g(T))])),_:1}),Gl])):C("",!0),k("div",{class:"lookicon fcc lookhover",onClick:l=>ra(a)},[v(q,{size:"20px"},{default:p((()=>[v(g(A))])),_:1})],8,Hl),k("div",{class:"videoicon fcc lookhover",onClick:a=>g(L)(l.video_url)},[v(q,{size:"40px"},{default:p((()=>[v(g(B))])),_:1})],8,Rl)]),k("div",Wl,[k("div",Al,b(l.video_name),1),k("div",Bl,[k("span",Jl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(S,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[y(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),k("div",Kl,[k("div",Ll,[v(q,{size:"14px"},{default:p((()=>[v(g(Q))])),_:1}),Nl]),k("div",Ql,[0==l.status?(r(),n("div",{key:0,onClick:a=>{return e=l.id,ha.value=e,void(ga.value=!0);var e},class:"chover dfcolor mr20"},"删除",8,Tl)):C("",!0),k("div",{onClick:a=>ba(1==l.status?0:1,l.id),class:"chover dfcolor"},b(1==l.status?"下架":"上架"),9,Xl)])])])])))),128))])):(r(),h(E,{key:1})),v(F,{total:ua.value,page:ia.value,"onUpdate:page":c[7]||(c[7]=l=>ia.value=l),onChange:da,size:oa.value,"onUpdate:size":c[8]||(c[8]=l=>oa.value=l)},null,8,["total","page","size"])])),_:1},512),[[_,2==a.value]]),v(G,{modelValue:ga.value,"onUpdate:modelValue":c[9]||(c[9]=l=>ga.value=l),msg:"确认删除此视频?",onSure:Ca},null,8,["modelValue"]),v(ja,{modelValue:va.value,"onUpdate:modelValue":c[15]||(c[15]=l=>va.value=l),title:"添加视频",width:"380px",onClose:na},{default:p((()=>[v(xa,{model:g(ma),rules:g(fa),ref_key:"addFormRef",ref:_a},{default:p((()=>[v(I,{label:"选择视频",required:"","label-width":"90px"},{default:p((()=>[k("div",{class:"sel_pool fcc",onClick:c[12]||(c[12]=l=>g(N)("sel_tutorials",2,!0))},[ka.value.id?(r(),n("div",Yl,[k("img",{src:ka.value.cover_url,alt:""},null,8,Zl),k("div",{class:"lookicon fcc lookhover",onClick:c[10]||(c[10]=j((l=>g(K)([ka.value.cover_url],0)),["stop"]))},[v(q,{size:"14px"},{default:p((()=>[v(g(A))])),_:1})]),k("div",{class:"videoicon fcc lookhover",onClick:c[11]||(c[11]=j((l=>g(L)(ka.value.video_url)),["stop"]))},[v(q,{size:"20px"},{default:p((()=>[v(g(B))])),_:1})])])):(r(),n("div",la,[v(q,null,{default:p((()=>[v(g(J))])),_:1}),aa]))])])),_:1}),v(I,{label:"视频分类",prop:"video_type","label-width":"90px"},{default:p((()=>[v(X,{modelValue:g(ma).video_type,"onUpdate:modelValue":c[13]||(c[13]=l=>g(ma).video_type=l),placeholder:"请选择视频分类",class:"f1"},{default:p((()=>[(r(),n(w,null,x(pa,(l=>v(W,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),v(I,{label:"添加链接",prop:"link","label-width":"90px"},{default:p((()=>[v(wa,{modelValue:g(ma).link,"onUpdate:modelValue":c[14]||(c[14]=l=>g(ma).link=l),placeholder:"请输入链接"},null,8,["modelValue"])])),_:1}),k("div",ea,[v(d,{onClick:na},{default:p((()=>[sa])),_:1}),v(d,{type:"primary",onClick:ya,disabled:!ka.value.id},{default:p((()=>[ta])),_:1},8,["disabled"])])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}))));var oa,ua=R(ia,[["__scopeId","data-v-95a51498"]]);export{ua as default};
