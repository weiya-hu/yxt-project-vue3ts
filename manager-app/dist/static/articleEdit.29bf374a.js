var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,u=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,s=(e,a)=>{for(var l in a||(a={}))d.call(a,l)&&u(e,l,a[l]);if(r)for(var l of r(a))t.call(a,l)&&u(e,l,a[l]);return e},o=(e,r)=>a(e,l(r));import{G as i,g as n,o as c,H as m,I as _,a as p,C as v,_ as b,c as y,w as f,P as g,aa as j,$ as w,a0 as k,aw as q,ax as h,a1 as V,az as U,av as O,b as x,ae as P,a2 as L}from"./vue.73bee448.js";import{t as R}from"./tip.19edb433.js";import{M as C}from"./MediaUpload.684cde42.js";import{D}from"./DetailsHeader.04989b1a.js";import{K as E}from"./KzAddArticle.eb5db19d.js";import{e as G,a as F}from"./index.aeb80721.js";import{f as I,g as K,h as M,i as S}from"./resource.4f57787f.js";import{m as z}from"./index.4593ca48.js";import{_ as A}from"./index.2ae254bd.js";import"./login.f44d1550.js";import"./request.b31e1908.js";const H=e=>(q("data-v-8d2ea6b8"),e=e(),h(),e),J={class:"article_add"},$={class:"fsc"},N={class:"addform"},B={class:"tip fcs"},Q=["src"],T=H((()=>_("span",null,"请注意：根据国家相关法律法规要求，切勿发布任何色情、低俗、涉政等违法违规内容。一旦出现，我们将会根据法规进行审核处理。",-1))),W=H((()=>_("div",{class:"form_title"},"内容设置",-1))),X={class:"fcs"},Y={class:"fc"},Z=V("免费下载"),ee=V("弹窗二维码"),ae={class:"btns fjend"},le=V("返回"),re=V("保存"),de=V("发布");var te=A(i({setup(e){const a=z(),l=U(),r=O(),d=l.query.id,t=n(!1);d?I({id:d}).then((e=>{te.value={url:e.body.url,url_key:e.body.url_key,down_type:e.body.down_type,industry_id:e.body.industry_id,qr_code:e.body.qr_code},i.value.setForm({thumb_url:e.body.thumb_url,title:e.body.title,text:e.body.content,digest:e.body.digest}),t.value=!0})):t.value=!0;const u=n([]);(async()=>{const e=await K();u.value=e.body})();const i=n(),q=n(1),h=e=>{q.value=e,i.value.validate().then((e=>{H.value.validate((a=>{e&&a&&(ie.value=!0,ne.value.imgs.length?ne.value.submit():i.value.submit())}))}))},A=async e=>{ie.value=!1;const l={content:e.text,digest:e.digest,down_type:te.value.down_type,industry_id:te.value.industry_id,qr_code:te.value.qr_code,thumb_url:e.thumb_url,title:e.title,url:te.value.url,url_key:te.value.url_key},{status:t}=1==q.value?await M(o(s({},l),{id:d})):await S(o(s({},l),{id:d}));1==t&&(a.setKeepList([]),r.replace("/cms/resourceart"))},H=n(),te=n({url:"",url_key:"",down_type:1,industry_id:"",qr_code:""}),ue={url:[{required:!0,message:"请输入第三方URL链接",trigger:"blur"}],url_key:[{required:!0,message:"第三方URL秘钥：",trigger:"blur"}],qr_code:[{validator:(e,a,l)=>{2!=te.value.down_type||a?l():l(new Error("请添加二维码"))},trigger:"blur"}]},se=e=>{1==e&&H.value.clearValidate("qr_code")},oe=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],ie=n(!1),ne=n(),ce=e=>{te.value.qr_code=e,i.value.submit()},me=e=>{G(e),ie.value=!1},_e=(e,a)=>{F(e,a)},pe=()=>{te.value.qr_code=ne.value.imgs[0].url,H.value.validateField("qr_code",(()=>null))};return(e,a)=>{const l=x("el-input"),r=x("el-form-item"),d=x("el-radio"),s=x("el-radio-group"),o=x("el-form"),n=x("el-button"),q=x("el-card"),U=P("loading");return c(),m("div",J,[_("div",$,[p(D)]),_("div",N,[_("div",B,[_("img",{src:v(R),alt:""},null,8,Q),T]),p(E,{ref_key:"addRef",ref:i,needimg:"",needdigest:"",onSuccess:A},null,512)]),b((c(),y(q,{class:"mycard mt20"},{default:f((()=>[W,p(o,{ref_key:"aFormRef",ref:H,model:te.value,rules:ue,"hide-required-asterisk":""},{default:f((()=>[_("div",X,[p(r,{label:"第三方URL链接：",prop:"url",class:"mr20"},{default:f((()=>[p(l,{modelValue:te.value.url,"onUpdate:modelValue":a[0]||(a[0]=e=>te.value.url=e),placeholder:"请输入第三方URL链接"},null,8,["modelValue"])])),_:1}),p(r,{label:"第三方URL秘钥：",prop:"url_key"},{default:f((()=>[p(l,{modelValue:te.value.url_key,"onUpdate:modelValue":a[1]||(a[1]=e=>te.value.url_key=e),placeholder:"请输入第三方URL秘钥"},null,8,["modelValue"])])),_:1})]),p(r,{label:"行业分类：",prop:"industry_id"},{default:f((()=>[p(s,{modelValue:te.value.industry_id,"onUpdate:modelValue":a[2]||(a[2]=e=>te.value.industry_id=e)},{default:f((()=>[(c(!0),m(g,null,j(u.value,(e=>(c(),y(d,{key:e.id,label:e.id},{default:f((()=>[V(L(e.industry_name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(r,{label:"下载设置：",prop:"down_type",style:{"margin-bottom":"0"}},{default:f((()=>[_("div",Y,[p(s,{modelValue:te.value.down_type,"onUpdate:modelValue":a[3]||(a[3]=e=>te.value.down_type=e),onChange:se},{default:f((()=>[p(d,{label:1},{default:f((()=>[Z])),_:1}),p(d,{label:2},{default:f((()=>[ee])),_:1})])),_:1},8,["modelValue"]),p(r,{prop:"qr_code"},{default:f((()=>[t.value?b((c(),y(C,{key:0,ref_key:"upload",ref:ne,max:1,"exname-list":oe,"img-list":te.value.qr_code?[te.value.qr_code]:[],msg:"只能上传"+oe.join("、")+"图片，不超过2M",onUpOneSuccess:ce,onError:me,onLook:_e,onDel:a[4]||(a[4]=e=>te.value.qr_code=""),onChange:pe},null,8,["img-list","msg"])),[[w,2==te.value.down_type]]):k("",!0)])),_:1})])])),_:1})])),_:1},8,["model"]),_("div",ae,[p(n,{class:"bdc_btn",onClick:a[5]||(a[5]=a=>e.$router.push("/cms/resource"))},{default:f((()=>[le])),_:1}),p(n,{class:"bdc_btn",onClick:a[6]||(a[6]=e=>h(1))},{default:f((()=>[re])),_:1}),p(n,{type:"primary",disabled:!te.value.industry_id,onClick:a[7]||(a[7]=e=>h(2))},{default:f((()=>[de])),_:1},8,["disabled"])])])),_:1})),[[U,ie.value]])])}}}),[["__scopeId","data-v-8d2ea6b8"]]);export{te as default};
