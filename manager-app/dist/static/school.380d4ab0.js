var l=Object.defineProperty,a=Object.defineProperties,e=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(a,e,s)=>e in a?l(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;import{G as c,g as u,j as d,o as r,H as n,a as v,w as p,W as f,_ as m,$ as _,I as y,a1 as k,a2 as b,C as g,c as h,a0 as C,P as w,aa as j,a6 as x,aw as z,ax as V,b as O}from"./vue.73bee448.js";import{j as U,k as P,l as M,m as q,n as S,o as $,p as D,q as I,r as E,t as F}from"./service.94da7b7d.js";import{M as N}from"./MyEmpty.8e216a46.js";import{M as G}from"./MyPage.2c8a4bc7.js";import{M as H}from"./MyDialog.d8f2932e.js";import{f as R}from"./date.23847c74.js";import{_ as W,e as A,z as B,d as J,p as K}from"./index.aefc30ce.js";import{a as L,l as Q,c as T}from"./index.6c11e008.js";import{p as X}from"./pointer.02748ba9.js";import{c as Y}from"./collection-tag.02b4db59.js";import"./request.65081ce8.js";import"./empty.f131d8fb.js";import"./tinymce.5416ef76.js";const Z=l=>(z("data-v-52c6ccf5"),l=l(),V(),l),ll={class:"school_page"},al=k("文章"),el=k("视频"),sl=Z((()=>y("div",{class:"long_line"},null,-1))),tl={class:"fsc mycard"},il=Z((()=>y("div",{class:"el-card__header"},"文章列表",-1))),ol=k("添加"),cl={class:"mytable"},ul={class:"fcs"},dl={class:"fcs"},rl=k("查看"),nl={key:1,class:"line"},vl={key:3,class:"line"},pl=k("编辑"),fl={key:5,class:"line"},ml=k("删除"),_l={class:"mycard"},yl={class:"el-card__header",style:{height:"32px"}},kl=k("首页展示"),bl={class:"color999"},gl={class:"imgs_list imgs_list_top"},hl={class:"imgbox"},Cl=["src"],wl=["onClick"],jl=["onClick"],xl={class:"imginfo"},zl={class:"imgname els"},Vl={class:"imglink fcs"},Ol={class:"fcc"},Ul={class:"fsc imgicon"},Pl={class:"fcs"},Ml=Z((()=>y("span",null,"0",-1))),ql=["onClick"],Sl={class:"fsc f1"},$l=k("所有视频"),Dl={class:"color999"},Il=k("+ 添加"),El={key:0,class:"imgs_list imgs_list_all flex fww"},Fl={class:"imgbox"},Nl=["src"],Gl={key:0,class:"is_top_show fcc"},Hl=Z((()=>y("div",null,"展示中",-1))),Rl=["onClick"],Wl=["onClick"],Al={class:"imginfo"},Bl={class:"imgname els"},Jl={class:"imglink fcs"},Kl={class:"fcc"},Ll={class:"fsc imgicon"},Ql={class:"fcs"},Tl=Z((()=>y("span",null,"0",-1))),Xl={class:"fcs"},Yl=["onClick"],Zl=["onClick"],la={key:0,class:"poolbox"},aa=["src"],ea={key:1,class:"fc fcc"},sa=Z((()=>y("div",{class:"file_name"},"点击添加",-1))),ta={class:"fcs btns fjend mt20"},ia=k("取消"),oa=k("提交"),ca=c((ua=((l,a)=>{for(var e in a||(a={}))t.call(a,e)&&o(l,e,a[e]);if(s)for(var e of s(a))i.call(a,e)&&o(l,e,a[e]);return l})({},{name:"School"}),a(ua,e({setup(l){const a=u(1),e=u({});(async()=>{const{status:l,body:a}=await U();1==l&&(e.value=a,c())})();const s=u([]),t=u(1),i=u(20),o=u(0),c=async()=>{const l=await P({size:i.value,current:t.value});1==l.status&&(s.value=l.body.records,o.value=l.body.total)},z=u(""),V=u(!1),W=async()=>{1==(await q({id:z.value})).status&&(V.value=!1,c())},Z=u([]);(async()=>{const{status:l,body:a}=await S();if(1==l){for(const[l,e]of Object.entries(a))Z.value.push({value:Number(l),label:e});ua(),pa()}})();const ca=u([]),ua=async()=>{const{status:l,body:a}=await $({status:1});1==l&&(ca.value=a)},da=u(1),ra=u(20),na=u(0),va=u([]),pa=async()=>{const{status:l,body:a}=await D({size:ra.value,current:da.value});1==l&&(na.value=a.total,va.value=a.records)},fa=(l,a=!1)=>{const e=a?ca.value.map((l=>l.cover_url)):va.value.map((l=>l.cover_url));L(e,l)},ma=()=>{ba.value.resetFields(),ga.value={},_a.value=!1},_a=u(!1),ya=d({video_type:[{required:!0,message:"请选择分类！",trigger:"change"}]}),ka=d({link:"",video_type:""}),ba=u(),ga=u({});A.on("sel_school",(l=>{ga.value=l}));const ha=()=>{ba.value.validate((async l=>{if(l){const{status:l}=await I({id:ga.value.id,link_url:ka.link,video_type:ka.video_type});1==l&&(ma(),pa())}}))},Ca=async(l,a)=>{const{status:e}=await F({id:a||ga.value.id,status:l});1==e&&(pa(),ua())},wa=u(!1),ja=u(""),xa=async()=>{const{status:l}=await E({id:ja.value});1==l&&(pa(),ua(),wa.value=!1)};return(l,u)=>{const d=O("el-button"),U=O("el-button-group"),P=O("el-table-column"),q=O("el-link"),S=O("el-table"),$=O("el-icon"),D=O("el-scrollbar"),I=O("el-card"),E=O("el-form-item"),F=O("el-option"),A=O("el-select"),ua=O("el-input"),za=O("el-form"),Va=O("el-dialog");return r(),n("div",ll,[v(I,null,{default:p((()=>[v(U,{class:"btn_tab"},{default:p((()=>[v(d,{class:f(1==a.value&&"btn_tab_active"),onClick:u[0]||(u[0]=l=>a.value=1)},{default:p((()=>[al])),_:1},8,["class"]),v(d,{class:f(2==a.value&&"btn_tab_active"),onClick:u[1]||(u[1]=l=>a.value=2)},{default:p((()=>[el])),_:1},8,["class"])])),_:1}),sl,m(y("div",null,[y("div",tl,[il,v(d,{type:"primary",onClick:u[2]||(u[2]=a=>l.$router.push("addarticle"))},{default:p((()=>[ol])),_:1})]),y("div",cl,[v(S,{data:s.value,border:"",draggable:""},{empty:p((()=>[v(N)])),default:p((()=>[v(P,{prop:"title",label:"标题"}),v(P,{prop:"article_type",label:"分类"},{default:p((({row:l})=>[k(b(e.value[Number(l.article_type)]),1)])),_:1}),v(P,{prop:"create_time",label:"发布时间"},{default:p((({row:l})=>[k(b(g(R)(new Date(l.create_time))),1)])),_:1}),v(P,{prop:"hits",label:"查看量"}),v(P,{prop:"status",label:"状态"},{default:p((({row:l})=>[y("div",ul,[y("div",{class:f(["status_dot",1==l.status?"sdot_b":2==l.status?"sdot_r":"sdot_g"])},null,2),y("div",null,b(1==l.status?"草稿":2==l.status?"离线":"在线"),1)])])),_:1}),v(P,{label:"操作",fixed:"right",width:"240"},{default:p((({row:a})=>[y("div",dl,[1!=a.status?(r(),h(q,{key:0,type:"primary",onClick:e=>l.$router.push("articledetails?id="+a.id)},{default:p((()=>[rl])),_:2},1032,["onClick"])):C("",!0),1!=a.status?(r(),n("div",nl)):C("",!0),1!=a.status?(r(),h(q,{key:2,type:"primary",onClick:l=>(async(l,a)=>{1==(await M({id:l,status:a})).status&&c()})(a.id,2==a.status?3:2)},{default:p((()=>[k(b(2==a.status?"上线":"下线"),1)])),_:2},1032,["onClick"])):C("",!0),2==a.status?(r(),n("div",vl)):C("",!0),3!=a.status?(r(),h(q,{key:4,type:"primary",onClick:e=>l.$router.push("addarticle?id="+a.id)},{default:p((()=>[pl])),_:2},1032,["onClick"])):C("",!0),3!=a.status?(r(),n("div",fl)):C("",!0),3!=a.status?(r(),h(q,{key:6,type:"primary",onClick:l=>{return e=a.id,z.value=e,void(V.value=!0);var e}},{default:p((()=>[ml])),_:2},1032,["onClick"])):C("",!0)])])),_:1})])),_:1},8,["data"])]),v(G,{total:o.value,page:t.value,"onUpdate:page":u[3]||(u[3]=l=>t.value=l),onChange:c,size:i.value,"onUpdate:size":u[4]||(u[4]=l=>i.value=l)},null,8,["total","page","size"])],512),[[_,1==a.value]]),v(H,{modelValue:V.value,"onUpdate:modelValue":u[5]||(u[5]=l=>V.value=l),msg:"此文章删除后无法撤回，请谨慎删除！",onSure:W},null,8,["modelValue"]),m(y("div",null,[y("div",_l,[y("div",yl,[kl,y("span",bl,"（"+b(ca.value.length)+"）",1)])]),ca.value.length?(r(),h(D,{key:0},{default:p((()=>[y("div",gl,[(r(!0),n(w,null,j(ca.value,((l,a)=>(r(),n("div",{class:"imgs_item imgs_item_top",key:l.id},[y("div",hl,[y("img",{src:l.cover_url,alt:""},null,8,Cl),y("div",{class:"lookicon fcc lookhover",onClick:l=>fa(a,!0)},[v($,{size:"20px"},{default:p((()=>[v(g(B))])),_:1})],8,wl),y("div",{class:"videoicon fcc lookhover",onClick:a=>g(Q)(l.video_url)},[v($,{size:"40px"},{default:p((()=>[v(g(J))])),_:1})],8,jl)]),y("div",xl,[y("div",zl,b(l.video_name),1),y("div",Vl,[y("span",Ol,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(q,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[k(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),y("div",Ul,[y("div",Pl,[v($,{size:"14px"},{default:p((()=>[v(g(X))])),_:1}),Ml]),y("div",{onClick:a=>Ca(0,l.id),class:"chover dfcolor"},"下架",8,ql)])])])))),128))])])),_:1})):(r(),h(N,{key:1}))],512),[[_,2==a.value]])])),_:1}),m(v(I,{class:"mycard mt20"},{header:p((()=>[y("div",Sl,[y("div",null,[$l,y("span",Dl,"（"+b(na.value)+"）",1)]),v(d,{type:"primary",onClick:u[6]||(u[6]=l=>_a.value=!0)},{default:p((()=>[Il])),_:1})])])),default:p((()=>[va.value.length?(r(),n("div",El,[(r(!0),n(w,null,j(va.value,((l,a)=>(r(),n("div",{class:"imgs_item mb20",key:l.id},[y("div",Fl,[y("img",{src:l.cover_url,alt:""},null,8,Nl),1==l.status?(r(),n("div",Gl,[v($,{size:"14px"},{default:p((()=>[v(g(Y))])),_:1}),Hl])):C("",!0),y("div",{class:"lookicon fcc lookhover",onClick:l=>fa(a)},[v($,{size:"20px"},{default:p((()=>[v(g(B))])),_:1})],8,Rl),y("div",{class:"videoicon fcc lookhover",onClick:a=>g(Q)(l.video_url)},[v($,{size:"40px"},{default:p((()=>[v(g(J))])),_:1})],8,Wl)]),y("div",Al,[y("div",Bl,b(l.video_name),1),y("div",Jl,[y("span",Kl,b(l.link_url?"链接：":"无链接"),1),l.link_url?(r(),h(q,{key:0,type:"primary",target:"_blank",href:"//"+l.link_url},{default:p((()=>[k(b(l.link_url),1)])),_:2},1032,["href"])):C("",!0)]),y("div",Ll,[y("div",Ql,[v($,{size:"14px"},{default:p((()=>[v(g(X))])),_:1}),Tl]),y("div",Xl,[0==l.status?(r(),n("div",{key:0,onClick:a=>{return e=l.id,ja.value=e,void(wa.value=!0);var e},class:"chover dfcolor mr20"},"删除",8,Yl)):C("",!0),y("div",{onClick:a=>Ca(1==l.status?0:1,l.id),class:"chover dfcolor"},b(1==l.status?"下架":"上架"),9,Zl)])])])])))),128))])):(r(),h(N,{key:1})),v(G,{total:na.value,page:da.value,"onUpdate:page":u[7]||(u[7]=l=>da.value=l),onChange:pa,size:ra.value,"onUpdate:size":u[8]||(u[8]=l=>ra.value=l)},null,8,["total","page","size"])])),_:1},512),[[_,2==a.value]]),v(H,{modelValue:wa.value,"onUpdate:modelValue":u[9]||(u[9]=l=>wa.value=l),msg:"确认删除此视频?",onSure:xa},null,8,["modelValue"]),v(Va,{modelValue:_a.value,"onUpdate:modelValue":u[15]||(u[15]=l=>_a.value=l),title:"添加视频",width:"380px",onClose:ma},{default:p((()=>[v(za,{model:g(ka),rules:g(ya),ref_key:"addFormRef",ref:ba},{default:p((()=>[v(E,{label:"选择视频",required:"","label-width":"90px"},{default:p((()=>[y("div",{class:"sel_pool fcc",onClick:u[12]||(u[12]=l=>g(T)("sel_school",2,!0))},[ga.value.id?(r(),n("div",la,[y("img",{src:ga.value.cover_url,alt:""},null,8,aa),y("div",{class:"lookicon fcc lookhover",onClick:u[10]||(u[10]=x((l=>g(L)([ga.value.cover_url],0)),["stop"]))},[v($,{size:"14px"},{default:p((()=>[v(g(B))])),_:1})]),y("div",{class:"videoicon fcc lookhover",onClick:u[11]||(u[11]=x((l=>g(Q)(ga.value.video_url)),["stop"]))},[v($,{size:"20px"},{default:p((()=>[v(g(J))])),_:1})])])):(r(),n("div",ea,[v($,null,{default:p((()=>[v(g(K))])),_:1}),sa]))])])),_:1}),v(E,{label:"视频分类",prop:"video_type","label-width":"90px"},{default:p((()=>[v(A,{modelValue:g(ka).video_type,"onUpdate:modelValue":u[13]||(u[13]=l=>g(ka).video_type=l),placeholder:"请选择视频分类",class:"f1"},{default:p((()=>[(r(!0),n(w,null,j(Z.value,(l=>(r(),h(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(E,{label:"添加链接",prop:"link","label-width":"90px"},{default:p((()=>[v(ua,{modelValue:g(ka).link,"onUpdate:modelValue":u[14]||(u[14]=l=>g(ka).link=l),placeholder:"请输入链接"},null,8,["modelValue"])])),_:1}),y("div",ta,[v(d,{onClick:ma},{default:p((()=>[ia])),_:1}),v(d,{type:"primary",onClick:ha,disabled:!ga.value.id},{default:p((()=>[oa])),_:1},8,["disabled"])])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}))));var ua,da=W(ca,[["__scopeId","data-v-52c6ccf5"]]);export{da as default};
