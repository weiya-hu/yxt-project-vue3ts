var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,o=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&u(e,l,a[l]);if(r)for(var l of r(a))d.call(a,l)&&u(e,l,a[l]);return e},s=(e,r)=>a(e,l(r));import{G as i,g as n,o as c,H as _,I as m,a as v,_ as p,c as y,w as b,a0 as f,P as g,aa as w,$ as j,aw as k,ax as q,a1 as h,az as V,av as U,b as x,ae as O,a2 as P}from"./vue.73bee448.js";import{M as L}from"./MediaUpload.62b7fa6c.js";import{D as R}from"./DetailsHeader.37eece23.js";import{K as C}from"./KzAddArticle.ab2cff7d.js";import{e as D,a as E}from"./index.e78e20e4.js";import{f as G,g as F,h as I,i as K}from"./resource.98ce3433.js";import{m as M}from"./index.0985d3db.js";import{_ as S}from"./index.f52bce44.js";import"./login.a3820263.js";import"./request.136e293c.js";const z={class:"article_add"},A={class:"fsc"},H=(e=>(k("data-v-a3b1b35e"),e=e(),q(),e))((()=>m("div",{class:"form_title"},"内容设置",-1))),J={key:0,class:"fcs"},$={class:"fc"},N=h("免费下载"),B=h("弹窗二维码"),Q={style:{height:"100px"}},T={class:"btns fjend"},W=h("返回"),X=h("保存"),Y=h("发布");var Z=S(i({setup(e){const a=M(),l=V(),r=U(),t=l.query.id,d=n(!1);t?G({id:t}).then((e=>{ee.value={url:e.body.url,url_key:e.body.url_key,down_type:e.body.down_type,industry_id:e.body.industry_id,qr_code:e.body.qr_code},i.value.setForm({thumb_url:e.body.thumb_url,title:e.body.title,text:e.body.content,digest:e.body.digest}),d.value=!0})):d.value=!0;const u=n([]);(async()=>{const e=await F();u.value=e.body})();const i=n(),k=n(1),q=e=>{k.value=e,i.value.validate().then((e=>{Z.value.validate((a=>{e&&a&&(te.value=!0,de.value.imgs.length?de.value.submit():i.value.submit())}))}))},S=async e=>{d.value=!1;const l={content:e.text,digest:e.digest,down_type:ee.value.down_type,industry_id:ee.value.industry_id,qr_code:ee.value.qr_code,thumb_url:e.thumb_url,title:e.title,url:ee.value.url,url_key:ee.value.url_key},{status:u}=1==k.value?await I(s(o({},l),{id:t})):await K(s(o({},l),{id:t}));te.value=!1,d.value=!0,1==u&&(a.setKeepList([]),r.replace("/cms/resourceart"))},Z=n(),ee=n({url:"",url_key:"",down_type:1,industry_id:"",qr_code:""}),ae={url:[{required:!0,message:"请输入第三方URL链接",trigger:"blur"}],url_key:[{required:!0,message:"第三方URL秘钥：",trigger:"blur"}],qr_code:[{validator:(e,a,l)=>{2!=ee.value.down_type||a?l():l(new Error("请添加二维码"))},trigger:"blur"}]},le=e=>{1==e&&Z.value.clearValidate("qr_code")},re=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],te=n(!1),de=n(),ue=e=>{ee.value.qr_code=e,i.value.submit()},oe=e=>{D(e),te.value=!1},se=(e,a)=>{E(e,a)},ie=()=>{ee.value.qr_code=de.value.imgs[0].url,Z.value.validateField("qr_code",(()=>null))};return(e,a)=>{const l=x("el-input"),r=x("el-form-item"),t=x("el-radio"),o=x("el-radio-group"),s=x("el-form"),n=x("el-button"),k=x("el-card"),V=O("loading");return c(),_("div",z,[m("div",A,[v(R)]),v(C,{ref_key:"addRef",ref:i,needimg:"",needdigest:"",onSuccess:S},null,512),p((c(),y(k,{class:"mycard mt20"},{default:b((()=>[H,v(s,{ref_key:"aFormRef",ref:Z,model:ee.value,rules:ae,"hide-required-asterisk":""},{default:b((()=>[1==ee.value.down_type?(c(),_("div",J,[v(r,{label:"第三方URL链接：",prop:"url",class:"mr20"},{default:b((()=>[v(l,{modelValue:ee.value.url,"onUpdate:modelValue":a[0]||(a[0]=e=>ee.value.url=e),placeholder:"请输入第三方URL链接"},null,8,["modelValue"])])),_:1}),v(r,{label:"第三方URL秘钥：",prop:"url_key"},{default:b((()=>[v(l,{modelValue:ee.value.url_key,"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value.url_key=e),placeholder:"请输入第三方URL秘钥"},null,8,["modelValue"])])),_:1})])):f("",!0),v(r,{label:"行业分类：",prop:"industry_id"},{default:b((()=>[v(o,{modelValue:ee.value.industry_id,"onUpdate:modelValue":a[2]||(a[2]=e=>ee.value.industry_id=e)},{default:b((()=>[(c(!0),_(g,null,w(u.value,(e=>(c(),y(t,{key:e.id,label:e.id},{default:b((()=>[h(P(e.industry_name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(r,{label:"下载设置：",prop:"down_type",style:{"margin-bottom":"0"}},{default:b((()=>[m("div",$,[v(o,{modelValue:ee.value.down_type,"onUpdate:modelValue":a[3]||(a[3]=e=>ee.value.down_type=e),onChange:le},{default:b((()=>[v(t,{label:1},{default:b((()=>[N])),_:1}),v(t,{label:2},{default:b((()=>[B])),_:1})])),_:1},8,["modelValue"]),v(r,{prop:"qr_code"},{default:b((()=>[p(m("div",Q,[d.value?(c(),y(L,{key:0,ref_key:"upload",ref:de,max:1,"exname-list":re,"img-list":ee.value.qr_code?[ee.value.qr_code]:[],msg:"只能上传"+re.join("、")+"图片，不超过2M",onUpOneSuccess:ue,onError:oe,onLook:se,onDel:a[4]||(a[4]=e=>ee.value.qr_code=""),onChange:ie},null,8,["img-list","msg"])):f("",!0)],512),[[j,2==ee.value.down_type]])])),_:1})])])),_:1})])),_:1},8,["model"]),m("div",T,[v(n,{class:"bdc_btn",onClick:a[5]||(a[5]=a=>e.$router.push("/cms/resource"))},{default:b((()=>[W])),_:1}),v(n,{class:"bdc_btn",onClick:a[6]||(a[6]=e=>q(1))},{default:b((()=>[X])),_:1}),v(n,{type:"primary",disabled:!ee.value.industry_id,onClick:a[7]||(a[7]=e=>q(2))},{default:b((()=>[Y])),_:1},8,["disabled"])])])),_:1})),[[V,te.value]])])}}}),[["__scopeId","data-v-a3b1b35e"]]);export{Z as default};
