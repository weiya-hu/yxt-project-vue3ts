import{M as e}from"./Mypage.ea751ae3.js";import{M as a}from"./MyEmpty.e7bf4449.js";import{M as l}from"./MyDialog.bcd62144.js";import{M as s}from"./MediaUpload.87f756ad.js";import{h as o,e as u,a as t,k as d}from"./index.3ae96932.js";import{u as i,g as n,i as c,j as r}from"./system.012975a2.js";import{_ as m,z as v,i as f}from"./index.e7872df1.js";import{d as p}from"./download.7f700db9.js";import{e as _}from"./edit.1c957a6d.js";import{G as g,g as b,j as y,o as k,H as j,I as h,a as V,w as C,a2 as x,P as w,aa as M,c as U,_ as z,C as G,a0 as L,a1 as P,b as q,ae as E}from"./vue.73bee448.js";import"./empty.f131d8fb.js";import"./login.df5d82cd.js";import"./request.7878c8f3.js";import"./tinymce.5416ef76.js";const F={class:"imagepool_page"},I={class:"fsc topbox"},D={class:"fcs"},H=P("搜索"),J={class:"fcs"},N={class:"total mr20"},S=P("+ 上传"),O={key:0,class:"imgs_list flex"},R=["onClick"],T=["src","onLoad"],W={class:"lookicon fcc"},A={class:"imginfo"},B={class:"imgname els"},K={class:"imgsize"},Q={class:"fcs fjend imgicon"},X=["href"],Y={class:"fcs btns fjend mt20"},Z=P("取消"),$=P("提交"),ee={class:"fcs btns fjend mt20"},ae=P("取消"),le=P("提交");var se=m(g({setup(m){const g=[".jpg",".png",".jpeg",".JPG",".PNG",".JPEG"],P=b(!1),se=b(!1),oe=b(),ue=e=>{ce.source_name=e},te=async e=>{const a=await i({source_url:e,source_name:ce.source_name,source_type:1});a&&1==a.status?(ve(),ye(),o(1)):se.value=!1},de=e=>{u(e),se.value=!1},ie=(e,a)=>{t(e,a)},ne=b(),ce=y({source_name:""}),re=y({source_name:[{required:!0,message:"请输入图片名称！",trigger:"blur"}]}),me=()=>{ne.value.validateField("source_name",(e=>{e&&(se.value=!0,oe.value.submit(ce.source_name))}))},ve=()=>{se.value=!1,ne.value.resetFields(),P.value=!1},fe=b({}),pe=b([]),_e=b(0),ge=b(1),be=b(""),ye=async()=>{const{body:e,status:a}=await n({size:10,current:ge.value,sourceType:1,sourceName:be.value});1==a&&(pe.value=e.records,_e.value=e.total)};ye();const ke=()=>{ge.value=1,ye()},je=()=>{fe.value={},ye()},he=b(0),Ve=b(""),Ce=b(!1),xe=async()=>{const{status:e}=await c({id:he.value});1==e&&(pe.value.findIndex((e=>e.id==he.value)),Ce.value=!1,ye(),o(1))},we=b(!1),Me=async()=>{const{status:e}=await r({id:he.value,source_name:Ve.value});1==e&&(we.value=!1,ye(),o(1))},Ue=e=>{se.value?d().then((()=>{e()})).catch((()=>{})):e()};return(o,u)=>{const d=q("el-input"),i=q("el-button"),n=q("el-icon"),c=q("el-tooltip"),r=q("el-dialog"),m=q("el-form-item"),b=q("el-form"),y=E("loading");return k(),j("div",F,[h("div",I,[h("div",D,[V(d,{modelValue:be.value,"onUpdate:modelValue":u[0]||(u[0]=e=>be.value=e),placeholder:"输入图片名关键字搜索",clearable:""},null,8,["modelValue"]),V(i,{class:"ml20 bdc_btn",onClick:ke},{default:C((()=>[H])),_:1})]),h("div",J,[h("div",N,"共"+x(_e.value)+"条",1),V(i,{type:"primary",onClick:u[1]||(u[1]=e=>P.value=!0)},{default:C((()=>[S])),_:1})])]),_e.value?(k(),j("div",O,[(k(!0),j(w,null,M(pe.value,((e,a)=>(k(),j("div",{class:"imgs_item",key:e.id},[h("div",{class:"imgbox lookhover",onClick:e=>(e=>{const a=pe.value.map((e=>e.source_url));t(a,e)})(a)},[h("img",{src:e.source_url,alt:"",onLoad:a=>((e,a)=>{const l=a.path[0];fe.value[e]=l.naturalWidth+"*"+l.naturalHeight})(e.id,a)},null,40,T),h("div",W,[V(n,{size:"20px"},{default:C((()=>[V(G(v))])),_:1})])],8,R),h("div",A,[h("div",B,x(e.source_name),1),h("div",K,x(fe.value[e.id]),1),h("div",Q,[V(c,{effect:"dark",content:"下载",placement:"bottom"},{default:C((()=>[h("a",{href:e.source_url,class:"fcc download_a"},[V(n,{class:"chover",size:"18px"},{default:C((()=>[V(G(p))])),_:1})],8,X)])),_:2},1024),V(c,{effect:"dark",content:"修改名称",placement:"bottom"},{default:C((()=>[V(n,{class:"chover",size:"18px",onClick:a=>{return l=e,he.value=l.id,Ve.value=l.source_name,void(we.value=!0);var l}},{default:C((()=>[V(G(_))])),_:2},1032,["onClick"])])),_:2},1024),V(c,{effect:"dark",content:"删除",placement:"bottom"},{default:C((()=>[V(n,{class:"chover",size:"18px",onClick:a=>{return l=e,he.value=l.id,Ve.value=l.source_name,void(Ce.value=!0);var l}},{default:C((()=>[V(G(f))])),_:2},1032,["onClick"])])),_:2},1024)])])])))),128))])):(k(),U(a,{key:1})),V(e,{page:ge.value,"onUpdate:page":u[2]||(u[2]=e=>ge.value=e),total:_e.value,onChange:je,"hide-sizes":!0},null,8,["page","total"]),V(l,{modelValue:Ce.value,"onUpdate:modelValue":u[3]||(u[3]=e=>Ce.value=e),msg:"确认删除图片 “ "+Ve.value+" ” ?",onSure:xe},null,8,["modelValue","msg"]),V(r,{modelValue:we.value,"onUpdate:modelValue":u[6]||(u[6]=e=>we.value=e),title:"修改名称",width:"380px",onClose:u[7]||(u[7]=e=>Ve.value="")},{default:C((()=>[V(d,{modelValue:Ve.value,"onUpdate:modelValue":u[4]||(u[4]=e=>Ve.value=e),placeholder:"请输入图片名"},null,8,["modelValue"]),h("div",Y,[V(i,{onClick:u[5]||(u[5]=e=>we.value=!1)},{default:C((()=>[Z])),_:1}),V(i,{type:"primary",onClick:Me,disabled:!Ve.value},{default:C((()=>[$])),_:1},8,["disabled"])])])),_:1},8,["modelValue"]),V(r,{modelValue:P.value,"onUpdate:modelValue":u[10]||(u[10]=e=>P.value=e),title:"上传图片",width:"380px",onClose:ve,"before-close":Ue},{default:C((()=>[z((k(),U(b,{model:G(ce),rules:G(re),ref_key:"addFormRef",ref:ne},{default:C((()=>[V(m,{label:"图片",required:""},{default:C((()=>[P.value?(k(),U(s,{key:0,max:1,"need-download":"",onUpOneSuccess:te,onError:de,onLook:ie,onChange:ue,onDel:u[8]||(u[8]=e=>G(ce).source_name=""),exnameList:g,msg:"只能上传"+g.join("、")+"图片，不超过2M",ref_key:"upload",ref:oe},null,8,["msg"])):L("",!0)])),_:1}),V(m,{label:"名称",prop:"source_name"},{default:C((()=>[V(d,{modelValue:G(ce).source_name,"onUpdate:modelValue":u[9]||(u[9]=e=>G(ce).source_name=e),placeholder:"请输入图片名"},null,8,["modelValue"])])),_:1}),h("div",ee,[V(i,{onClick:ve},{default:C((()=>[ae])),_:1}),oe.value?(k(),U(i,{key:0,type:"primary",onClick:me,disabled:!oe.value.imgs.length},{default:C((()=>[le])),_:1},8,["disabled"])):L("",!0)])])),_:1},8,["model","rules"])),[[y,se.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6dedb28f"]]);export{se as default};
