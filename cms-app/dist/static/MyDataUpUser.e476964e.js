import{F as e}from"./date.23847c74.js";import{a as l,h as a,e as t}from"./index.cf7ad3b2.js";import{d as s,i as o,a9 as r,b as u,o as i,t as d,u as n,c as p,w as c,v as m,V as v,S as f,a as y,U as b,L as w,F as h,a2 as k,az as _,_ as x,a5 as V,Q as g,H as F}from"./vue.ca737a59.js";import{M as z}from"./MyUpload.5b84f67f.js";import{d as C}from"./custom.001ce688.js";const M={class:"flexl"},U={class:"flexl"},j={class:"text-tooltip-style"},N={class:"text-style"},L={class:"flexl"},S={key:0},B={class:"flexl"},E=["onClick"],q={class:"fcc msg"},I={class:"fcc"},A=b("我知道了");var D=l(s({props:{type:null,lable:null,prop:null,width:null,operatButton:null},emits:["click"],setup(l,{emit:a}){const t=l,s=o(!1),{type:_,lable:x,prop:V,width:g,operatButton:F}=r(t),z=e=>{const l=o();switch(e){case 2:l.value={text:"已授理",className:"calculating"};break;case 3:l.value={text:"驳回",className:"calculat-false"};break;case 4:l.value={text:"已完成",className:"calculated"};break;default:l.value={text:"待处理",className:"calcula_yellow"}}return l.value};return(l,t)=>{const o=u("el-table-column"),r=u("el-tooltip"),C=u("el-link"),D=u("el-button"),H=u("el-dialog");return i(),d(h,null,["text"===n(_)?(i(),p(o,{key:0,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e})=>[m("div",M,[m("div",null,v(n(V)&&e[n(V)]?e[n(V)]:"---"),1)])])),_:1},8,["property","label","min-width"])):f("",!0),"text-tooltip"===n(_)?(i(),p(o,{key:1,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e})=>[m("div",U,[y(r,{class:"box-item",effect:"dark",placement:"top-start"},{content:c((()=>[m("div",j,v(e[n(V)]||"---"),1)])),default:c((()=>[m("div",N,v(n(V)&&e[n(V)]?e[n(V)]:"---"),1)])),_:2},1024)])])),_:1},8,["property","label","min-width"])):f("",!0),"num"===n(_)?(i(),p(o,{key:2,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e,$index:l})=>[m("div",L,[e?(i(),d("div",S,v(l+1),1)):f("",!0)])])),_:1},8,["property","label","min-width"])):f("",!0),"link"===n(_)?(i(),p(o,{key:3,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e})=>[y(C,{type:"primary",href:e[n(V)]},{default:c((()=>[b(v(e[n(V)]),1)])),_:2},1032,["href"])])),_:1},8,["property","label","min-width"])):f("",!0),"select"===n(_)?(i(),p(o,{key:4,type:"selection",width:n(g),align:"center"},null,8,["width"])):f("",!0),"status"===n(_)?(i(),p(o,{key:5,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e})=>[m("div",B,[m("div",{class:w(z(e.status).className)},null,2),m("div",null,v(z(e.status).text),1)])])),_:1},8,["property","label","min-width"])):f("",!0),"date"===n(_)?(i(),p(o,{key:6,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:l})=>[m("div",null,v(n(e)("yyyy-MM-dd",new Date(l[n(V)]))),1)])),_:1},8,["property","label","min-width"])):f("",!0),"city"===n(_)?(i(),p(o,{key:7,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e})=>[m("div",null,v(e.province)+v(e.city)+v(e.district),1)])),_:1},8,["property","label","min-width"])):f("",!0),"operateLook"===n(_)?(i(),p(o,{key:8,property:n(V),label:n(x),"min-width":n(g)},{default:c((({row:e})=>[(i(!0),d(h,null,k(n(F),((l,t)=>(i(),d("div",{key:t,class:"operate-button",onClick:l=>((e,l)=>{2===l.status&&a("click",e,l),0===l.status&&(s.value=!0)})(t,e)},v(2===e.status?l:0===e.status?"失败原因":"---"),9,E)))),128)),y(H,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),title:"失败原因",width:"400px"},{footer:c((()=>[m("div",I,[y(D,{type:"primary",onClick:t[0]||(t[0]=e=>s.value=!1)},{default:c((()=>[A])),_:1})])])),default:c((()=>[m("div",q,v(e.fail_reason),1)])),_:2},1032,["modelValue"])])),_:1},8,["property","label","min-width"])):f("",!0)],64)}}}),[["__scopeId","data-v-24fd663a"]]);const H={class:"upload-users"},Q={class:"myform"},R={class:"fcs fjend"},$=b("取消"),G=b("提交");var J=l(s({props:{modelValue:{type:Boolean},type:null},emits:["update:modelValue","submitSuccess"],setup(e,{emit:l}){const s=e;_();const r=x({title:[{required:!0,message:"请输入需求标题",trigger:"blur"}],desc:[{required:!0,message:"请输入需求描述",trigger:"blur"}],updateFile:[{validator:(e,l,a)=>{switch(p.value){case"size":a(new Error("请添加大小不超过4M的文件"));break;case"type":a(new Error("请添加 .zip、.rar、.7z 格式的文件"));break;default:a()}},trigger:"change"}]});let p=o("none");const v=o(),f=o();let b=o({title:"",desc:"",updateFile:""}),w=o(!1);o("");const h=()=>{v.value.resetFields(),f.value.clear(),l("update:modelValue",!1)},k=e=>{w.value?a().then((()=>{})).catch((()=>{f.value.doAbort(),e()})):e()},M=()=>{v.value.validate((e=>{if(!e)return console.log("error submit!"),!1;console.log("submit!"),w.value=!0,b.value.updateFile?f.value.submit():N("")}))},U=e=>{e?(p.value=e,b.value.updateFile="",v.value.validateField("updateFile",(()=>null))):(p.value="",v.value.clearValidate("updateFile"))},j=e=>{console.log("uperr",e),b.value.updateFile="",p.value="none",f.value.clear(),w.value=!1,t("上传失败")},N=async e=>{const a=await C({attach_url:e,detail:b.value.desc,title:b.value.title},s.type);w.value=!1,1==a.status&&l("submitSuccess")};return(l,a)=>{const t=u("el-input"),s=u("el-form-item"),o=u("el-form"),p=u("el-button"),_=u("el-dialog"),x=V("loading");return i(),d("div",H,[y(_,{modelValue:e.modelValue,"onUpdate:modelValue":a[3]||(a[3]=e=>F(modelValue)?modelValue.value=e:null),width:500,onClose:h,title:"创建需求","before-close":k},{default:c((()=>[g((i(),d("div",Q,[y(o,{model:n(b),ref_key:"formRef",ref:v,rules:n(r),"label-width":"90px"},{default:c((()=>[y(s,{label:"需求标题",prop:"title"},{default:c((()=>[y(t,{placeholder:"请输入需求标题",modelValue:n(b).title,"onUpdate:modelValue":a[0]||(a[0]=e=>n(b).title=e)},null,8,["modelValue"])])),_:1}),y(s,{label:"需求描述",prop:"desc"},{default:c((()=>[y(t,{type:"textarea",maxlength:"150","show-word-limit":"",rows:"5",resize:"none",placeholder:"简要描述您的具体需求，以及期望目标。",modelValue:n(b).desc,"onUpdate:modelValue":a[1]||(a[1]=e=>n(b).desc=e)},null,8,["modelValue"])])),_:1}),y(s,{label:"文件上传",prop:"updateFile",style:{"margin-bottom":"20px"}},{default:c((()=>[y(z,{msg:"附件大小不超过4M<br/>支持.zip、.rar、.7z压缩包",modelValue:n(b).updateFile,"onUpdate:modelValue":a[2]||(a[2]=e=>n(b).updateFile=e),onChange:U,onError:j,onSuccess:N,exnameList:[".zip",".rar",".7z"],ref_key:"upload",ref:f,"max-size":4},null,8,["modelValue","exnameList"])])),_:1})])),_:1},8,["model","rules"]),m("div",R,[y(p,{onClick:h},{default:c((()=>[$])),_:1}),y(p,{type:"primary",onClick:M},{default:c((()=>[G])),_:1})])])),[[x,n(w)]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4d93f176"]]);export{J as M,D as a};
