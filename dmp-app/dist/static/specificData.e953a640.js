var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,u=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{F as s,f as d,r as i,a as n,G as c,H as p,I as v,X as m,Q as f,W as y,u as b,K as _,U as w,P as g,R as h,V,at as k,au as C,av as j,O as x,a6 as M}from"./vue.5acda677.js";import{M as U}from"./MyDialog.871f8285.js";import{_ as O}from"./MyPage.eca92ca4.js";import{M as P}from"./MyUpload.e86f2ac1.js";import{_ as D}from"./MyCascader.832dda6e.js";import{M as E}from"./MyEmpty.0b7254fc.js";import{_ as q,m as F,k as I,n as N,p as S,q as z,e as B,E as H,r as R}from"./index.9da98f44.js";import{f as T}from"./date.23847c74.js";const G=e=>(k("data-v-e9326df8"),e=e(),C(),e),K={class:"specific_data_page"},Q={class:"fsc topbtns"},W=V("新增需求"),X={class:"mytable"},A={class:"fcs"},J={key:0,class:"fcs"},L=V("删除"),Y={key:0,class:"line"},Z=V("下载附件"),$={key:1,class:"fcs"},ee=V("详情"),ae=G((()=>v("div",{class:"line"},null,-1))),le=V("删除"),te={key:2,class:"fcs"},re=V("删除"),oe=G((()=>v("div",{class:"line"},null,-1))),ue=V("拒绝原因"),se={class:"fcs btns fjend"},de=V("取消"),ie=V("提交"),ne={class:"fcc msg"},ce={class:"fcc"},pe=V("我知道了"),ve=s((me=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&u(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&u(e,l,a[l]);return e})({},{name:"个性化数据"}),a(me,l({setup(e){const a=F(),l=d((()=>a.state.typeHash)),t=d((()=>a.state.addressHash)),r=j(),o=i([]),u=i(1),s=i(0),V=()=>{S({current:u.value,size:10}).then((e=>{1==e.status&&(o.value=e.body.records,s.value=e.body.total)}))};V();const k=()=>{V()},C=i([]),q=e=>{C.value=e},G=e=>{const a=i({class:"",text:"-"});switch(Number(e)){case 0:a.value={class:"bgc_green",text:"审核中"};break;case 1:a.value={class:"bgc_df",text:"已通过"};break;case 2:a.value={class:"bgc_red",text:"已拒绝"}}return a.value},ve=i(!1),me=i(""),fe=i({type:[],addr:[],people:"",desc:"",file:""}),ye=i("none"),be=n({type:[{required:!0,message:"请选择行业",trigger:"change"}],addr:[{required:!0,message:"请选择地区",trigger:"change"}],people:[{required:!0,message:"请输入人群名称",trigger:"blur"}],desc:[{required:!0,message:"请输入人群描述",trigger:"blur"}],file:[{validator:(e,a,l)=>{switch(ye.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf 格式的文件"));break;default:l()}},trigger:"change"}]}),_e=i(!1),we=i(),ge=e=>{e?(ye.value=e,fe.value.file="",Ve.value.validateField("file",(()=>null))):(ye.value="",Ve.value.clearValidate("file"))},he=i(!1),Ve=i(),ke=e=>{z({attachment:e,province:Number(fe.value.addr[0])||"",city:Number(fe.value.addr[1])||"",district:Number(fe.value.addr[2])||"",group_desc:fe.value.desc,group_name:fe.value.people,industry_id:fe.value.type.join(",")}).then((e=>{1==e.status?(je(),V()):(fe.value.file="",ye.value="none",we.value.clear(),he.value=!1)})).catch((()=>{Ce("")}))},Ce=e=>{fe.value.file="",ye.value="none",we.value.clear(),he.value=!1,B("上传失败")},je=()=>{_e.value=!1,he.value=!1,ye.value="none",we.value.clear(),Ve.value.resetFields()},xe=e=>{he.value?H.confirm("正在上传中，关闭弹窗可能会导致上传失败，是否继续关闭？","温馨提示",{confirmButtonText:"取消",cancelButtonText:"确定",type:"warning"}).then((()=>{})).catch((()=>{e()})):e()},Me=i(""),Ue=i(!1),Oe=e=>{Me.value=e,Ue.value=!0},Pe=()=>{R({id:Me.value}).then((e=>{1==e.status&&(Ue.value=!1,V())}))};return(e,a)=>{const d=x("el-button"),i=x("el-table-column"),n=x("el-link"),V=x("el-table"),C=x("el-form-item"),j=x("el-input"),F=x("el-form"),S=x("el-dialog"),z=M("loading");return c(),p("div",K,[v("div",Q,[m(d,{type:"primary",onClick:a[0]||(a[0]=e=>_e.value=!0)},{default:f((()=>[W])),_:1})]),v("div",X,[m(V,{data:o.value,style:{width:"100%"},onSelectionChange:q},{empty:f((()=>[m(E)])),default:f((()=>[m(i,{type:"selection",width:"50"}),m(i,{property:"id",label:"ID",width:"165"}),m(i,{property:"type",label:"行业分类",width:"150"},{default:f((e=>[v("div",null,y(b(I)(e.row.industry_id.split(","),b(l),"last")),1)])),_:1}),m(i,{property:"addr",label:"地区",width:"180"},{default:f((e=>[v("div",null,y(b(I)(b(N)(e.row.province,e.row.city,e.row.district),b(t))),1)])),_:1}),m(i,{property:"group_name",label:"人群名称"}),m(i,{property:"group_desc",label:"人群描述"}),m(i,{property:"create_time",label:"发起时间",width:"155"},{default:f((e=>[v("div",null,y(b(T)(new Date(e.row.create_time),"yyyy-MM-dd")),1)])),_:1}),m(i,{property:"status",label:"状态",width:"100"},{default:f((e=>[v("div",A,[v("div",{class:_(["dot",G(e.row.status).class])},null,2),v("div",null,y(G(e.row.status).text),1)])])),_:1}),m(i,{label:"操作",width:"150"},{default:f((e=>[0===e.row.status?(c(),p("div",J,[m(n,{type:"primary",onClick:a=>Oe(e.row.id)},{default:f((()=>[L])),_:2},1032,["onClick"]),e.row.attachment?(c(),p("div",Y)):w("",!0),e.row.attachment?(c(),g(n,{key:1,type:"primary",href:e.row.attachment},{default:f((()=>[Z])),_:2},1032,["href"])):w("",!0)])):w("",!0),1===e.row.status?(c(),p("div",$,[m(n,{type:"primary",onClick:a=>{return l=e.row.id,void r.push("/findB/specificDataDetails?id="+l);var l}},{default:f((()=>[ee])),_:2},1032,["onClick"]),ae,m(n,{type:"primary",onClick:a=>Oe(e.row.id)},{default:f((()=>[le])),_:2},1032,["onClick"])])):w("",!0),2===e.row.status?(c(),p("div",te,[m(n,{type:"primary",onClick:a=>Oe(e.row.id)},{default:f((()=>[re])),_:2},1032,["onClick"]),oe,m(n,{type:"primary",onClick:a=>{me.value=e.row.fail_reason,ve.value=!0}},{default:f((()=>[ue])),_:2},1032,["onClick"])])):w("",!0)])),_:1})])),_:1},8,["data"])]),m(O,{total:s.value,modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=e=>u.value=e),onChange:k},null,8,["total","modelValue"]),m(S,{modelValue:_e.value,"onUpdate:modelValue":a[8]||(a[8]=e=>_e.value=e),title:"新建数据",width:"500px",onClose:je,"before-close":xe},{default:f((()=>[h((c(),g(F,{class:"myform",ref_key:"addFormRef",ref:Ve,model:fe.value,rules:b(be)},{default:f((()=>[m(C,{label:"行业分类",prop:"type"},{default:f((()=>[m(D,{modelValue:fe.value.type,"onUpdate:modelValue":a[2]||(a[2]=e=>fe.value.type=e),type:"type"},null,8,["modelValue"])])),_:1}),m(C,{label:"选择地区",prop:"addr"},{default:f((()=>[m(D,{modelValue:fe.value.addr,"onUpdate:modelValue":a[3]||(a[3]=e=>fe.value.addr=e),type:"address"},null,8,["modelValue"])])),_:1}),m(C,{label:"人群名称",prop:"people"},{default:f((()=>[m(j,{modelValue:fe.value.people,"onUpdate:modelValue":a[4]||(a[4]=e=>fe.value.people=e),placeholder:"请输入人群名称"},null,8,["modelValue"])])),_:1}),m(C,{label:"人群描述",prop:"desc"},{default:f((()=>[m(j,{modelValue:fe.value.desc,"onUpdate:modelValue":a[5]||(a[5]=e=>fe.value.desc=e),placeholder:"可对人群进行简单的描述",type:"textarea",maxlength:"150","show-word-limit":"",rows:"4",resize:"none"},null,8,["modelValue"])])),_:1}),m(C,{label:"上传附件",prop:"file"},{default:f((()=>[m(P,{modelValue:fe.value.file,"onUpdate:modelValue":a[6]||(a[6]=e=>fe.value.file=e),onChange:ge,onError:Ce,onSuccess:ke,ref_key:"upload",ref:we},null,8,["modelValue"])])),_:1}),v("div",se,[m(d,{onClick:je},{default:f((()=>[de])),_:1}),m(d,{type:"primary",onClick:a[7]||(a[7]=e=>{var a;(a=Ve.value)&&(ye.value="none",a.validate((e=>{if(!e)return!1;he.value=!0,fe.value.file?we.value.submit():ke("")})))})},{default:f((()=>[ie])),_:1})])])),_:1},8,["model","rules"])),[[z,he.value]])])),_:1},8,["modelValue"]),m(S,{modelValue:ve.value,"onUpdate:modelValue":a[10]||(a[10]=e=>ve.value=e),title:"拒绝原因",width:"400px"},{footer:f((()=>[v("div",ce,[m(d,{type:"primary",onClick:a[9]||(a[9]=e=>ve.value=!1)},{default:f((()=>[pe])),_:1})])])),default:f((()=>[v("div",ne,y(me.value),1)])),_:1},8,["modelValue"]),m(U,{modelValue:Ue.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Ue.value=e),msg:"确认删除这条数据吗?",onSure:Pe},null,8,["modelValue"])])}}}))));var me,fe=q(ve,[["__scopeId","data-v-e9326df8"]]);export{fe as default};
