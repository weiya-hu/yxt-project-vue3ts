import{M as e}from"./MyDataTable.dc4a1a27.js";import{_ as a}from"./MyPage.eca92ca4.js";import{_ as l}from"./MyCascader.abe87dee.js";import{F as t,r,a as u,G as o,H as d,I as s,X as i,Q as p,i as n,R as c,u as m,P as y,Y as v,a7 as f,U as g,V as b,av as _,O as h,a6 as w}from"./vue.5acda677.js";import{c as k,a as V,b as x}from"./seekPathPro.a1927ad7.js";import{M as C}from"./MyEmpty.4148043d.js";import{M as F}from"./MyUpload.d5e047eb.js";import{_ as j,E as q,e as M}from"./index.87c65385.js";import"./date.23847c74.js";const T={class:"up2b"},U={class:"top-button fsc"},P=b("添加需求"),z={class:"flexr"},E=b("同步SCRM"),D=b("同步CMS"),S=b("同步DSP系统"),B={class:"mytable"},I={class:"operate-button-pre"},R=["onClick"],G=["onClick"],H=["onClick"],O={key:3},Q={class:"flexr"},X=b("取消"),Y=b("确认");var A=j(t({setup(t){let b=r(0),j=r(1),A=_(),J=r(!1),K=r(!1),L=r(!1);const N=r(),W=r();let Z=r({industryType:[],country:[],name:"",desc:"",updateFile:""}),$=r(),ee=r([]),ae=r([{type:"select",prop:"select",width:100},{type:"text",lable:"ID",prop:"id",width:100},{type:"industry_id",lable:"行业分类",prop:"industry_id",width:120},{type:"city_id",lable:"地区",prop:"city",width:150},{type:"text",lable:"项目名称",prop:"group_name",width:150},{type:"text-tooltip",lable:"项目描述",prop:"group_desc",width:220},{type:"date",lable:"创建日期",prop:"create_time",width:110},{type:"status_do",lable:"状态",prop:"status",width:100}]);const le=u({industryType:[{required:!0,message:"请选择行业分类",trigger:"blur"}],country:[{required:!0,message:"请选择地区",trigger:"blur"}],name:[{required:!0,message:"请输入项目名称",trigger:"change"},{required:!0,message:"请输入项目名称",trigger:"blur"}],desc:[{required:!0,message:"请输入项目描述",trigger:"change"},{required:!0,message:"请输入项目描述",trigger:"blur"}],updateFile:[{validator:(e,a,l)=>{switch($.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf、.xls、.xlsx 格式的文件"));break;case"none":l(new Error("请添加文件"));break;default:l()}},trigger:"change"}]}),te=async()=>{J.value=!0;let e={current:j.value,type:2,size:10};const{status:a,body:l}=await k(e);J.value=!1,a&&(b.value=l.total,ee.value=l.records)};te();const re=()=>{N.value.validate((e=>{if(!e)return!1;K.value=!0,Z.value.updateFile?W.value.submit():de()}))},ue=e=>{e?($.value=e,Z.value.updateFile="",N.value.validateField("updateFile",(()=>null))):($.value="",N.value.clearValidate("updateFile"))},oe=e=>{Z.value.updateFile="",$.value="none",W.value.clear(),K.value=!1,M("上传失败")},de=e=>{x({attachment:e||"",group_desc:Z.value.desc,group_name:Z.value.name,type:2,province:Z.value.country[0],city:Z.value.country[1],district:Z.value.country[2],industry_id:Z.value.industryType.join(",")}).then((e=>{e.status?(L.value=!1,N.value.resetFields(),j.value=1,te()):(Z.value.updateFile="",W.value.clear()),K.value=!1})).catch((()=>{K.value=!1,oe()}))};return(t,r)=>{const u=h("el-button"),_=h("el-table-column"),k=h("el-table"),x=h("el-form-item"),M=h("el-input"),$=h("el-form"),se=h("el-dialog"),ie=w("loading");return o(),d("div",T,[s("div",U,[i(u,{size:"large",type:"primary",class:"up-user fcc",onClick:r[0]||(r[0]=e=>n(L)?L.value=!0:L=!0)},{default:p((()=>[P])),_:1}),s("div",z,[i(u,{size:"large"},{default:p((()=>[E])),_:1}),i(u,{size:"large"},{default:p((()=>[D])),_:1}),i(u,{size:"large"},{default:p((()=>[S])),_:1})])]),s("div",B,[c((o(),y(k,{data:m(ee),size:"large","row-class-name":"my-data-table-row"},{empty:p((()=>[i(C)])),default:p((()=>[(o(!0),d(v,null,f(m(ae),((a,l)=>(o(),y(e,{key:l,type:a.type,width:a.width,lable:a.lable,prop:a.prop},null,8,["type","width","lable","prop"])))),128)),i(_,{fixed:"right",property:"operate",label:"操作","min-width":"100"},{default:p((({row:e})=>[s("div",I,[3===e.status?(o(),d("div",{key:0,class:"operate-button marginr",onClick:a=>(e=>{A.push({path:"/seekPathPro/seekProjectDetail",query:{id:e.id}})})(e)},"查看",8,R)):g("",!0),1!==e.status?(o(),d("div",{key:1,class:"operate-button marginr",onClick:a=>(e=>{q.confirm("是否确认删除?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{let a={id:e.id};const{status:l}=await V(a);l&&te()}))})(e)},"删除",8,G)):g("",!0),2===e.status?(o(),d("div",{key:2,class:"operate-button",onClick:a=>(e=>{q.alert(e.fail_reason||"暂没有驳回原因，请联系管理员","驳回原因",{confirmButtonText:"确认"})})(e)},"驳回原因",8,H)):g("",!0),1===e.status?(o(),d("div",O,"---")):g("",!0)])])),_:1})])),_:1},8,["data"])),[[ie,m(J)]])]),s("div",null,[m(b)?(o(),y(a,{key:0,total:m(b),modelValue:m(j),"onUpdate:modelValue":r[1]||(r[1]=e=>n(j)?j.value=e:j=e),onChange:te},null,8,["total","modelValue"])):g("",!0)]),i(se,{modelValue:m(L),"onUpdate:modelValue":r[8]||(r[8]=e=>n(L)?L.value=e:L=e),width:500,draggable:"",title:"添加需求","close-on-click-modal":!1},{footer:p((()=>[s("div",Q,[i(u,{type:"primary",onClick:r[7]||(r[7]=e=>n(L)?L.value=!1:L=!1)},{default:p((()=>[X])),_:1}),i(u,{type:"primary",onClick:re},{default:p((()=>[Y])),_:1})])])),default:p((()=>[s("div",null,[c((o(),y($,{model:m(Z),ref_key:"formRef",ref:N,rules:m(le)},{default:p((()=>[i(x,{label:"行业分类",required:"",prop:"industryType"},{default:p((()=>[i(l,{type:"type",modelValue:m(Z).industryType,"onUpdate:modelValue":r[2]||(r[2]=e=>m(Z).industryType=e)},null,8,["modelValue"])])),_:1}),i(x,{label:"地区",required:"",prop:"country"},{default:p((()=>[i(l,{type:"country",modelValue:m(Z).country,"onUpdate:modelValue":r[3]||(r[3]=e=>m(Z).country=e)},null,8,["modelValue"])])),_:1}),i(x,{label:"项目名称",required:"",prop:"name"},{default:p((()=>[i(M,{placeholder:"请输入项目名称",modelValue:m(Z).name,"onUpdate:modelValue":r[4]||(r[4]=e=>m(Z).name=e),clearable:""},null,8,["modelValue"])])),_:1}),i(x,{label:"项目描述",required:"",prop:"desc"},{default:p((()=>[i(M,{type:"textarea",maxlength:"150","show-word-limit":"",class:"input-textarea",placeholder:"请对寻找的项目进行简要的描述（比如招投标项目、商机项目、合作项目等）",modelValue:m(Z).desc,"onUpdate:modelValue":r[5]||(r[5]=e=>m(Z).desc=e)},null,8,["modelValue"])])),_:1}),i(x,{label:"上传附件",prop:"updateFile"},{default:p((()=>[i(F,{modelValue:m(Z).updateFile,"onUpdate:modelValue":r[6]||(r[6]=e=>m(Z).updateFile=e),onChange:ue,onError:oe,onSuccess:de,ref_key:"upload",ref:W},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[ie,m(K)]])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-30009410"]]);export{A as default};
