import{M as e}from"./MyDataTable.d2367b06.js";import{a,M as l}from"./MyEmpty.344736a1.js";import{_ as t}from"./MyCascader.b3f5809b.js";import{F as r,r as u,a as o,G as d,H as s,X as i,i as p,I as n,R as c,u as m,P as y,Q as v,Y as b,a7 as f,U as g,V as h,av as _,O as w,a6 as k}from"./vue.5acda677.js";import{c as V,a as x,b as F}from"./seekPathPro.928318ed.js";import{M as T}from"./MyUpload.48150651.js";import{T as j}from"./TopBtns.5574f9a3.js";import{_ as q,E as C,e as U}from"./index.7c1d8caa.js";import"./date.23847c74.js";const M={class:"up2b"},E={class:"mytable"},P={class:"operate-button-pre"},B=["onClick"],z=["onClick"],D=["onClick"],I={key:3},R={class:"flexr"},A=h("取消"),G=h("确认");var H=q(r({setup(r){let h=u(0),q=u(1),H=_(),O=u(!1),Q=u(!1),S=u(!1);const X=u(),Y=u();let J=u({industryType:[],country:[],name:"",desc:"",updateFile:""}),K=u(),L=u([]),N=u([{type:"select",prop:"select",width:100},{type:"text",lable:"ID",prop:"id",width:100},{type:"industry_id",lable:"行业分类",prop:"industry_id",width:120},{type:"city_id",lable:"地区",prop:"city",width:150},{type:"text",lable:"项目名称",prop:"group_name",width:150},{type:"text-tooltip",lable:"项目描述",prop:"group_desc",width:220},{type:"date",lable:"创建日期",prop:"create_time",width:110},{type:"status_do",lable:"状态",prop:"status",width:100}]);const W=o({industryType:[{required:!0,message:"请选择行业分类",trigger:"blur"}],country:[{required:!0,message:"请选择地区",trigger:"blur"}],name:[{required:!0,message:"请输入项目名称",trigger:"change"},{required:!0,message:"请输入项目名称",trigger:"blur"}],desc:[{required:!0,message:"请输入项目描述",trigger:"change"},{required:!0,message:"请输入项目描述",trigger:"blur"}],updateFile:[{validator:(e,a,l)=>{switch(K.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf、.xls、.xlsx 格式的文件"));break;case"none":l(new Error("请添加文件"));break;default:l()}},trigger:"change"}]}),Z=async()=>{O.value=!0;let e={current:q.value,type:2,size:10};const{status:a,body:l}=await V(e);O.value=!1,a&&(h.value=l.total,L.value=l.records)};Z();const $=()=>{X.value.validate((e=>{if(!e)return!1;Q.value=!0,J.value.updateFile?Y.value.submit():le()}))},ee=e=>{e?(K.value=e,J.value.updateFile="",X.value.validateField("updateFile",(()=>null))):(K.value="",X.value.clearValidate("updateFile"))},ae=e=>{J.value.updateFile="",K.value="none",Y.value.clear(),Q.value=!1,U("上传失败")},le=e=>{F({attachment:e||"",group_desc:J.value.desc,group_name:J.value.name,type:2,province:J.value.country[0],city:J.value.country[1],district:J.value.country[2],industry_id:J.value.industryType.join(",")}).then((e=>{e.status?(S.value=!1,X.value.resetFields(),q.value=1,Z()):(J.value.updateFile="",Y.value.clear()),Q.value=!1})).catch((()=>{Q.value=!1,ae()}))};return(r,u)=>{const o=w("el-table-column"),_=w("el-table"),V=w("el-form-item"),F=w("el-input"),U=w("el-form"),K=w("el-button"),te=w("el-dialog"),re=k("loading");return d(),s("div",M,[i(j,{onAdd:u[0]||(u[0]=e=>p(S)?S.value=!0:S=!0)}),n("div",E,[c((d(),y(_,{data:m(L),size:"large","row-class-name":"my-data-table-row"},{empty:v((()=>[i(a)])),default:v((()=>[(d(!0),s(b,null,f(m(N),((a,l)=>(d(),y(e,{key:l,type:a.type,width:a.width,lable:a.lable,prop:a.prop},null,8,["type","width","lable","prop"])))),128)),i(o,{fixed:"right",property:"operate",label:"操作","min-width":"100"},{default:v((({row:e})=>[n("div",P,[4===e.status?(d(),s("div",{key:0,class:"operate-button marginr",onClick:a=>(e=>{H.push({path:"/seekPathPro/seekProjectDetail",query:{id:e.id}})})(e)},"查看",8,B)):g("",!0),2!==e.status?(d(),s("div",{key:1,class:"operate-button marginr",onClick:a=>(e=>{C.confirm("是否确认删除?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{let a={id:e.id};const{status:l}=await x(a);l&&Z()}))})(e)},"删除",8,z)):g("",!0),3===e.status?(d(),s("div",{key:2,class:"operate-button",onClick:a=>(e=>{C.alert(e.fail_reason||"暂没有驳回原因，请联系管理员","驳回原因",{confirmButtonText:"确认"})})(e)},"驳回原因",8,D)):g("",!0),2===e.status?(d(),s("div",I,"---")):g("",!0)])])),_:1})])),_:1},8,["data"])),[[re,m(O)]])]),n("div",null,[m(h)?(d(),y(l,{key:0,total:m(h),modelValue:m(q),"onUpdate:modelValue":u[1]||(u[1]=e=>p(q)?q.value=e:q=e),onChange:Z},null,8,["total","modelValue"])):g("",!0)]),i(te,{modelValue:m(S),"onUpdate:modelValue":u[8]||(u[8]=e=>p(S)?S.value=e:S=e),width:500,draggable:"",title:"添加需求","close-on-click-modal":!1},{footer:v((()=>[n("div",R,[i(K,{onClick:u[7]||(u[7]=e=>p(S)?S.value=!1:S=!1)},{default:v((()=>[A])),_:1}),i(K,{type:"primary",onClick:$},{default:v((()=>[G])),_:1})])])),default:v((()=>[n("div",null,[c((d(),y(U,{model:m(J),ref_key:"formRef",ref:X,rules:m(W)},{default:v((()=>[i(V,{label:"行业分类",required:"",prop:"industryType"},{default:v((()=>[i(t,{type:"type",modelValue:m(J).industryType,"onUpdate:modelValue":u[2]||(u[2]=e=>m(J).industryType=e)},null,8,["modelValue"])])),_:1}),i(V,{label:"地区",required:"",prop:"country"},{default:v((()=>[i(t,{type:"country",modelValue:m(J).country,"onUpdate:modelValue":u[3]||(u[3]=e=>m(J).country=e)},null,8,["modelValue"])])),_:1}),i(V,{label:"项目名称",required:"",prop:"name"},{default:v((()=>[i(F,{placeholder:"请输入项目名称",modelValue:m(J).name,"onUpdate:modelValue":u[4]||(u[4]=e=>m(J).name=e),clearable:""},null,8,["modelValue"])])),_:1}),i(V,{label:"项目描述",required:"",prop:"desc"},{default:v((()=>[i(F,{type:"textarea",maxlength:"150","show-word-limit":"",class:"input-textarea",placeholder:"请对寻找的项目进行简要的描述（比如招投标项目、商机项目、合作项目等）",modelValue:m(J).desc,"onUpdate:modelValue":u[5]||(u[5]=e=>m(J).desc=e)},null,8,["modelValue"])])),_:1}),i(V,{label:"上传附件",prop:"updateFile"},{default:v((()=>[i(T,{modelValue:m(J).updateFile,"onUpdate:modelValue":u[6]||(u[6]=e=>m(J).updateFile=e),onChange:ee,onError:ae,onSuccess:le,ref_key:"upload",ref:Y},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[re,m(Q)]])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4f70682c"]]);export{H as default};
