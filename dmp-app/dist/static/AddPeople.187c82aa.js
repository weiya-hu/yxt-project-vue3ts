var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{M as d}from"./MyEmpty.4148043d.js";import{f as u}from"./date.23847c74.js";import{M as i}from"./MyDialog.541194ae.js";import{F as c,f as n,r as p,av as m,O as v,G as f,H as y,X as b,Q as w,I as _,K as h,W as g,u as V,U as k,P as x,V as C,at as j,au as M,a as O,a6 as U,R as E,i as P}from"./vue.5acda677.js";import{_ as F,m as I,j as S,k as D,n as q,e as B,E as z}from"./index.87c65385.js";import{_ as A}from"./MyCascader.abe87dee.js";import{M as H}from"./MyUpload.d5e047eb.js";const N=e=>(j("data-v-1a3f2928"),e=e(),M(),e),R={class:"mytable people_table"},T={class:"fcs"},G={key:0,class:"fcs"},K=C("删除"),Q={key:0,class:"line"},W=C("下载附件"),X={key:1,class:"fcs"},J=C("查看"),L=N((()=>_("div",{class:"line"},null,-1))),Y=C("下载方案"),Z={key:2,class:"fcs"},$=C("查看"),ee=N((()=>_("div",{class:"line"},null,-1))),ae=C("下载方案"),le={key:3,class:"fcs"},te=C("删除"),re=N((()=>_("div",{class:"line"},null,-1))),oe=C("拒绝原因"),se={class:"fcc msg"},de={class:"fcc"},ue=C("我知道了");var ie=F(c({props:{data:Array,details:String},emits:["select","del"],setup(e,{emit:a}){const l=e,t=I(),r=n((()=>t.state.addressHash)),o=e=>{a("select",e)},s=p(!1),c=p(""),C=p(""),j=p(!1),M=e=>{C.value=e,j.value=!0},O=()=>{a("del",C.value),j.value=!1},U=m(),E=e=>{U.push(l.details+"?id="+e)},P=e=>{const a=p({class:"",text:"-"});switch(Number(e)){case 0:a.value={class:"bgc_green",text:"审核中"};break;case 1:a.value={class:"bgc_df",text:"已通过"};break;case 2:a.value={class:"bgc_999",text:"已完成"};break;case 3:a.value={class:"bgc_red",text:"已拒绝"}}return a.value};return(a,l)=>{const t=v("el-table-column"),n=v("el-link"),p=v("el-table"),m=v("el-button"),C=v("el-dialog");return f(),y("div",R,[b(p,{data:e.data,style:{width:"100%"},onSelectionChange:o},{empty:w((()=>[b(d)])),default:w((()=>[b(t,{type:"selection",width:"50"}),b(t,{property:"id",label:"ID",width:"150"}),b(t,{property:"group_name",label:"人群名称",width:"150"}),b(t,{property:"group_desc",label:"人群描述"}),b(t,{property:"status",label:"状态",width:"130"},{default:w((e=>[_("div",T,[_("div",{class:h(["dot",P(e.row.status).class])},null,2),_("div",null,g(P(e.row.status).text),1)])])),_:1}),b(t,{property:"address",label:"地区"},{default:w((e=>[_("div",null,g(V(S)(V(D)(e.row.province,e.row.city,e.row.district),V(r))),1)])),_:1}),b(t,{property:"count",label:"覆盖用户人数",width:"140"},{default:w((e=>[_("div",null,g(1==e.row.status?e.row.count:"---"),1)])),_:1}),b(t,{property:"money",label:"消耗金额 (元)",width:"130"},{default:w((e=>[_("div",null,g(Number(e.row.money).toFixed(2)),1)])),_:1}),b(t,{property:"create_time",label:"创建日期",width:"130"},{default:w((e=>[_("div",null,g(V(u)(new Date(e.row.create_time),"yyyy-MM-dd")),1)])),_:1}),b(t,{property:"source",label:"来源",width:"130"},{default:w((e=>[_("div",null,g(V(q)(e.row.source)),1)])),_:1}),b(t,{property:"source",label:"操作",width:"150"},{default:w((e=>[0===e.row.status?(f(),y("div",G,[b(n,{type:"primary",onClick:a=>M(e.row.id)},{default:w((()=>[K])),_:2},1032,["onClick"]),e.row.attachment?(f(),y("div",Q)):k("",!0),e.row.attachment?(f(),x(n,{key:1,type:"primary",href:e.row.attachment},{default:w((()=>[W])),_:2},1032,["href"])):k("",!0)])):k("",!0),1===e.row.status?(f(),y("div",X,[b(n,{type:"primary",onClick:a=>E(e.row.id)},{default:w((()=>[J])),_:2},1032,["onClick"]),L,b(n,{type:"primary",href:e.row.plan_url},{default:w((()=>[Y])),_:2},1032,["href"])])):k("",!0),2===e.row.status?(f(),y("div",Z,[b(n,{type:"primary",onClick:a=>E(e.row.id)},{default:w((()=>[$])),_:2},1032,["onClick"]),ee,b(n,{type:"primary",href:e.row.plan_url},{default:w((()=>[ae])),_:2},1032,["href"])])):k("",!0),3===e.row.status?(f(),y("div",le,[b(n,{type:"primary",onClick:a=>M(e.row.id)},{default:w((()=>[te])),_:2},1032,["onClick"]),re,b(n,{type:"primary",onClick:a=>{c.value=e.row.fail_reason,s.value=!0}},{default:w((()=>[oe])),_:2},1032,["onClick"])])):k("",!0)])),_:1})])),_:1},8,["data"]),b(C,{modelValue:s.value,"onUpdate:modelValue":l[1]||(l[1]=e=>s.value=e),title:"拒绝原因",width:"400px"},{footer:w((()=>[_("div",de,[b(m,{type:"primary",onClick:l[0]||(l[0]=e=>s.value=!1)},{default:w((()=>[ue])),_:1})])])),default:w((()=>[_("div",se,g(c.value),1)])),_:1},8,["modelValue"]),b(i,{modelValue:j.value,"onUpdate:modelValue":l[2]||(l[2]=e=>j.value=e),msg:"确认删除这条数据吗?",onSure:O},null,8,["modelValue"])])}}}),[["__scopeId","data-v-1a3f2928"]]);const ce={class:"add_people"},ne={class:"fcs fjend"},pe=C("取消"),me=C("提交");var ve=F(c({props:{modelValue:Boolean},emits:["update:modelValue","success"],setup(e,{expose:d,emit:u}){const i=p({people:"",desc:"",addr:[],file:""}),c=p("none"),n=O({people:[{required:!0,message:"请输入人群名称",trigger:"blur"}],desc:[{required:!0,message:"请输入人群描述",trigger:"blur"}],addr:[{required:!0,message:"请选择地区",trigger:"change"}],file:[{validator:(e,a,l)=>{switch(c.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf 格式的文件"));break;default:l()}},trigger:"change"}]}),m=p(),h=p(),g=p(!1),k=e=>{e?(c.value=e,i.value.file="",m.value.validateField("file",(()=>null))):(c.value="",m.value.clearValidate("file"))},C=e=>{var d;u("success",(d=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&s(e,l,a[l]);return e})({},i.value),a(d,l({path:e}))))},j=()=>{c.value="none",m.value.validate((e=>{if(!e)return!1;g.value=!0,i.value.file?h.value.submit():C("")}))},M=e=>{i.value.file="",c.value="none",h.value.clear(),g.value=!1,B("上传失败")},F=e=>{g.value?z.confirm("正在上传中，关闭弹窗可能会导致上传失败，是否继续关闭？","温馨提示",{confirmButtonText:"取消",cancelButtonText:"确定",type:"warning"}).then((()=>{})).catch((()=>{e()})):e()},I=()=>{g.value=!1,c.value="none",h.value.clear(),m.value.resetFields(),u("update:modelValue",!1)};return d({addError:()=>{g.value=!1}}),(a,l)=>{const t=v("el-input"),r=v("el-form-item"),o=v("el-button"),s=v("el-form"),d=v("el-dialog"),u=U("loading");return f(),y("div",ce,[b(d,{modelValue:e.modelValue,"onUpdate:modelValue":l[4]||(l[4]=e=>P(modelValue)?modelValue.value=e:null),title:"新建数据",width:"500px",onClose:I,"before-close":F},{default:w((()=>[E((f(),x(s,{class:"myform",ref_key:"addFormRef",ref:m,model:i.value,rules:V(n)},{default:w((()=>[b(r,{label:"人群名称",prop:"people"},{default:w((()=>[b(t,{modelValue:i.value.people,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value.people=e),placeholder:"请输入人群名称"},null,8,["modelValue"])])),_:1}),b(r,{label:"选择地区",prop:"addr"},{default:w((()=>[b(A,{modelValue:i.value.addr,"onUpdate:modelValue":l[1]||(l[1]=e=>i.value.addr=e),type:"address"},null,8,["modelValue"])])),_:1}),b(r,{label:"人群描述",prop:"desc"},{default:w((()=>[b(t,{modelValue:i.value.desc,"onUpdate:modelValue":l[2]||(l[2]=e=>i.value.desc=e),placeholder:"可对人群进行简单的描述",type:"textarea",maxlength:"150","show-word-limit":"",rows:"4",resize:"none"},null,8,["modelValue"])])),_:1}),b(r,{label:"上传附件",prop:"file"},{default:w((()=>[b(H,{modelValue:i.value.file,"onUpdate:modelValue":l[3]||(l[3]=e=>i.value.file=e),onChange:k,onError:M,onSuccess:C,ref_key:"upload",ref:h},null,8,["modelValue"])])),_:1}),_("div",ne,[b(o,{onClick:I},{default:w((()=>[pe])),_:1}),b(o,{type:"primary",onClick:j},{default:w((()=>[me])),_:1})])])),_:1},8,["model","rules"])),[[u,g.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d8de9be4"]]);export{ve as A,ie as P};
