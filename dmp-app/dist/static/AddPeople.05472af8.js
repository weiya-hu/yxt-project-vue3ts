var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,d=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{a as s}from"./MyEmpty.35d3267a.js";import{f as u}from"./date.23847c74.js";import{M as i}from"./MyDialog.6575be0c.js";import{F as c,f as n,r as p,av as m,O as v,G as f,H as y,X as w,Q as b,I as _,K as h,u as g,W as V,P as k,U as C,V as j,at as x,au as O,a as M,a6 as U,R as E,i as P}from"./vue.5acda677.js";import{_ as F,m as I,r as S,n as D,o as q,p as B,e as z,E as A}from"./index.39a5ef0e.js";import{_ as H}from"./MyCascader.1bbcf912.js";import{M as N}from"./MyUpload.c7ac49cd.js";const R=e=>(x("data-v-1154fc6d"),e=e(),O(),e),T={class:"mytable people_table"},G={class:"fcs"},K={key:0,class:"fcs"},Q=j("下载附件"),W={key:1,class:"line"},X=j("删除"),J={key:1,class:"fcs"},L={key:2,class:"fcs"},Y=j("拒绝原因"),Z=R((()=>_("div",{class:"line"},null,-1))),$=j("删除"),ee={key:3,class:"fcs"},ae=j("查看"),le=R((()=>_("div",{class:"line"},null,-1))),te=j("删除"),re={class:"fcc msg"},oe={class:"fcc"},de=j("我知道了");var se=F(c({props:{data:Array,details:String},emits:["select","del"],setup(e,{emit:a}){const l=e,t=I(),r=n((()=>t.state.addressHash)),o=e=>{a("select",e)},d=p(!1),c=p(""),j=p(""),x=p(!1),O=e=>{j.value=e,x.value=!0},M=()=>{a("del",j.value),x.value=!1},U=m();return(a,t)=>{const n=v("el-table-column"),p=v("el-link"),m=v("el-table"),j=v("el-button"),E=v("el-dialog");return f(),y("div",T,[w(m,{data:e.data,style:{width:"100%"},onSelectionChange:o},{empty:b((()=>[w(s)])),default:b((()=>[w(n,{type:"selection",width:"50"}),w(n,{property:"id",label:"ID",width:"150"}),w(n,{property:"group_name",label:"人群名称",width:"150"}),w(n,{property:"group_desc",label:"人群描述"}),w(n,{property:"status",label:"状态",width:"130"},{default:b((e=>[_("div",G,[_("div",{class:h(["status_dot",g(S)(e.row.status).className])},null,2),_("div",null,V(g(S)(e.row.status).text),1)])])),_:1}),w(n,{property:"address",label:"地区"},{default:b((e=>[_("div",null,V(g(D)(g(q)(e.row.province,e.row.city,e.row.district),g(r))),1)])),_:1}),w(n,{property:"count",label:"覆盖用户人数",width:"140"},{default:b((e=>[_("div",null,V(e.row.count),1)])),_:1}),w(n,{property:"money",label:"消耗金额 (元)",width:"130"},{default:b((e=>[_("div",null,V(Number(e.row.money).toFixed(2)),1)])),_:1}),w(n,{property:"create_time",label:"创建日期",width:"130"},{default:b((e=>[_("div",null,V(g(u)(new Date(e.row.create_time),"yyyy-MM-dd")),1)])),_:1}),w(n,{property:"source",label:"来源",width:"130"},{default:b((e=>[_("div",null,V(g(B)(e.row.source)),1)])),_:1}),w(n,{property:"source",label:"操作",width:"150",fixed:"right"},{default:b((e=>[1==e.row.status?(f(),y("div",K,[e.row.attachment?(f(),k(p,{key:0,type:"primary",href:e.row.attachment},{default:b((()=>[Q])),_:2},1032,["href"])):C("",!0),e.row.attachment?(f(),y("div",W)):C("",!0),w(p,{type:"primary",onClick:a=>O(e.row.id)},{default:b((()=>[X])),_:2},1032,["onClick"])])):C("",!0),2==e.row.status?(f(),y("div",J," --- ")):C("",!0),3==e.row.status?(f(),y("div",L,[w(p,{type:"primary",onClick:a=>{c.value=e.row.fail_reason,d.value=!0}},{default:b((()=>[Y])),_:2},1032,["onClick"]),Z,w(p,{type:"primary",onClick:a=>O(e.row.id)},{default:b((()=>[$])),_:2},1032,["onClick"])])):C("",!0),4==e.row.status?(f(),y("div",ee,[w(p,{type:"primary",onClick:a=>{return t=e.row.id,void U.push(l.details+"?id="+t);var t}},{default:b((()=>[ae])),_:2},1032,["onClick"]),le,w(p,{type:"primary",onClick:a=>O(e.row.id)},{default:b((()=>[te])),_:2},1032,["onClick"])])):C("",!0)])),_:1})])),_:1},8,["data"]),w(E,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),title:"拒绝原因",width:"400px"},{footer:b((()=>[_("div",oe,[w(j,{type:"primary",onClick:t[0]||(t[0]=e=>d.value=!1)},{default:b((()=>[de])),_:1})])])),default:b((()=>[_("div",re,V(c.value),1)])),_:1},8,["modelValue"]),w(i,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=e=>x.value=e),msg:"确认删除这条数据吗?",onSure:M},null,8,["modelValue"])])}}}),[["__scopeId","data-v-1154fc6d"]]);const ue={class:"add_people"},ie={class:"fcs fjend"},ce=j("取消"),ne=j("提交");var pe=F(c({props:{modelValue:Boolean},emits:["update:modelValue","success"],setup(e,{expose:s,emit:u}){const i=p({people:"",desc:"",addr:[],file:""}),c=p("none"),n=M({people:[{required:!0,message:"请输入人群名称",trigger:"blur"}],desc:[{required:!0,message:"请输入人群描述",trigger:"blur"}],addr:[{required:!0,message:"请选择地区",trigger:"change"}],file:[{validator:(e,a,l)=>{switch(c.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf 格式的文件"));break;default:l()}},trigger:"change"}]}),m=p(),h=p(),V=p(!1),C=e=>{e?(c.value=e,i.value.file="",m.value.validateField("file",(()=>null))):(c.value="",m.value.clearValidate("file"))},j=e=>{var s;u("success",(s=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&d(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&d(e,l,a[l]);return e})({},i.value),a(s,l({path:e}))))},x=()=>{c.value="none",m.value.validate((e=>{if(!e)return!1;V.value=!0,i.value.file?h.value.submit():j("")}))},O=e=>{i.value.file="",c.value="none",h.value.clear(),V.value=!1,z("上传失败")},F=e=>{V.value?A.confirm("正在上传中，关闭弹窗可能会导致上传失败，是否继续关闭？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{})):e()},I=()=>{V.value=!1,c.value="none",h.value.clear(),m.value.resetFields(),u("update:modelValue",!1)};return s({addError:()=>{V.value=!1}}),(a,l)=>{const t=v("el-input"),r=v("el-form-item"),o=v("el-button"),d=v("el-form"),s=v("el-dialog"),u=U("loading");return f(),y("div",ue,[w(s,{modelValue:e.modelValue,"onUpdate:modelValue":l[4]||(l[4]=e=>P(modelValue)?modelValue.value=e:null),title:"新建数据",width:"500px",onClose:I,"before-close":F},{default:b((()=>[E((f(),k(d,{class:"myform",ref_key:"addFormRef",ref:m,model:i.value,rules:g(n)},{default:b((()=>[w(r,{label:"人群名称",prop:"people"},{default:b((()=>[w(t,{modelValue:i.value.people,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value.people=e),placeholder:"请输入人群名称"},null,8,["modelValue"])])),_:1}),w(r,{label:"选择地区",prop:"addr"},{default:b((()=>[w(H,{modelValue:i.value.addr,"onUpdate:modelValue":l[1]||(l[1]=e=>i.value.addr=e),type:"address"},null,8,["modelValue"])])),_:1}),w(r,{label:"人群描述",prop:"desc"},{default:b((()=>[w(t,{modelValue:i.value.desc,"onUpdate:modelValue":l[2]||(l[2]=e=>i.value.desc=e),placeholder:"可对人群进行简单的描述",type:"textarea",maxlength:"150","show-word-limit":"",rows:"4",resize:"none"},null,8,["modelValue"])])),_:1}),w(r,{label:"上传附件",prop:"file"},{default:b((()=>[w(N,{modelValue:i.value.file,"onUpdate:modelValue":l[3]||(l[3]=e=>i.value.file=e),onChange:C,onError:O,onSuccess:j,ref_key:"upload",ref:h},null,8,["modelValue"])])),_:1}),_("div",ie,[w(o,{onClick:I},{default:b((()=>[ce])),_:1}),w(o,{type:"primary",onClick:x},{default:b((()=>[ne])),_:1})])])),_:1},8,["model","rules"])),[[u,V.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0211087c"]]);export{pe as A,se as P};
