import{M as e}from"./MyDataTable.ee6b8568.js";import{_ as a}from"./MyPage.eca92ca4.js";import{_ as l}from"./MyCascader.76a7de18.js";import{F as t,r,a as u,G as d,H as s,I as o,X as i,Q as n,R as p,u as c,P as m,Y as y,a7 as v,U as f,i as g,V as b,av as _,O as h,a6 as w}from"./vue.5acda677.js";import{_ as k,m as V,A as x,E as C,B as F,e as q,C as M}from"./index.309d5df4.js";import{M as T}from"./MyEmpty.99d656ac.js";import{M as j}from"./MyUpload.dc8d1a98.js";import"./date.23847c74.js";const U={class:"up2b"},z={class:"top-button fsc"},E=b("添加需求"),B={class:"flexr"},D=b("同步SCRM"),S=b("同步CMS"),I=b("同步DSP系统"),P={class:"mytable"},R={class:"operate-button-pre"},A=["onClick"],G=["onClick"],H=["onClick"],L={key:3},O={class:"flexr"},Q=b("取消"),X=b("确认");var Y=k(t({setup(t){const b=V();let k=r(0),Y=r(1),J=_(),K=r(!1),N=r(!1),W=r(!1);const Z=r(),$=r(),ee=r();let ae=r({industryType:[],country:"",name:"",desc:"",updateFile:""}),le=r(),te=r([]),re=r([{type:"select",prop:"select",width:100},{type:"text",lable:"ID",prop:"id",width:100},{type:"industry_id",lable:"行业分类",prop:"industry_id",width:120},{type:"country",lable:"地区",prop:"country_id",width:100},{type:"text",lable:"采购商品",prop:"product_name",width:150},{type:"text-tooltip",lable:"描述",prop:"demand_desc",width:220},{type:"date",lable:"创建日期",prop:"create_time",width:110},{type:"status_do",lable:"状态",prop:"status",width:100}]);const ue=u({industryType:[{required:!0,message:"请选择行业分类",trigger:"blur"}],country:[{required:!0,message:"请选择地区",trigger:"blur"},{required:!0,message:"请选择地区",trigger:"change"}],name:[{required:!0,message:"请输入采购商品",trigger:"change"},{required:!0,message:"请输入采购商品",trigger:"blur"}],desc:[{required:!0,message:"请输入描述",trigger:"change"},{required:!0,message:"请输入描述",trigger:"blur"}],updateFile:[{validator:(e,a,l)=>{switch(le.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf、.xls、.xlsx 格式的文件"));break;case"none":l(new Error("请添加文件"));break;default:l()}},trigger:"change"}]}),de=async()=>{K.value=!0;let e={current:Y.value,type:2,size:10};const{status:a,body:l}=await x(e);K.value=!1,a&&(k.value=l.total,te.value=l.records)};de();const se=()=>{W.value=!0,ee.value=b.state.countryList},oe=()=>{Z.value.validate((e=>{if(!e)return!1;N.value=!0,ae.value.updateFile?$.value.submit():pe()}))},ie=e=>{e?(le.value=e,ae.value.updateFile="",Z.value.validateField("updateFile",(()=>null))):(le.value="",Z.value.clearValidate("updateFile"))},ne=e=>{ae.value.updateFile="",le.value="none",$.value.clear(),N.value=!1,q("上传失败")},pe=e=>{M({attachment:e||"",demand_desc:ae.value.desc,product_name:ae.value.name,type:2,country_id:ae.value.country,industry_id:ae.value.industryType.join(",")}).then((e=>{e.status?(W.value=!1,Z.value.resetFields(),Y.value=1,de()):(ae.value.updateFile="",$.value.clear()),N.value=!1})).catch((()=>{N.value=!1,ne()}))};return(t,r)=>{const u=h("el-button"),b=h("el-table-column"),_=h("el-table"),V=h("el-form-item"),x=h("el-option"),q=h("el-select"),M=h("el-input"),le=h("el-form"),ce=h("el-dialog"),me=w("loading");return d(),s("div",U,[o("div",z,[i(u,{size:"large",type:"primary",class:"up-user fcc",onClick:se},{default:n((()=>[E])),_:1}),o("div",B,[i(u,{size:"large"},{default:n((()=>[D])),_:1}),i(u,{size:"large"},{default:n((()=>[S])),_:1}),i(u,{size:"large"},{default:n((()=>[I])),_:1})])]),o("div",P,[p((d(),m(_,{data:c(te),size:"large","row-class-name":"my-data-table-row"},{empty:n((()=>[i(T)])),default:n((()=>[(d(!0),s(y,null,v(c(re),((a,l)=>(d(),m(e,{key:l,type:a.type,width:a.width,lable:a.lable,prop:a.prop},null,8,["type","width","lable","prop"])))),128)),i(b,{fixed:"right",property:"operate",label:"操作","min-width":"100"},{default:n((({row:e})=>[o("div",R,[3===e.status?(d(),s("div",{key:0,class:"operate-button marginr",onClick:a=>(e=>{J.push({path:"/seekAbroad/supplierDetail",query:{id:e.id}})})(e)},"查看",8,A)):f("",!0),1!==e.status?(d(),s("div",{key:1,class:"operate-button marginr",onClick:a=>(e=>{C.confirm("是否确认删除?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{let a={id:e.id};const{status:l}=await F(a);l&&de()}))})(e)},"删除",8,G)):f("",!0),2===e.status?(d(),s("div",{key:2,class:"operate-button",onClick:a=>(e=>{C.alert(e.fail_reason||"暂没有驳回原因，请联系管理员","驳回原因",{confirmButtonText:"确认"})})(e)},"驳回原因",8,H)):f("",!0),1===e.status?(d(),s("div",L,"---")):f("",!0)])])),_:1})])),_:1},8,["data"])),[[me,c(K)]])]),o("div",null,[c(k)?(d(),m(a,{key:0,total:c(k),modelValue:c(Y),"onUpdate:modelValue":r[0]||(r[0]=e=>g(Y)?Y.value=e:Y=e),onChange:de},null,8,["total","modelValue"])):f("",!0)]),i(ce,{modelValue:c(W),"onUpdate:modelValue":r[7]||(r[7]=e=>g(W)?W.value=e:W=e),width:500,draggable:"",title:"添加需求","close-on-click-modal":!1},{footer:n((()=>[o("div",O,[i(u,{type:"primary",onClick:r[6]||(r[6]=e=>g(W)?W.value=!1:W=!1)},{default:n((()=>[Q])),_:1}),i(u,{type:"primary",onClick:oe},{default:n((()=>[X])),_:1})])])),default:n((()=>[o("div",null,[p((d(),m(le,{model:c(ae),ref_key:"formRef",ref:Z,rules:c(ue)},{default:n((()=>[i(V,{label:"行业分类",required:"",prop:"industryType"},{default:n((()=>[i(l,{type:"type",modelValue:c(ae).industryType,"onUpdate:modelValue":r[1]||(r[1]=e=>c(ae).industryType=e)},null,8,["modelValue"])])),_:1}),i(V,{label:"地区",prop:"country"},{default:n((()=>[i(q,{modelValue:c(ae).country,"onUpdate:modelValue":r[2]||(r[2]=e=>c(ae).country=e),class:"m-2",placeholder:"请选择地区",size:"large",clearable:""},{default:n((()=>[(d(!0),s(y,null,v(ee.value,(e=>(d(),m(x,{key:e.code,label:e.country_name,value:e.code},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(V,{label:"采购商品",required:"",prop:"name"},{default:n((()=>[i(M,{placeholder:"请输入产品名称",modelValue:c(ae).name,"onUpdate:modelValue":r[3]||(r[3]=e=>c(ae).name=e),clearable:""},null,8,["modelValue"])])),_:1}),i(V,{label:"描述",required:"",prop:"desc"},{default:n((()=>[i(M,{type:"textarea",maxlength:"150","show-word-limit":"",class:"input-textarea",placeholder:"可简要描述对寻找地区的采购服务商的要求。",modelValue:c(ae).desc,"onUpdate:modelValue":r[4]||(r[4]=e=>c(ae).desc=e)},null,8,["modelValue"])])),_:1}),i(V,{label:"上传附件",prop:"updateFile"},{default:n((()=>[i(j,{modelValue:c(ae).updateFile,"onUpdate:modelValue":r[5]||(r[5]=e=>c(ae).updateFile=e),onChange:ie,onError:ne,onSuccess:pe,ref_key:"upload",ref:$},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[me,c(N)]])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-5af43ce4"]]);export{Y as default};
