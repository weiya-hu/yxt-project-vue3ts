var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,u=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{F as s,f as d,r as i,a as n,G as c,H as p,I as v,X as m,Q as f,W as y,u as b,K as _,P as w,U as h,R as g,V,at as k,au as C,av as j,O as U,a6 as M}from"./vue.5acda677.js";import{M as O}from"./MyDialog.fff08e33.js";import{a as x,M as z}from"./MyEmpty.344736a1.js";import{M as D}from"./MyUpload.48150651.js";import{_ as E}from"./MyCascader.b3f5809b.js";import{_ as P,m as q,n as F,o as I,r as N,t as S,u as B,e as H,E as R,v as T}from"./index.7c1d8caa.js";import{f as G}from"./date.23847c74.js";const K=e=>(k("data-v-c1bcac0c"),e=e(),C(),e),Q={class:"specific_data_page"},W={class:"fsc topbtns"},X=V("新增需求"),A={class:"mytable"},J={class:"fcs"},L={key:0,class:"fcs"},Y=V("下载附件"),Z={key:1,class:"line"},$=V("删除"),ee={key:1,class:"fcs"},ae={key:2,class:"fcs"},le=V("拒绝原因"),te=K((()=>v("div",{class:"line"},null,-1))),re=V("删除"),oe={key:3,class:"fcs"},ue=V("查看"),se=K((()=>v("div",{class:"line"},null,-1))),de=V("删除"),ie={class:"fcs btns fjend"},ne=V("取消"),ce=V("提交"),pe={class:"fcc msg"},ve={class:"fcc"},me=V("我知道了"),fe=s((ye=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&u(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&u(e,l,a[l]);return e})({},{name:"个性化数据"}),a(ye,l({setup(e){const a=q(),l=d((()=>a.state.typeHash)),t=d((()=>a.state.addressHash)),r=j(),o=i([]),u=i(1),s=i(0),V=()=>{S({current:u.value,size:10}).then((e=>{1==e.status&&(o.value=e.body.records,s.value=e.body.total)}))};V();const k=()=>{V()},C=i([]),P=e=>{C.value=e},K=i(!1),fe=i(""),ye=i({type:[],addr:[],people:"",desc:"",file:""}),be=i("none"),_e=n({type:[{required:!0,message:"请选择行业",trigger:"change"}],addr:[{required:!0,message:"请选择地区",trigger:"change"}],people:[{required:!0,message:"请输入人群名称",trigger:"blur"}],desc:[{required:!0,message:"请输入人群描述",trigger:"blur"}],file:[{validator:(e,a,l)=>{switch(be.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .zip、.rar、.7z 格式的文件"));break;default:l()}},trigger:"change"}]}),we=i(!1),he=i(),ge=e=>{e?(be.value=e,ye.value.file="",ke.value.validateField("file",(()=>null))):(be.value="",ke.value.clearValidate("file"))},Ve=i(!1),ke=i(),Ce=e=>{B({attachment:e,province:Number(ye.value.addr[0])||"",city:Number(ye.value.addr[1])||"",district:Number(ye.value.addr[2])||"",group_desc:ye.value.desc,group_name:ye.value.people,industry_id:ye.value.type.join(",")}).then((e=>{1==e.status?(Ue(),V()):(ye.value.file="",be.value="none",he.value.clear(),Ve.value=!1)})).catch((()=>{je("")}))},je=e=>{ye.value.file="",be.value="none",he.value.clear(),Ve.value=!1,H("上传失败")},Ue=()=>{we.value=!1,Ve.value=!1,be.value="none",he.value.clear(),ke.value.resetFields()},Me=e=>{Ve.value?R.confirm("正在上传中，关闭弹窗可能会导致上传失败，是否继续关闭？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{})):e()},Oe=i(""),xe=i(!1),ze=e=>{Oe.value=e,xe.value=!0},De=()=>{T({id:Oe.value}).then((e=>{1==e.status&&(xe.value=!1,V())}))};return(e,a)=>{const d=U("el-button"),i=U("el-table-column"),n=U("el-link"),V=U("el-table"),C=U("el-form-item"),j=U("el-input"),q=U("el-form"),S=U("el-dialog"),B=M("loading");return c(),p("div",Q,[v("div",W,[m(d,{type:"primary",size:"large",onClick:a[0]||(a[0]=e=>we.value=!0)},{default:f((()=>[X])),_:1})]),v("div",A,[m(V,{data:o.value,style:{width:"100%"},onSelectionChange:P},{empty:f((()=>[m(x)])),default:f((()=>[m(i,{type:"selection",width:"50"}),m(i,{property:"id",label:"ID",width:"165"}),m(i,{property:"type",label:"行业分类",width:"150"},{default:f((e=>[v("div",null,y(b(F)(e.row.industry_id.split(","),b(l),"last")),1)])),_:1}),m(i,{property:"addr",label:"地区",width:"180"},{default:f((e=>[v("div",null,y(b(F)(b(I)(e.row.province,e.row.city,e.row.district),b(t))),1)])),_:1}),m(i,{property:"group_name",label:"人群名称"}),m(i,{property:"group_desc",label:"人群描述"}),m(i,{property:"create_time",label:"发起时间",width:"155"},{default:f((e=>[v("div",null,y(b(G)(new Date(e.row.create_time),"yyyy-MM-dd")),1)])),_:1}),m(i,{property:"status",label:"状态",width:"100"},{default:f((e=>[v("div",J,[v("div",{class:_(["status_dot",b(N)(e.row.status).className])},null,2),v("div",null,y(b(N)(e.row.status).text),1)])])),_:1}),m(i,{label:"操作",width:"150"},{default:f((e=>[1==e.row.status?(c(),p("div",L,[e.row.attachment?(c(),w(n,{key:0,type:"primary",href:e.row.attachment},{default:f((()=>[Y])),_:2},1032,["href"])):h("",!0),e.row.attachment?(c(),p("div",Z)):h("",!0),m(n,{type:"primary",onClick:a=>ze(e.row.id)},{default:f((()=>[$])),_:2},1032,["onClick"])])):h("",!0),2==e.row.status?(c(),p("div",ee," --- ")):h("",!0),3==e.row.status?(c(),p("div",ae,[m(n,{type:"primary",onClick:a=>{fe.value=e.row.fail_reason,K.value=!0}},{default:f((()=>[le])),_:2},1032,["onClick"]),te,m(n,{type:"primary",onClick:a=>ze(e.row.id)},{default:f((()=>[re])),_:2},1032,["onClick"])])):h("",!0),4==e.row.status?(c(),p("div",oe,[m(n,{type:"primary",onClick:a=>{return l=e.row.id,void r.push("/findB/specificDataDetails?id="+l);var l}},{default:f((()=>[ue])),_:2},1032,["onClick"]),se,m(n,{type:"primary",onClick:a=>ze(e.row.id)},{default:f((()=>[de])),_:2},1032,["onClick"])])):h("",!0)])),_:1})])),_:1},8,["data"])]),m(z,{total:s.value,modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=e=>u.value=e),onChange:k},null,8,["total","modelValue"]),m(S,{modelValue:we.value,"onUpdate:modelValue":a[8]||(a[8]=e=>we.value=e),title:"新建数据",width:"500px",onClose:Ue,"before-close":Me},{default:f((()=>[g((c(),w(q,{class:"myform",ref_key:"addFormRef",ref:ke,model:ye.value,rules:b(_e)},{default:f((()=>[m(C,{label:"行业分类",prop:"type"},{default:f((()=>[m(E,{modelValue:ye.value.type,"onUpdate:modelValue":a[2]||(a[2]=e=>ye.value.type=e),type:"type"},null,8,["modelValue"])])),_:1}),m(C,{label:"选择地区",prop:"addr"},{default:f((()=>[m(E,{modelValue:ye.value.addr,"onUpdate:modelValue":a[3]||(a[3]=e=>ye.value.addr=e),type:"address"},null,8,["modelValue"])])),_:1}),m(C,{label:"人群名称",prop:"people"},{default:f((()=>[m(j,{modelValue:ye.value.people,"onUpdate:modelValue":a[4]||(a[4]=e=>ye.value.people=e),placeholder:"请输入人群名称"},null,8,["modelValue"])])),_:1}),m(C,{label:"人群描述",prop:"desc"},{default:f((()=>[m(j,{modelValue:ye.value.desc,"onUpdate:modelValue":a[5]||(a[5]=e=>ye.value.desc=e),placeholder:"可对人群进行简单的描述",type:"textarea",maxlength:"150","show-word-limit":"",rows:"4",resize:"none"},null,8,["modelValue"])])),_:1}),m(C,{label:"上传附件",prop:"file"},{default:f((()=>[m(D,{modelValue:ye.value.file,"onUpdate:modelValue":a[6]||(a[6]=e=>ye.value.file=e),onChange:ge,onError:je,onSuccess:Ce,ref_key:"upload",ref:he},null,8,["modelValue"])])),_:1}),v("div",ie,[m(d,{onClick:Ue},{default:f((()=>[ne])),_:1}),m(d,{type:"primary",onClick:a[7]||(a[7]=e=>{var a;(a=ke.value)&&(be.value="none",a.validate((e=>{if(!e)return!1;Ve.value=!0,ye.value.file?he.value.submit():Ce("")})))})},{default:f((()=>[ce])),_:1})])])),_:1},8,["model","rules"])),[[B,Ve.value]])])),_:1},8,["modelValue"]),m(S,{modelValue:K.value,"onUpdate:modelValue":a[10]||(a[10]=e=>K.value=e),title:"拒绝原因",width:"400px"},{footer:f((()=>[v("div",ve,[m(d,{type:"primary",onClick:a[9]||(a[9]=e=>K.value=!1)},{default:f((()=>[me])),_:1})])])),default:f((()=>[v("div",pe,y(fe.value),1)])),_:1},8,["modelValue"]),m(O,{modelValue:xe.value,"onUpdate:modelValue":a[11]||(a[11]=e=>xe.value=e),msg:"确认删除这条数据吗?",onSure:De},null,8,["modelValue"])])}}}))));var ye,be=P(fe,[["__scopeId","data-v-c1bcac0c"]]);export{be as default};
