import{F as e,f as a,r as l,a as t,G as r,H as u,I as d,X as s,Q as o,W as i,u as n,K as c,U as p,P as v,R as m,V as f,at as y,au as _,av as b,O as g,a6 as h}from"./vue.2fa59680.js";import{M as w}from"./MyDialog.a1bf47ed.js";import{_ as V}from"./MyPage.29df61fa.js";import{M as k}from"./MyUpload.3cc87795.js";import{_ as C}from"./MyCascader.e5f7b563.js";import{M as x}from"./MyEmpty.06d8b729.js";import{_ as j,m as M,j as U,k as q,n as D,p as E,q as F,E as N,r as z}from"./index.e956d55f.js";import{f as B}from"./date.23847c74.js";const H=e=>(y("data-v-39b07c12"),e=e(),_(),e),I={class:"specific_data_page"},S={class:"fsc topbtns"},P=f("新增需求"),R={class:"mytable"},T={class:"fcs"},G={key:0,class:"fcs"},K=f("删除"),O={key:0,class:"line"},Q=f("下载附件"),W={key:1,class:"fcs"},X=f("详情"),A=H((()=>d("div",{class:"line"},null,-1))),J=f("删除"),L={key:2,class:"fcs"},Y=f("删除"),Z=H((()=>d("div",{class:"line"},null,-1))),$=f("拒绝原因"),ee={class:"fcs btns fjend"},ae=f("取消"),le=f("提交"),te={class:"fcc msg"},re={class:"fcc"},ue=f("我知道了");var de=j(e({setup(e){const f=M(),y=a((()=>f.state.typeHash)),_=a((()=>f.state.addressHash)),j=b(),H=l([]),de=l(1),se=l(0),oe=()=>{D({current:de.value,size:10}).then((e=>{1==e.status&&(H.value=e.body.records,se.value=e.body.total)}))};oe();const ie=()=>{oe()},ne=l([]),ce=e=>{ne.value=e},pe=e=>{const a=l({class:"",text:"-"});switch(Number(e)){case 0:a.value={class:"bgc_green",text:"审核中"};break;case 1:a.value={class:"bgc_df",text:"已通过"};break;case 2:a.value={class:"bgc_red",text:"已拒绝"}}return a.value},ve=l(!1),me=l(""),fe=l({type:[],addr:[],people:"",desc:"",file:""}),ye=l("none"),_e=t({type:[{required:!0,message:"请选择行业",trigger:"change"}],addr:[{required:!0,message:"请选择地区",trigger:"change"}],people:[{required:!0,message:"请输入人群名称",trigger:"blur"}],desc:[{required:!0,message:"请输入人群描述",trigger:"blur"}],file:[{validator:(e,a,l)=>{switch(ye.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf 格式的文件"));break;default:l()}},trigger:"change"}]}),be=l(!1),ge=l(),he=e=>{e?(ye.value=e,fe.value.file="",Ve.value.validateField("file",(()=>null))):(ye.value="",Ve.value.clearValidate("file"))},we=l(!1),Ve=l(),ke=e=>{E({attachment:e,province:Number(fe.value.addr[0])||"",city:Number(fe.value.addr[1])||"",district:Number(fe.value.addr[2])||"",group_desc:fe.value.desc,group_name:fe.value.people,industry_id:fe.value.type.join(",")}).then((e=>{1==e.status?(xe(),oe()):(fe.value.file="",ye.value="none",ge.value.clear(),we.value=!1)})).catch((()=>{Ce("")}))},Ce=e=>{fe.value.file="",ye.value="none",ge.value.clear(),we.value=!1,F("上传失败")},xe=()=>{be.value=!1,we.value=!1,ye.value="none",ge.value.clear(),Ve.value.resetFields()},je=e=>{we.value?N.confirm("正在上传中，关闭弹窗可能会导致上传失败，是否继续关闭？","温馨提示",{confirmButtonText:"取消",cancelButtonText:"确定",type:"warning"}).then((()=>{})).catch((()=>{e()})):e()},Me=l(""),Ue=l(!1),qe=e=>{Me.value=e,Ue.value=!0},De=()=>{z({id:Me.value}).then((e=>{1==e.status&&(Ue.value=!1,oe())}))};return(e,a)=>{const l=g("el-button"),t=g("el-table-column"),f=g("el-link"),b=g("el-table"),M=g("el-form-item"),D=g("el-input"),E=g("el-form"),F=g("el-dialog"),N=h("loading");return r(),u("div",I,[d("div",S,[s(l,{type:"primary",onClick:a[0]||(a[0]=e=>be.value=!0)},{default:o((()=>[P])),_:1})]),d("div",R,[s(b,{data:H.value,style:{width:"100%"},onSelectionChange:ce},{empty:o((()=>[s(x)])),default:o((()=>[s(t,{type:"selection",width:"50"}),s(t,{property:"id",label:"ID",width:"165"}),s(t,{property:"type",label:"行业分类",width:"150"},{default:o((e=>[d("div",null,i(n(U)(e.row.industry_id.split(","),n(y),"last")),1)])),_:1}),s(t,{property:"addr",label:"地区",width:"180"},{default:o((e=>[d("div",null,i(n(U)(n(q)(e.row.province,e.row.city,e.row.district),n(_))),1)])),_:1}),s(t,{property:"group_name",label:"人群名称"}),s(t,{property:"group_desc",label:"人群描述"}),s(t,{property:"create_time",label:"发起时间",width:"155"},{default:o((e=>[d("div",null,i(n(B)(new Date(e.row.create_time),"yyyy-MM-dd")),1)])),_:1}),s(t,{property:"status",label:"状态",width:"100"},{default:o((e=>[d("div",T,[d("div",{class:c(["dot",pe(e.row.status).class])},null,2),d("div",null,i(pe(e.row.status).text),1)])])),_:1}),s(t,{label:"操作",width:"150"},{default:o((e=>[0===e.row.status?(r(),u("div",G,[s(f,{type:"primary",onClick:a=>qe(e.row.id)},{default:o((()=>[K])),_:2},1032,["onClick"]),e.row.attachment?(r(),u("div",O)):p("",!0),e.row.attachment?(r(),v(f,{key:1,type:"primary",href:e.row.attachment},{default:o((()=>[Q])),_:2},1032,["href"])):p("",!0)])):p("",!0),1===e.row.status?(r(),u("div",W,[s(f,{type:"primary",onClick:a=>{return l=e.row.id,void j.push("/findB/specificDataDetails?id="+l);var l}},{default:o((()=>[X])),_:2},1032,["onClick"]),A,s(f,{type:"primary",onClick:a=>qe(e.row.id)},{default:o((()=>[J])),_:2},1032,["onClick"])])):p("",!0),2===e.row.status?(r(),u("div",L,[s(f,{type:"primary",onClick:a=>qe(e.row.id)},{default:o((()=>[Y])),_:2},1032,["onClick"]),Z,s(f,{type:"primary",onClick:a=>{me.value=e.row.fail_reason,ve.value=!0}},{default:o((()=>[$])),_:2},1032,["onClick"])])):p("",!0)])),_:1})])),_:1},8,["data"])]),s(V,{total:se.value,modelValue:de.value,"onUpdate:modelValue":a[1]||(a[1]=e=>de.value=e),onChange:ie},null,8,["total","modelValue"]),s(F,{modelValue:be.value,"onUpdate:modelValue":a[8]||(a[8]=e=>be.value=e),title:"新建数据",width:"500px",onClose:xe,"before-close":je},{default:o((()=>[m((r(),v(E,{class:"myform",ref_key:"addFormRef",ref:Ve,model:fe.value,rules:n(_e)},{default:o((()=>[s(M,{label:"行业分类",prop:"type"},{default:o((()=>[s(C,{modelValue:fe.value.type,"onUpdate:modelValue":a[2]||(a[2]=e=>fe.value.type=e),type:"type"},null,8,["modelValue"])])),_:1}),s(M,{label:"选择地区",prop:"addr"},{default:o((()=>[s(C,{modelValue:fe.value.addr,"onUpdate:modelValue":a[3]||(a[3]=e=>fe.value.addr=e),type:"address"},null,8,["modelValue"])])),_:1}),s(M,{label:"人群名称",prop:"people"},{default:o((()=>[s(D,{modelValue:fe.value.people,"onUpdate:modelValue":a[4]||(a[4]=e=>fe.value.people=e),placeholder:"请输入人群名称"},null,8,["modelValue"])])),_:1}),s(M,{label:"人群描述",prop:"desc"},{default:o((()=>[s(D,{modelValue:fe.value.desc,"onUpdate:modelValue":a[5]||(a[5]=e=>fe.value.desc=e),placeholder:"可对人群进行简单的描述",type:"textarea",maxlength:"150","show-word-limit":"",rows:"4",resize:"none"},null,8,["modelValue"])])),_:1}),s(M,{label:"上传附件",prop:"file"},{default:o((()=>[s(k,{modelValue:fe.value.file,"onUpdate:modelValue":a[6]||(a[6]=e=>fe.value.file=e),onChange:he,onError:Ce,onSuccess:ke,ref_key:"upload",ref:ge},null,8,["modelValue"])])),_:1}),d("div",ee,[s(l,{onClick:xe},{default:o((()=>[ae])),_:1}),s(l,{type:"primary",onClick:a[7]||(a[7]=e=>{var a;(a=Ve.value)&&(ye.value="none",a.validate((e=>{if(!e)return!1;we.value=!0,fe.value.file?ge.value.submit():ke("")})))})},{default:o((()=>[le])),_:1})])])),_:1},8,["model","rules"])),[[N,we.value]])])),_:1},8,["modelValue"]),s(F,{modelValue:ve.value,"onUpdate:modelValue":a[10]||(a[10]=e=>ve.value=e),title:"拒绝原因",width:"400px"},{footer:o((()=>[d("div",re,[s(l,{type:"primary",onClick:a[9]||(a[9]=e=>ve.value=!1)},{default:o((()=>[ue])),_:1})])])),default:o((()=>[d("div",te,i(me.value),1)])),_:1},8,["modelValue"]),s(w,{modelValue:Ue.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Ue.value=e),msg:"确认删除这条数据吗?",onSure:De},null,8,["modelValue"])])}}}),[["__scopeId","data-v-39b07c12"]]);export{de as default};
